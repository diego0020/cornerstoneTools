/*! cornerstone-tools - 0.9.0 - 2018-02-12 | (c) 2017 Chris Hafey | https://github.com/chafey/cornerstoneTools */
!function(e,t){"object"==typeof exports&&"object"==typeof module?module.exports=t(require("cornerstone-core"),require("cornerstone-math"),require("hammerjs")):"function"==typeof define&&define.amd?define("cornerstoneTools",["cornerstone-core","cornerstone-math","hammerjs"],t):"object"==typeof exports?exports.cornerstoneTools=t(require("cornerstone-core"),require("cornerstone-math"),require("hammerjs")):e.cornerstoneTools=t(e.cornerstone,e.cornerstoneMath,e.Hammer)}("undefined"!=typeof self?self:this,function(e,t,o){return function(e){function t(n){if(o[n])return o[n].exports;var a=o[n]={i:n,l:!1,exports:{}};return e[n].call(a.exports,a,a.exports,t),a.l=!0,a.exports}var o={};return t.m=e,t.c=o,t.d=function(e,o,n){t.o(e,o)||Object.defineProperty(e,o,{configurable:!1,enumerable:!0,get:n})},t.n=function(e){var o=e&&e.__esModule?function(){return e.default}:function(){return e};return t.d(o,"a",o),o},t.o=function(e,t){return Object.prototype.hasOwnProperty.call(e,t)},t.p="",t(t.s=56)}([function(t,o){t.exports=e},function(e,t,o){"use strict";function n(e){var t=d.getEnabledElement(e);return void 0===t.toolStateManager&&(t.toolStateManager=c.globalImageIdSpecificToolStateManager),t.toolStateManager}function a(e,t,o){n(e).add(e,t,o);var a={toolType:t,element:e,measurementData:o};$(e).trigger("CornerstoneToolsMeasurementAdded",a)}function r(e,t){return n(e).get(e,t)}function i(e,t,o){for(var a=n(e),r=a.get(e,t),i=-1,l=0;l<r.data.length;l++)r.data[l]===o&&(i=l);if(-1!==i){r.data.splice(i,1);var s={toolType:t,element:e,measurementData:o};$(e).trigger("CornerstoneToolsMeasurementRemoved",s)}}function l(e,t){var o=n(e),a=o.get(e,t);void 0!==a&&(a.data=[])}function s(e,t){d.getEnabledElement(e).toolStateManager=t}Object.defineProperty(t,"__esModule",{value:!0}),t.getElementToolStateManager=t.setElementToolStateManager=t.clearToolState=t.removeToolState=t.getToolState=t.addToolState=void 0;var u=o(0),d=function(e){if(e&&e.__esModule)return e;var t={};if(null!=e)for(var o in e)Object.prototype.hasOwnProperty.call(e,o)&&(t[o]=e[o]);return t.default=e,t}(u),c=o(16);t.addToolState=a,t.getToolState=r,t.removeToolState=i,t.clearToolState=l,t.setElementToolStateManager=s,t.getElementToolStateManager=n},function(e,o){e.exports=t},function(e,t,o){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.default=function(e,t){return 0!=(e&t)}},function(e,t,o){"use strict";function n(e){v=e}function a(){return v}function r(e){f=e}function i(){return f}function l(e){g=e}function s(){return g}function u(e){return e?g:f}function d(e){m=e}function c(){return m}Object.defineProperty(t,"__esModule",{value:!0});var f="white",g="greenyellow",v="transparent",m="grey",h={setFillColor:n,getFillColor:a,setToolColor:r,getToolColor:i,setActiveColor:l,getActiveColor:s,getColorIfActive:u,setSecondaryColor:d,getSecondaryColor:c};t.default=h},function(e,t,o){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.default=function(e,t,o,n,r,i){"[object Array]"!==Object.prototype.toString.call(t)&&(t=[t]);var l=a.default.getFont(),s=a.default.getFontSize(),u=a.default.getBackgroundColor(),d=a.default.getShadowColor(),c=a.default.getShadowBlur();e.save(),e.font=l,e.textBaseline="top",e.strokeStyle=r,e.shadowColor=d,e.shadowBlur=c;var f=0;t.forEach(function(t){var o=e.measureText(t).width;f=Math.max(f,o)}),e.fillStyle=u;var g={width:f+10,height:5+t.length*(s+5)};return i&&i.centering&&!0===i.centering.x&&(o-=g.width/2),i&&i.centering&&!0===i.centering.y&&(n-=g.height/2),g.left=o,g.top=n,i&&!0===i.debug&&(e.fillStyle="#FF0000"),e.fillRect(g.left,g.top,g.width,g.height),t.forEach(function(t,a){e.fillStyle=r,e.fillText(t,o+5,n+5+a*(s+5))}),e.restore(),g};var n=o(12),a=function(e){return e&&e.__esModule?e:{default:e}}(n)},function(e,t,o){"use strict";function n(e){u=e}function a(){return u}function r(e){d=e}function i(){return d}function l(e){c=e}function s(){return c}Object.defineProperty(t,"__esModule",{value:!0});var u=1,d=2,c=1,f={setToolWidth:n,getToolWidth:a,setActiveWidth:r,getActiveWidth:i,setSecondaryWidth:l,getSecondaryWidth:s};t.default=f},function(e,t,o){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.default=function(e,t,o,n,r){e.strokeStyle=n;var s=void 0===r.handleRadius?l:r.handleRadius;Object.keys(o).forEach(function(n){var l=o[n];if(!0!==l.drawnIndependently&&(!r||!0!==r.drawHandlesIfActive||l.active)&&(!r||!0!==r.hideHandlesIfMoved||!l.isMoving)){e.beginPath(),l.active?e.lineWidth=i.default.getActiveWidth():e.lineWidth=i.default.getToolWidth();var u=a.pixelToCanvas(t.element,l);e.arc(u.x,u.y,s,0,2*Math.PI),r&&r.fill&&(e.fillStyle=r.fill,e.fill()),e.stroke()}})};var n=o(0),a=function(e){if(e&&e.__esModule)return e;var t={};if(null!=e)for(var o in e)Object.prototype.hasOwnProperty.call(e,o)&&(t[o]=e[o]);return t.default=e,t}(n),r=o(6),i=function(e){return e&&e.__esModule?e:{default:e}}(r),l=6},function(e,t,o){"use strict";function n(e){return e&&e.__esModule?e:{default:e}}Object.defineProperty(t,"__esModule",{value:!0}),t.default=function(e){function t(t){var i=t.element;document.body.style.cursor="none";var l=e.createNewMeasurement(t);if(l){var s={mouseButtonMask:t.which};(0,b.addToolState)(t.element,e.toolType,l),$(i).off("CornerstoneToolsMouseMove",e.mouseMoveCallback||n),$(i).off("CornerstoneToolsMouseDown",e.mouseDownCallback||a),$(i).off("CornerstoneToolsMouseDownActivate",e.mouseDownActivateCallback||o),e.mouseDoubleClickCallback&&$(i).off("CornerstoneToolsMouseDoubleClick",e.mouseDoubleClickCallback),r.updateImage(i);var u=void 0;u=1===Object.keys(l.handles).length?g.default:m.default;var d=void 0;d=!(!e.options||void 0===e.options.preventHandleOutsideImage)&&e.options.preventHandleOutsideImage,l.handles.end.isMoving=!1,u(t,e.toolType,l,l.handles.end,function(){l.active=!1,document.body.style.cursor="default",l.invalidated=!0,(0,y.default)(t,l.handles)&&(0,b.removeToolState)(i,e.toolType,l),$(i).on("CornerstoneToolsMouseMove",s,e.mouseMoveCallback||n),$(i).on("CornerstoneToolsMouseDown",s,e.mouseDownCallback||a),$(i).on("CornerstoneToolsMouseDownActivate",s,e.mouseDownActivateCallback||o),e.mouseDoubleClickCallback&&$(i).on("CornerstoneToolsMouseDoubleClick",s,e.mouseDoubleClickCallback);l.handles.end.isMoving=!1;var u={toolType:e.toolType,element:i,measurementData:l};$(i).trigger("CornerstoneToolsMeasurementFinished",u),r.updateImage(i)},d)}}function o(o,n){if((0,x.default)(n.which,o.data.mouseButtonMask))return e.addNewMeasurement?e.addNewMeasurement(n):t(n),!1}function n(t,o){if(l.default.setCoords(o),0===o.which){var n=(0,b.getToolState)(o.element,e.toolType);if(n){for(var a=!1,i=0;i<n.data.length;i++){var s=o.currentPoints.canvas,u=n.data[i];!0===(0,c.default)(o.element,u.handles,s)&&(a=!0),(e.pointNearTool(o.element,u,s)&&!u.active||!e.pointNearTool(o.element,u,s)&&u.active)&&(u.active=!u.active,a=!0)}!0===a&&r.updateImage(o.element)}}}function a(t,o){function a(){document.body.style.cursor="default";for(var t in i.handles)i.handles[t].isMoving=!1;i.invalidated=!0,(0,y.default)(o,i.handles)&&(0,b.removeToolState)(l,e.toolType,i),r.updateImage(l),$(l).on("CornerstoneToolsMouseMove",o,e.mouseMoveCallback||n)}var i=void 0,l=o.element;if((0,x.default)(o.which,t.data.mouseButtonMask)){var s=o.startPoints.canvas,d=(0,b.getToolState)(t.currentTarget,e.toolType);if(d){var c=void 0,f=void 0;for(f=!(!e.options||void 0===e.options.preventHandleOutsideImage)&&e.options.preventHandleOutsideImage,c=0;c<d.data.length;c++){i=d.data[c];var v=(0,u.default)(l,i.handles,s,6);if(v)return v.isMoving=!1,document.body.style.cursor="none",$(l).off("CornerstoneToolsMouseMove",e.mouseMoveCallback||n),i.active=!0,(0,g.default)(o,e.toolType,i,v,a,f),t.stopImmediatePropagation(),!1}if(e.pointNearTool){var m=e.options||{deleteIfHandleOutsideImage:!0,preventHandleOutsideImage:!1};for(c=0;c<d.data.length;c++)if(i=d.data[c],i.active=!1,e.pointNearTool(l,i,s))return i.active=!0,$(l).off("CornerstoneToolsMouseMove",e.mouseMoveCallback||n),(0,p.default)(t,i,d,e.toolType,m,a),t.stopImmediatePropagation(),!1}}}}function i(t){$(t).off("CornerstoneImageRendered",e.onImageRendered),$(t).off("CornerstoneToolsMouseMove",e.mouseMoveCallback||n),$(t).off("CornerstoneToolsMouseDown",e.mouseDownCallback||a),$(t).off("CornerstoneToolsMouseDownActivate",e.mouseDownActivateCallback||o),e.mouseDoubleClickCallback&&$(t).off("CornerstoneToolsMouseDoubleClick",e.mouseDoubleClickCallback),r.updateImage(t)}function s(t){$(t).off("CornerstoneImageRendered",e.onImageRendered),$(t).off("CornerstoneToolsMouseMove",e.mouseMoveCallback||n),$(t).off("CornerstoneToolsMouseDown",e.mouseDownCallback||a),$(t).off("CornerstoneToolsMouseDownActivate",e.mouseDownActivateCallback||o),e.mouseDoubleClickCallback&&$(t).off("CornerstoneToolsMouseDoubleClick",e.mouseDoubleClickCallback),$(t).on("CornerstoneImageRendered",e.onImageRendered),r.updateImage(t)}function d(t,i){var l={mouseButtonMask:i};$(t).off("CornerstoneImageRendered",e.onImageRendered),$(t).off("CornerstoneToolsMouseMove",e.mouseMoveCallback||n),$(t).off("CornerstoneToolsMouseDown",e.mouseDownCallback||a),$(t).off("CornerstoneToolsMouseDownActivate",e.mouseDownActivateCallback||o),$(t).on("CornerstoneImageRendered",e.onImageRendered),$(t).on("CornerstoneToolsMouseMove",l,e.mouseMoveCallback||n),$(t).on("CornerstoneToolsMouseDown",l,e.mouseDownCallback||a),$(t).on("CornerstoneToolsMouseDownActivate",l,e.mouseDownActivateCallback||o),e.mouseDoubleClickCallback&&($(t).off("CornerstoneToolsMouseDoubleClick",e.mouseDoubleClickCallback),$(t).on("CornerstoneToolsMouseDoubleClick",l,e.mouseDoubleClickCallback)),r.updateImage(t)}function f(t,i){var l={mouseButtonMask:i},s="CornerstoneToolsToolDeactivated",u={mouseButtonMask:i,toolType:e.toolType,type:s},d=$.Event(s,u);$(t).trigger(d,u),$(t).off("CornerstoneImageRendered",e.onImageRendered),$(t).off("CornerstoneToolsMouseMove",e.mouseMoveCallback||n),$(t).off("CornerstoneToolsMouseDown",e.mouseDownCallback||a),$(t).off("CornerstoneToolsMouseDownActivate",e.mouseDownActivateCallback||o),$(t).on("CornerstoneImageRendered",e.onImageRendered),$(t).on("CornerstoneToolsMouseMove",l,e.mouseMoveCallback||n),$(t).on("CornerstoneToolsMouseDown",l,e.mouseDownCallback||a),e.mouseDoubleClickCallback&&($(t).off("CornerstoneToolsMouseDoubleClick",e.mouseDoubleClickCallback),$(t).on("CornerstoneToolsMouseDoubleClick",l,e.mouseDoubleClickCallback)),r.updateImage(t)}function v(){return T}function h(e){T=e}var T={},C={enable:s,disable:i,activate:d,deactivate:f,getConfiguration:v,setConfiguration:h,mouseDownCallback:a,mouseMoveCallback:n,mouseDownActivateCallback:o};return e.pointNearTool&&(C.pointNearTool=e.pointNearTool),e.mouseDoubleClickCallback&&(C.mouseDoubleClickCallback=e.mouseDoubleClickCallback),e.addNewMeasurement&&(C.addNewMeasurement=e.addNewMeasurement),C};var a=o(0),r=function(e){if(e&&e.__esModule)return e;var t={};if(null!=e)for(var o in e)Object.prototype.hasOwnProperty.call(e,o)&&(t[o]=e[o]);return t.default=e,t}(a),i=o(25),l=n(i),s=o(15),u=n(s),d=o(26),c=n(d),f=o(20),g=n(f),v=o(21),m=n(v),h=o(27),p=n(h),T=o(13),y=n(T),C=o(3),x=n(C),b=o(1)},function(e,t,o){"use strict";function n(e){return e&&e.__esModule?e:{default:e}}function a(e){Object.keys(e).forEach(function(t){e[t].active=!1})}function r(e){if(e)for(var t=0;t<e.data.length;t++){var o=e.data[t];o.active=!1,o.handles&&a(o.handles)}}function i(e){function t(t){var r=t.element,i=e.createNewMeasurement(t);if(i){if((0,y.addToolState)(r,e.toolType,i),1===Object.keys(i.handles).length&&"CornerstoneToolsTap"===t.type)return i.active=!1,i.handles.end.active=!1,i.handles.end.highlight=!1,i.invalidated=!0,(0,d.default)(t,i.handles)&&(0,y.removeToolState)(r,e.toolType,i),void s.updateImage(r);$(r).off("CornerstoneToolsTouchStartActive",e.touchDownActivateCallback||o),$(r).off("CornerstoneToolsTap",e.tapCallback||n),$(r).off("CornerstoneToolsTouchStart",e.touchStartCallback||a),s.updateImage(r),(0,h.default)(t,e.toolType,i,i.handles.end,function(){i.active=!1,i.invalidated=!0,(0,d.default)(t,i.handles)&&(0,y.removeToolState)(r,e.toolType,i),$(r).on("CornerstoneToolsTouchStartActive",e.touchDownActivateCallback||o),$(r).on("CornerstoneToolsTap",e.tapCallback||n),$(r).on("CornerstoneToolsTouchStart",e.touchStartCallback||a),s.updateImage(r)})}}function o(o,n){return e.addNewMeasurement?e.addNewMeasurement(n):t(n),!1}function n(t,i){function l(){r(g),(0,d.default)(i,m.handles)&&(0,y.removeToolState)(u,e.toolType,m),s.updateImage(u),$(u).on("CornerstoneToolsTouchStart",e.touchStartCallback||a),$(u).on("CornerstoneToolsTap",e.tapCallback||n)}var u=i.element,c=i.currentPoints.canvas,g=(0,y.getToolState)(t.currentTarget,e.toolType),m=void 0,h=void 0;if(r(g),g)for(h=0;h<g.data.length;h++){m=g.data[h];var p=(0,f.default)(u,m.handles,c,25);if(p)return $(u).off("CornerstoneToolsTouchStart",e.touchStartCallback||a),$(u).off("CornerstoneToolsTap",e.tapCallback||n),m.active=!0,p.active=!0,s.updateImage(u),(0,v.default)(t,e.toolType,m,p,l),t.stopImmediatePropagation(),!1}if(g&&e.pointNearTool)for(h=0;h<g.data.length;h++)if(m=g.data[h],e.pointNearTool(u,m,c))return $(u).off("CornerstoneToolsTouchStart",e.touchStartCallback||a),$(u).off("CornerstoneToolsTap",e.tapCallback||n),m.active=!0,s.updateImage(u),(0,T.default)(t,m,g,e.toolType,!0,l),t.stopImmediatePropagation(),!1;return e.touchDownActivateCallback?e.touchDownActivateCallback(t,i):o(t,i),!1}function a(t,o){function r(t,r){if(u.active=!1,u.invalidated=!0,(0,d.default)(o,u.handles)&&(0,y.removeToolState)(o.element,e.toolType,u),s.updateImage(o.element),$(i).on("CornerstoneToolsTouchStart",e.touchStartCallback||a),$(i).on("CornerstoneToolsTap",e.tapCallback||n),e.pressCallback&&$(i).on("CornerstoneToolsTouchPress",e.pressCallback),t&&"CornerstoneToolsTouchPress"===t.type){var l=$.Event(t.type,r);$(i).trigger(l,r)}}var i=o.element,l=o.startPoints.canvas,u=void 0,c=(0,y.getToolState)(t.currentTarget,e.toolType),g=void 0;if(c){for(g=0;g<c.data.length;g++){u=c.data[g];var m=(0,f.default)(o.element,u.handles,l,28);if(m)return $(i).off("CornerstoneToolsTouchStart",e.touchStartCallback||a),$(i).off("CornerstoneToolsTap",e.tapCallback||n),e.pressCallback&&$(i).off("CornerstoneToolsTouchPress",e.pressCallback),u.active=!0,(0,v.default)(t,e.toolType,u,m,r),t.stopImmediatePropagation(),!1}if(e.pointNearTool)for(g=0;g<c.data.length;g++)if(u=c.data[g],e.pointNearTool(o.element,u,l))return $(i).off("CornerstoneToolsTouchStart",e.touchStartCallback||a),$(i).off("CornerstoneToolsTap",e.tapCallback||n),e.pressCallback&&$(i).off("CornerstoneToolsTouchPress",e.pressCallback),(0,T.default)(t,u,c,e.toolType,!0,r),t.stopImmediatePropagation(),!1}}function i(t){$(t).off("CornerstoneImageRendered",e.onImageRendered),$(t).off("CornerstoneToolsTouchStart",e.touchStartCallback||a),$(t).off("CornerstoneToolsTouchStartActive",e.touchDownActivateCallback||o),$(t).off("CornerstoneToolsTap",e.tapCallback||n),e.doubleTapCallback&&$(t).off("CornerstoneToolsDoubleTap",e.doubleTapCallback),e.pressCallback&&$(t).off("CornerstoneToolsTouchPress",e.pressCallback),s.updateImage(t)}function l(t){$(t).off("CornerstoneImageRendered",e.onImageRendered),$(t).off("CornerstoneToolsTouchStart",e.touchStartCallback||a),$(t).off("CornerstoneToolsTouchStartActive",e.touchDownActivateCallback||o),$(t).off("CornerstoneToolsTap",e.tapCallback||n),$(t).on("CornerstoneImageRendered",e.onImageRendered),e.doubleTapCallback&&$(t).off("CornerstoneToolsDoubleTap",e.doubleTapCallback),e.pressCallback&&$(t).off("CornerstoneToolsTouchPress",e.pressCallback),s.updateImage(t)}function u(t){$(t).off("CornerstoneImageRendered",e.onImageRendered),$(t).off("CornerstoneToolsTouchStart",e.touchStartCallback||a),$(t).off("CornerstoneToolsTouchStartActive",e.touchDownActivateCallback||o),$(t).off("CornerstoneToolsTap",e.tapCallback||n),$(t).on("CornerstoneImageRendered",e.onImageRendered),$(t).on("CornerstoneToolsTouchStart",e.touchStartCallback||a),$(t).on("CornerstoneToolsTouchStartActive",e.touchDownActivateCallback||o),$(t).on("CornerstoneToolsTap",e.tapCallback||n),e.doubleTapCallback&&($(t).off("CornerstoneToolsDoubleTap",e.doubleTapCallback),$(t).on("CornerstoneToolsDoubleTap",e.doubleTapCallback)),e.pressCallback&&($(t).off("CornerstoneToolsTouchPress",e.pressCallback),$(t).on("CornerstoneToolsTouchPress",e.pressCallback)),s.updateImage(t)}function c(t){var r="CornerstoneToolsToolDeactivated",i={toolType:e.toolType,type:r},l=$.Event(r,i);$(t).trigger(l,i),$(t).off("CornerstoneImageRendered",e.onImageRendered),$(t).off("CornerstoneToolsTouchStart",e.touchStartCallback||a),$(t).off("CornerstoneToolsTouchStartActive",e.touchDownActivateCallback||o),$(t).off("CornerstoneToolsTap",e.tapCallback||n),$(t).on("CornerstoneImageRendered",e.onImageRendered),$(t).on("CornerstoneToolsTouchStart",e.touchStartCallback||a),e.doubleTapCallback&&$(t).off("CornerstoneToolsDoubleTap",e.doubleTapCallback),e.pressCallback&&$(t).off("CornerstoneToolsTouchPress",e.pressCallback),s.updateImage(t)}var g={enable:l,disable:i,activate:u,deactivate:c,touchStartCallback:e.touchStartCallback||a,touchDownActivateCallback:e.touchDownActivateCallback||o,tapCallback:e.tapCallback||n};return e.pointNearTool&&(g.pointNearTool=e.pointNearTool),e.doubleTapCallback&&(g.doubleTapCallback=e.doubleTapCallback),e.pressCallback&&(g.pressCallback=e.pressCallback),e.addNewMeasurement&&(g.addNewMeasurement=e.addNewMeasurement),g}Object.defineProperty(t,"__esModule",{value:!0});var l=o(0),s=function(e){if(e&&e.__esModule)return e;var t={};if(null!=e)for(var o in e)Object.prototype.hasOwnProperty.call(e,o)&&(t[o]=e[o]);return t.default=e,t}(l),u=o(13),d=n(u),c=o(15),f=n(c),g=o(51),v=n(g),m=o(29),h=n(m),p=o(50),T=n(p),y=o(1);t.default=i},function(e,t,o){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.default=function(e,t){var o="CornerstoneToolsTouchDrag";return t&&!0===t.fireOnTouchStart&&(o+=" CornerstoneToolsTouchStart"),{activate:function(n){$(n).off(o,e),t&&t.eventData?$(n).on(o,t.eventData,e):$(n).on(o,e),t&&t.activateCallback&&t.activateCallback(n)},disable:function(n){$(n).off(o,e),t&&t.disableCallback&&t.disableCallback(n)},enable:function(n){$(n).off(o,e),t&&t.enableCallback&&t.enableCallback(n)},deactivate:function(n){$(n).off(o,e),t&&t.deactivateCallback&&t.deactivateCallback(n)}}}},function(e,t,o){"use strict";function n(e){u=e}function a(){return u}function r(e){d=e}function i(){return d}function l(e){c=e}function s(){return c}Object.defineProperty(t,"__esModule",{value:!0});var u=void 0,d=void 0,c=void 0,f={setStartLoadHandler:n,getStartLoadHandler:a,setEndLoadHandler:r,getEndLoadHandler:i,setErrorLoadingHandler:l,getErrorLoadingHandler:s};t.default=f},function(e,t,o){"use strict";function n(e){v=e}function a(){return g+"px "+v}function r(e){g=e}function i(){return g}function l(e){m=e}function s(){return m}function u(e){h=e}function d(){return h}function c(e){p=e}function f(){return p}Object.defineProperty(t,"__esModule",{value:!0});var g=15,v="Arial",m="transparent",h="#000000",p=2,T={setFont:n,getFont:a,setFontSize:r,getFontSize:i,setBackgroundColor:l,getBackgroundColor:s,setShadowColor:u,getShadowColor:d,setShadowBlur:c,getShadowBlur:f};t.default=T},function(e,t,o){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.default=function(e,t){var o=e.image,n={left:0,top:0,width:o.width,height:o.height},r=!1;return Object.keys(t).forEach(function(e){var o=t[e];!0!==o.allowedOutsideImage&&!1===a.point.insideRect(o,n)&&(r=!0)}),r};var n=o(2),a=function(e){if(e&&e.__esModule)return e;var t={};if(null!=e)for(var o in e)Object.prototype.hasOwnProperty.call(e,o)&&(t[o]=e[o]);return t.default=e,t}(n)},function(e,t,o){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.default=function(e){var t={};return{activate:function(t,o,n){$(t).off("CornerstoneToolsMouseDownActivate",e);var a={mouseButtonMask:o,options:n};$(t).on("CornerstoneToolsMouseDownActivate",a,e)},disable:function(t){$(t).off("CornerstoneToolsMouseDownActivate",e)},enable:function(t){$(t).off("CornerstoneToolsMouseDownActivate",e)},deactivate:function(t){$(t).off("CornerstoneToolsMouseDownActivate",e)},getConfiguration:function(){return t},setConfiguration:function(e){t=e}}}},function(e,t,o){"use strict";function n(e){if(e&&e.__esModule)return e;var t={};if(null!=e)for(var o in e)Object.prototype.hasOwnProperty.call(e,o)&&(t[o]=e[o]);return t.default=e,t}Object.defineProperty(t,"__esModule",{value:!0}),t.default=function(e,t,o,n){var a=void 0;if(t)return Object.keys(t).forEach(function(i){var s=t[i];if(s.hasOwnProperty("pointNearHandle")){if(s.pointNearHandle(e,s,o))return void(a=s)}else if(!0===s.hasBoundingBox){if((0,u.default)(s,o))return void(a=s)}else{var d=r.pixelToCanvas(e,s),c=l.point.distance(d,o);if(c<=n)return void(a=s)}}),a};var a=o(0),r=n(a),i=o(2),l=n(i),s=o(18),u=function(e){return e&&e.__esModule?e:{default:e}}(s)},function(e,t,o){"use strict";function n(){function e(e){return s[e]}function t(e,t){s[e]=t}function o(){return s}function n(e){s=e}function a(e,t,o){var n=r.getEnabledElement(e);n.image&&!1!==s.hasOwnProperty(n.image.imageId)||(s[n.image.imageId]={});var a=s[n.image.imageId];!1===a.hasOwnProperty(t)&&(a[t]={data:[]}),a[t].data.push(o)}function i(e,t){var o=r.getEnabledElement(e);if(o.image&&!1!==s.hasOwnProperty(o.image.imageId)){var n=s[o.image.imageId];if(!1!==n.hasOwnProperty(t)){return n[t]}}}function l(e){var t=r.getEnabledElement(e);t.image&&!1!==s.hasOwnProperty(t.image.imageId)&&delete s[t.image.imageId]}var s={};return{get:i,add:a,clear:l,saveImageIdToolState:e,restoreImageIdToolState:t,saveToolState:o,restoreToolState:n,toolState:s}}Object.defineProperty(t,"__esModule",{value:!0}),t.globalImageIdSpecificToolStateManager=t.newImageIdSpecificToolStateManager=void 0;var a=o(0),r=function(e){if(e&&e.__esModule)return e;var t={};if(null!=e)for(var o in e)Object.prototype.hasOwnProperty.call(e,o)&&(t[o]=e[o]);return t.default=e,t}(a),i=n();t.newImageIdSpecificToolStateManager=n,t.globalImageIdSpecificToolStateManager=i},function(e,t,o){"use strict";function n(){var e=navigator.userAgent,t=e.match(/(opera|chrome|safari|firefox|msie|trident(?=\/))\/?\s*(\d+)/i)||[],o=void 0;return/trident/i.test(t[1])?(o=/\brv[ :]+(\d+)/g.exec(e)||[],"IE "+(o[1]||"")):"Chrome"===t[1]&&null!==(o=e.match(/\b(OPR|Edge)\/(\d+)/))?o.slice(1).join(" ").replace("OPR","Opera"):(t=t[2]?[t[1],t[2]]:[navigator.appName,navigator.appVersion,"-?"],null!==(o=e.match(/version\/(\d+)/i))&&t.splice(1,1,o[1]),t.join(" "))}function a(e){s=e}function r(){return s||i()}function i(){var e=n(),t=e.split(" "),o=t[0],a=t[1],r=u[o];return r?r[a]?r[a]:r.default:u.default}function l(){return new RegExp("Android|webOS|iPhone|iPad|iPod|BlackBerry|IEMobile|Opera Mini").test(navigator.userAgent)}Object.defineProperty(t,"__esModule",{value:!0});var s=void 0,u={default:6,IE:{9:6,10:8,default:8},Firefox:{default:6},Opera:{10:8,11:6,12:6,default:6},Chrome:{default:6},Safari:{default:6}};t.getDefaultSimultaneousRequests=i,t.getMaxSimultaneousRequests=r,t.setMaxSimultaneousRequests=a,t.getBrowserInfo=n,t.isMobileDevice=l},function(e,t,o){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.default=function(e,t){if(e.boundingBox)return a.point.insideRect(t,e.boundingBox)};var n=o(2),a=function(e){if(e&&e.__esModule)return e;var t={};if(null!=e)for(var o in e)Object.prototype.hasOwnProperty.call(e,o)&&(t[o]=e[o]);return t.default=e,t}(n)},function(e,t,o){"use strict";function n(e){return parseFloat("."+e)}Object.defineProperty(t,"__esModule",{value:!0}),t.default=function(e,t){var o=r.metaData.get("patientStudyModule",e.imageId),a=r.metaData.get("generalSeriesModule",e.imageId);if(o&&a){if("PT"===a.modality){var i=t*e.slope+e.intercept,l=o.patientWeight;if(l){var s=r.metaData.get("petIsotopeModule",e.imageId);if(s){var u=s.radiopharmaceuticalInfo,d=u.radiopharmaceuticalStartTime,c=u.radionuclideTotalDose,f=u.radionuclideHalfLife,g=a.seriesTime;if(d&&c&&f&&g){var v=n(g.fractionalSeconds||0)+g.seconds+60*g.minutes+60*g.hours*60,m=n(d.fractionalSeconds)+d.seconds+60*d.minutes+60*d.hours*60,h=v-m;return i*l/(c*Math.exp(-h*Math.log(2)/f))*1e3}}}}}};var a=o(0),r=function(e){if(e&&e.__esModule)return e;var t={};if(null!=e)for(var o in e)Object.prototype.hasOwnProperty.call(e,o)&&(t[o]=e[o]);return t.default=e,t}(a)},function(e,t,o){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.default=function(e,t,o,n,r,i){function l(e,r){!1===n.hasMoved&&(n.hasMoved=!0),n.isMoving=!0,n.active=!0,n.x=r.currentPoints.image.x+d.x,n.y=r.currentPoints.image.y+d.y,i&&(n.x=Math.max(n.x,0),n.x=Math.min(n.x,r.image.width),n.y=Math.max(n.y,0),n.y=Math.min(n.y,r.image.height)),a.updateImage(u);var l={toolType:t,element:u,measurementData:o};$(u).trigger("CornerstoneToolsMeasurementModified",l)}function s(){n.active=!1,$(u).off("CornerstoneToolsMouseDrag",l),$(u).off("CornerstoneToolsMouseUp",s),$(u).off("CornerstoneToolsMouseClick",s),a.updateImage(u),"function"==typeof r&&r()}var u=e.element,d={x:n.x-e.currentPoints.image.x,y:n.y-e.currentPoints.image.y};$(u).on("CornerstoneToolsMouseDrag",l),$(u).on("CornerstoneToolsMouseUp",s),$(u).on("CornerstoneToolsMouseClick",s)};var n=o(0),a=function(e){if(e&&e.__esModule)return e;var t={};if(null!=e)for(var o in e)Object.prototype.hasOwnProperty.call(e,o)&&(t[o]=e[o]);return t.default=e,t}(n)},function(e,t,o){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.default=function(e,t,o,n,r,i){function l(e,r){n.isMoving=!0,n.active=!0,n.x=r.currentPoints.image.x,n.y=r.currentPoints.image.y,i&&(n.x=Math.max(n.x,0),n.x=Math.min(n.x,r.image.width),n.y=Math.max(n.y,0),n.y=Math.min(n.y,r.image.height)),a.updateImage(f);var l={toolType:t,element:f,measurementData:o};$(f).trigger("CornerstoneToolsMeasurementModified",l)}function s(e){$(f).off("CornerstoneToolsMouseMove",s),$(f).off("CornerstoneToolsMouseDrag",s),$(f).on("CornerstoneToolsMouseMove",l),$(f).on("CornerstoneToolsMouseDrag",l),$(f).on("CornerstoneToolsMouseClick",c),"CornerstoneToolsMouseDrag"===e.type&&$(f).on("CornerstoneToolsMouseUp",c)}function u(e,t){t.measurementData===o&&c()}function d(e,o){o.toolType===t&&($(f).off("CornerstoneToolsMouseMove",l),$(f).off("CornerstoneToolsMouseDrag",l),$(f).off("CornerstoneToolsMouseClick",c),$(f).off("CornerstoneToolsMouseUp",c),$(f).off("CornerstoneToolsMeasurementRemoved",u),$(f).off("CornerstoneToolsToolDeactivated",d),n.active=!1,a.updateImage(f))}function c(){$(f).off("CornerstoneToolsMouseMove",l),$(f).off("CornerstoneToolsMouseDrag",l),$(f).off("CornerstoneToolsMouseClick",c),$(f).off("CornerstoneToolsMouseUp",c),$(f).off("CornerstoneToolsMeasurementRemoved",u),$(f).off("CornerstoneToolsToolDeactivated",d),n.active=!1,a.updateImage(f),"function"==typeof r&&r()}var f=e.element;$(f).on("CornerstoneToolsMouseDrag",s),$(f).on("CornerstoneToolsMouseMove",s),$(f).on("CornerstoneToolsMeasurementRemoved",u),$(f).on("CornerstoneToolsToolDeactivated",d)};var n=o(0),a=function(e){if(e&&e.__esModule)return e;var t={};if(null!=e)for(var o in e)Object.prototype.hasOwnProperty.call(e,o)&&(t[o]=e[o]);return t.default=e,t}(n)},function(e,t,o){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.default=function(e){return{activate:function(t){$(t).off("CornerstoneToolsMouseWheel",e);var o={};$(t).on("CornerstoneToolsMouseWheel",o,e)},disable:function(t){$(t).off("CornerstoneToolsMouseWheel",e)},enable:function(t){$(t).off("CornerstoneToolsMouseWheel",e)},deactivate:function(t){$(t).off("CornerstoneToolsMouseWheel",e)}}}},function(e,t,o){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.default=function(e,t){var o=Math.pow(10,t);return Math.round(e*o)/o}},function(e,t,o){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.default=function(e,t,o,n,r){if(!e)throw new Error("getRGBPixels: parameter element must not be undefined");t=Math.round(t),o=Math.round(o);var i=a.getEnabledElement(e),l=[],s=0,u=i.image.getPixelData(),d=void 0,c=void 0,f=void 0;if(i.image.color)for(c=0;c<r;c++)for(f=0;f<n;f++){d=4*((c+o)*i.image.columns+(f+t));var g=u[d],v=u[d+1],m=u[d+2],h=u[d+3];l[s++]=g,l[s++]=v,l[s++]=m,l[s++]=h}return l};var n=o(0),a=function(e){if(e&&e.__esModule)return e;var t={};if(null!=e)for(var o in e)Object.prototype.hasOwnProperty.call(e,o)&&(t[o]=e[o]);return t.default=e,t}(n)},function(e,t,o){"use strict";function n(e){r=e.currentPoints.canvas}function a(){return r}Object.defineProperty(t,"__esModule",{value:!0});var r=void 0,i={setCoords:n,getCoords:a};t.default=i},function(e,t,o){"use strict";function n(e){var t=void 0;return Object.keys(e).forEach(function(o){var n=e[o];if(!0===n.active)return void(t=n)}),t}Object.defineProperty(t,"__esModule",{value:!0}),t.default=function(e,t,o,a){a||(a=6);var i=n(t),l=(0,r.default)(e,t,o,a);return i!==l&&(void 0!==l&&(l.active=!0),void 0!==i&&(i.active=!1),!0)};var a=o(15),r=function(e){return e&&e.__esModule?e:{default:e}}(a)},function(e,t,o){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.default=function(e,t,o,n,r,s){function u(e,o){t.active=!0,Object.keys(t.handles).forEach(function(e){var n=t.handles[e];!0!==n.movesIndependently&&(n.x+=o.deltaPoints.image.x,n.y+=o.deltaPoints.image.y,!0===r.preventHandleOutsideImage&&(n.x=Math.max(n.x,0),n.x=Math.min(n.x,o.image.width),n.y=Math.max(n.y,0),n.y=Math.min(n.y,o.image.height)))}),a.updateImage(c);var i={toolType:n,element:c,measurementData:t};return $(c).trigger("CornerstoneToolsMeasurementModified",i),!1}function d(e,o){t.invalidated=!0,$(c).off("CornerstoneToolsMouseDrag",u),$(c).off("CornerstoneToolsMouseUp",d),$(c).off("CornerstoneToolsMouseClick",d),!0===r.deleteIfHandleOutsideImage&&(0,i.default)(o,t.handles)&&(0,l.removeToolState)(c,n,t),a.updateImage(c),"function"==typeof s&&s()}var c=e.element;return $(c).on("CornerstoneToolsMouseDrag",u),$(c).on("CornerstoneToolsMouseUp",d),$(c).on("CornerstoneToolsMouseClick",d),!0};var n=o(0),a=function(e){if(e&&e.__esModule)return e;var t={};if(null!=e)for(var o in e)Object.prototype.hasOwnProperty.call(e,o)&&(t[o]=e[o]);return t.default=e,t}(n),r=o(13),i=function(e){return e&&e.__esModule?e:{default:e}}(r),l=o(1)},function(e,t,o){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.default=function(e){var t={};return{disable:function(t){$(t).off("CornerstoneImageRendered",e)},enable:function(t){$(t).off("CornerstoneImageRendered",e),$(t).on("CornerstoneImageRendered",e),a.updateImage(t)},getConfiguration:function(){return t},setConfiguration:function(e){t=e}}};var n=o(0),a=function(e){if(e&&e.__esModule)return e;var t={};if(null!=e)for(var o in e)Object.prototype.hasOwnProperty.call(e,o)&&(t[o]=e[o]);return t.default=e,t}(n)},function(e,t,o){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.default=function(e,t,o,n,r,i){function l(e,r){n.x=r.currentPoints.image.x+g.x,n.y=r.currentPoints.image.y+g.y,i&&(n.x=Math.max(n.x,0),n.x=Math.min(n.x,r.image.width),n.y=Math.max(n.y,0),n.y=Math.min(n.y,r.image.height)),a.updateImage(c);var l={toolType:t,element:c,measurementData:o};$(c).trigger("CornerstoneToolsMeasurementModified",l)}function s(e,t){if($(c).off("CornerstoneToolsTouchDrag",l),$(c).off("CornerstoneToolsTouchPinch",s),$(c).off("CornerstoneToolsTouchEnd",s),$(c).off("CornerstoneToolsTap",s),$(c).off("CornerstoneToolsTouchStart",u),$(c).off("CornerstoneToolsToolDeactivated",d),"CornerstoneToolsTouchPinch"===e.type||"CornerstoneToolsTouchPress"===e.type)return n.active=!1,a.updateImage(c),void r();n.active=!1,o.active=!1,n.x=t.currentPoints.image.x+g.x,n.y=t.currentPoints.image.y+g.y,i&&(n.x=Math.max(n.x,0),n.x=Math.min(n.x,t.image.width),n.y=Math.max(n.y,0),n.y=Math.min(n.y,t.image.height)),a.updateImage(c),"function"==typeof r&&r()}function u(e){return e.stopImmediatePropagation(),!1}function d(){$(c).off("CornerstoneToolsTouchDrag",l),$(c).off("CornerstoneToolsTouchPinch",s),$(c).off("CornerstoneToolsTouchEnd",s),$(c).off("CornerstoneToolsTap",s),$(c).off("CornerstoneToolsTouchStart",u),$(c).off("CornerstoneToolsToolDeactivated",d),n.active=!1,o.active=!1,n.x=e.currentPoints.image.x+g.x,n.y=e.currentPoints.image.y+g.y,i&&(n.x=Math.max(n.x,0),n.x=Math.min(n.x,e.image.width),n.y=Math.max(n.y,0),n.y=Math.min(n.y,e.image.height)),a.updateImage(c)}var c=e.element,f=a.pageToPixel(c,e.currentPoints.page.x,e.currentPoints.page.y+50),g={x:n.x-f.x,y:n.y-f.y};n.active=!0,o.active=!0,$(c).on("CornerstoneToolsTouchDrag",l),$(c).on("CornerstoneToolsTouchPinch",s),$(c).on("CornerstoneToolsTouchEnd",s),$(c).on("CornerstoneToolsTap",s),$(c).on("CornerstoneToolsTouchStart",u),$(c).on("CornerstoneToolsToolDeactivated",d)};var n=o(0),a=function(e){if(e&&e.__esModule)return e;var t={};if(null!=e)for(var o in e)Object.prototype.hasOwnProperty.call(e,o)&&(t[o]=e[o]);return t.default=e,t}(n)},function(e,t,o){"use strict";function n(e,t){var o=e.clone().sub(t.imagePositionPatient);return{x:t.rowCosines.dot(o)/t.columnPixelSpacing,y:t.columnCosines.dot(o)/t.rowPixelSpacing}}function a(e,t){var o=t.rowCosines.clone().multiplyScalar(e.x);o.multiplyScalar(t.columnPixelSpacing);var n=t.columnCosines.clone().multiplyScalar(e.y);n.multiplyScalar(t.rowPixelSpacing);var a=o.add(n);return a.add(t.imagePositionPatient),a}function r(e){var t=a({x:0,y:0},e),o=a({x:e.columns,y:0},e),n=a({x:0,y:e.rows},e),r=a({x:e.columns,y:e.rows},e);return{top:new u.Line3(t,o),left:new u.Line3(t,n),right:new u.Line3(o,r),bottom:new u.Line3(n,r)}}function i(e,t){var o=[];return Object.keys(t).forEach(function(n){var a=t[n],r=e.intersectLine(a);r&&o.push(r)}),o}function l(e,t){var o=e.rowCosines.clone().cross(e.columnCosines),n=new u.Plane;n.setFromNormalAndCoplanarPoint(o,e.imagePositionPatient);var l=t.rowCosines.clone().cross(t.columnCosines),s=new u.Plane;s.setFromNormalAndCoplanarPoint(l,t.imagePositionPatient);var d=s.clone().intersectPlane(n),c=d.origin,f=d.direction,g=a({x:t.columns,y:t.rows},t),v=t.imagePositionPatient.distanceTo(g),m=new u.Line3;m.start=c,m.end=c.clone().add(f.multiplyScalar(v));var h=r(t),p=i(m,h);if(2===p.length)return{start:p[0],end:p[1]}}Object.defineProperty(t,"__esModule",{value:!0}),t.projectPatientPointToImagePlane=n,t.imagePointToPatientPoint=a,t.planePlaneIntersection=l;var s=o(2),u=function(e){if(e&&e.__esModule)return e;var t={};if(null!=e)for(var o in e)Object.prototype.hasOwnProperty.call(e,o)&&(t[o]=e[o]);return t.default=e,t}(s)},function(e,t,o){"use strict";function n(e,t,o,n,a,r){if(!v.hasOwnProperty(o))throw new Error("Request type must be one of interaction, thumbnail, or prefetch");if(e&&t){var i={type:o,imageId:t,preventCache:n,doneCallback:a,failCallback:r,element:e},l=f.imageCache.getImagePromise(t);if(l)return void l.then(function(e){a(e)},function(e){r(e)});v[o].push(i)}}function a(e,t){if(!v.hasOwnProperty(e))throw new Error("Request type must be one of interaction, thumbnail, or prefetch");v[e]=v[e].filter(function(e){return e.element!==t})}function r(){var e=void 0;for(e in v)v.hasOwnProperty(e)&&(v[e]=[])}function i(){p&&setTimeout(function(){s()},T)}function l(e){var t=e.type;m[t]++,p=!0;var o=e.imageId,n=e.doneCallback,a=e.failCallback,r=f.imageCache.getImagePromise(o);if(r)return void r.then(function(e){m[t]--,n(e),i()},function(e){m[t]--,a(e),i()});var l=function(e){return"prefetch"===e.type?-5:"interactive"===e.type?0:"thumbnail"===e.type?5:void 0}(e),s=void 0;s=!0===e.preventCache?f.loadImage(o,{priority:l,type:e.type}):f.loadAndCacheImage(o,{priority:l,type:e.type}),s.then(function(e){m[t]--,n(e),i()},function(e){m[t]--,a(e),i()})}function s(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:null,t=(0,g.getMaxSimultaneousRequests)();null!==e&&(t=e),h={interaction:Math.max(t,1),thumbnail:Math.max(t-2,1),prefetch:Math.max(t-1,1)};for(var o=m.interaction+m.thumbnail+m.prefetch,n=t-o,a=0;a<n;a++){var r=u();r&&l(r)}}function u(){var e=f.imageCache.getCacheInfo();return!(e.cacheSizeInBytes>=.9*e.maximumSizeInBytes)&&(v.interaction.length&&m.interaction<h.interaction?v.interaction.shift():!(e.cacheSizeInBytes>=.7*e.maximumSizeInBytes)&&(v.thumbnail.length&&m.thumbnail<h.thumbnail?v.thumbnail.shift():v.prefetch.length&&m.prefetch<h.prefetch?v.prefetch.shift():(v.interaction.length||v.thumbnail.length||v.prefetch.length||(p=!1),!1)))}function d(){return v}Object.defineProperty(t,"__esModule",{value:!0});var c=o(0),f=function(e){if(e&&e.__esModule)return e;var t={};if(null!=e)for(var o in e)Object.prototype.hasOwnProperty.call(e,o)&&(t[o]=e[o]);return t.default=e,t}(c),g=o(17),v={interaction:[],thumbnail:[],prefetch:[]},m={interaction:0,thumbnail:0,prefetch:0},h={interaction:6,thumbnail:6,prefetch:5},p=!1,T=100;t.default={addRequest:n,clearRequestStack:a,startGrabbing:s,getRequestPool:d,clearAll:r}},function(e,t,o){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.default=function(e,t){var o={},n="CornerstoneToolsMultiTouchDrag";return t&&!0===t.fireOnTouchStart&&(n+=" CornerstoneToolsMultiTouchStart"),{activate:function(o){$(o).off(n,e),t&&t.eventData?$(o).on(n,t.eventData,e):$(o).on(n,e),t&&t.activateCallback&&t.activateCallback(o)},disable:function(o){$(o).off(n,e),t&&t.disableCallback&&t.disableCallback(o)},enable:function(o){$(o).off(n,e),t&&t.enableCallback&&t.enableCallback(o)},deactivate:function(o){$(o).off(n,e),t&&t.deactivateCallback&&t.deactivateCallback(o)},getConfiguration:function(){return o},setConfiguration:function(e){o=e}}}},function(e,t,o){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.default=function(e,t){var o=(0,r.getToolState)(e,"stack");if(o&&o.data&&o.data.length){var n=o.data[0],i=n.currentImageIdIndex+t;i=Math.min(n.imageIds.length-1,i),i=Math.max(0,i),(0,a.default)(e,i)}};var n=o(42),a=function(e){return e&&e.__esModule?e:{default:e}}(n),r=o(1)},function(e,t,o){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.default=function(e,t){var o=e.width/2,n=e.height/2;if(o<=0||n<=0)return!1;var a={x:e.left+o,y:e.top+n},r={x:t.x-a.x,y:t.y-a.y};return r.x*r.x/(o*o)+r.y*r.y/(n*n)<=1}},function(e,t,o){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.default=function(e){return e.stopPropagation&&e.stopPropagation(),e.preventDefault&&e.preventDefault(),e.cancelBubble=!0,e.returnValue=!1,!1}},function(e,t,o){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.default=function(e){return{page:a.point.copy(e.page),image:a.point.copy(e.image),client:a.point.copy(e.client),canvas:a.point.copy(e.canvas)}};var n=o(2),a=function(e){if(e&&e.__esModule)return e;var t={};if(null!=e)for(var o in e)Object.prototype.hasOwnProperty.call(e,o)&&(t[o]=e[o]);return t.default=e,t}(n)},function(e,t,o){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.default=function(e,t,o){var n=(0,r.getToolState)(e,"timeSeries");if(n&&n.data&&n.data.length){var i=n.data[0],s=i.stacks[i.currentStackIndex],u=s.currentImageIdIndex,d=i.currentStackIndex+t;if(o?(d>=i.stacks.length&&(d=0),d<0&&(d=i.stacks.length-1)):(d=Math.min(i.stacks.length-1,d),d=Math.max(0,d)),d!==i.currentStackIndex){var c=a.getViewport(e),f=i.stacks[d],g=l.default.getStartLoadHandler(),v=l.default.getEndLoadHandler(),m=l.default.getErrorLoadingHandler();g&&g(e);var h=void 0;h=!0===f.preventCache?a.loadImage(f.imageIds[u]):a.loadAndCacheImage(f.imageIds[u]),h.then(function(t){i.currentImageIdIndex!==u&&(f.currentImageIdIndex=u,i.currentStackIndex=d,a.displayImage(e,t,c),v&&v(e,t))},function(t){var o=f.imageIds[u];m&&m(e,o,t)})}}};var n=o(0),a=function(e){if(e&&e.__esModule)return e;var t={};if(null!=e)for(var o in e)Object.prototype.hasOwnProperty.call(e,o)&&(t[o]=e[o]);return t.default=e,t}(n),r=o(1),i=o(11),l=function(e){return e&&e.__esModule?e:{default:e}}(i)},function(e,t,o){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.default=function(e,t){var o=(0,n.planePlaneIntersection)(e,t);if(o)return{start:(0,n.projectPatientPointToImagePlane)(o.start,e),end:(0,n.projectPatientPointToImagePlane)(o.end,e)}};var n=o(30)},function(e,t,o){"use strict";function n(e){return e&&e.__esModule?e:{default:e}}Object.defineProperty(t,"__esModule",{value:!0}),t.default=function(e,t,o,n){var a=r.getEnabledElement(o).image,i=r.getEnabledElement(n).image;if(a&&i){var s=r.metaData.get("imagePlane",a.imageId),d=r.metaData.get("imagePlane",i.imageId);if(s&&d&&s.rowCosines&&s.columnCosines&&s.imagePositionPatient&&d.rowCosines&&d.columnCosines&&d.imagePositionPatient&&s.frameOfReferenceUID===d.frameOfReferenceUID){var f=s.rowCosines.clone().cross(s.columnCosines),g=d.rowCosines.clone().cross(d.columnCosines),v=f.angleTo(g);if(!((v=Math.abs(v))<.5)){var m=(0,l.default)(s,d);if(m){var h=r.pixelToCanvas(t.element,m.start),p=r.pixelToCanvas(t.element,m.end),T=u.default.getSecondaryColor(),y=c.default.getToolWidth();e.setTransform(1,0,0,1,0,0),e.save(),e.beginPath(),e.strokeStyle=T,e.lineWidth=y,e.moveTo(h.x,h.y),e.lineTo(p.x,p.y),e.stroke(),e.restore()}}}}};var a=o(0),r=function(e){if(e&&e.__esModule)return e;var t={};if(null!=e)for(var o in e)Object.prototype.hasOwnProperty.call(e,o)&&(t[o]=e[o]);return t.default=e,t}(a),i=o(38),l=n(i),s=o(4),u=n(s),d=o(6),c=n(d)},function(e,t,o){"use strict";function n(e){return e&&e.__esModule?e:{default:e}}Object.defineProperty(t,"__esModule",{value:!0});var a=o(60),r=n(a),i=o(61),l=n(i),s={getOrientationString:r.default,invertOrientationString:l.default};t.default=s},function(e,t,o){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.default=function(e,t,o){return a.setToPixelCoordinateSystem(e,t,.1),{fontSize:o/e.viewport.scale/.1,lineHeight:o/e.viewport.scale/.1,fontScale:.1}};var n=o(0),a=function(e){if(e&&e.__esModule)return e;var t={};if(null!=e)for(var o in e)Object.prototype.hasOwnProperty.call(e,o)&&(t[o]=e[o]);return t.default=e,t}(n)},function(e,t,o){"use strict";function n(e){return e&&e.__esModule?e:{default:e}}Object.defineProperty(t,"__esModule",{value:!0}),t.default=function(e,t){function o(o){if(f.currentImageIdIndex===t){try{r.getEnabledElement(e)}catch(e){return}l?(l.currentImageIdIndex=t,l.render(e,a.data)):r.displayImage(e,o,h),v&&v(e,o)}}function n(o){var n=f.imageIds[t];m&&m(e,n,o)}var a=(0,i.getToolState)(e,"stack");if(a&&a.data&&a.data.length){var l=void 0;if(a.data.length>1){var u=(0,i.getToolState)(e,"stackRenderer");u&&u.data&&u.data.length&&(l=u.data[0])}var f=a.data[0];t<0&&(t+=f.imageIds.length);var g=d.default.getStartLoadHandler(),v=d.default.getEndLoadHandler(),m=d.default.getErrorLoadingHandler(),h=r.getViewport(e);if(t!==f.currentImageIdIndex){g&&g(e);var p={newImageIdIndex:t,direction:t-f.currentImageIdIndex};f.currentImageIdIndex=t;var T=f.imageIds[t],y=c.stackScroll.getConfiguration();if(y&&!0===y.retryLoadOnScroll){var C=r.imageCache.getImagePromise(T);C&&"rejected"===C.state()&&r.imageCache.removeImagePromise(T)}var x=Boolean(f.preventCache),b=void 0;b=x?r.loadImage(T):r.loadAndCacheImage(T),b.then(o,n),s.default.startGrabbing(),$(e).trigger("CornerstoneStackScroll",p)}}};var a=o(0),r=function(e){if(e&&e.__esModule)return e;var t={};if(null!=e)for(var o in e)Object.prototype.hasOwnProperty.call(e,o)&&(t[o]=e[o]);return t.default=e,t}(a),i=o(1),l=o(31),s=n(l),u=o(11),d=n(u),c=o(43)},function(e,t,o){"use strict";function n(e){return e&&e.__esModule?e:{default:e}}function a(e,t){$(t.element).off("CornerstoneToolsMouseDrag",l),$(t.element).off("CornerstoneToolsMouseUp",a),$(t.element).off("CornerstoneToolsMouseClick",a)}function r(e,t){if((0,T.default)(t.which,e.data.mouseButtonMask)){var o={deltaY:0};return $(t.element).on("CornerstoneToolsMouseDrag",o,l),$(t.element).on("CornerstoneToolsMouseUp",a),$(t.element).on("CornerstoneToolsMouseClick",a),e.stopImmediatePropagation(),!1}}function i(e,t){var o=-t.direction;(0,C.default)(t.element,o)}function l(e,t){var o=t.element,n=(0,x.getToolState)(o,"stack");if(n&&n.data&&n.data.length){var a=n.data[0],r=b.getConfiguration(),i=$(o).height()/Math.max(a.imageIds.length,8);if(r&&r.stackScrollSpeed&&(i=r.stackScrollSpeed),e.data.deltaY=e.data.deltaY||0,e.data.deltaY+=t.deltaPoints.page.y,Math.abs(e.data.deltaY)>=i){var l=e.data.deltaY/i,s=Math.round(l),u=e.data.deltaY%i;e.data.deltaY=u,(0,C.default)(o,s)}return!1}}function s(e,t){var o=I.getConfiguration();o&&o.testPointers(t)&&l(e,t)}Object.defineProperty(t,"__esModule",{value:!0}),t.stackScrollMultiTouch=t.stackScrollTouchDrag=t.stackScrollWheel=t.stackScroll=void 0;var u=o(10),d=n(u),c=o(32),f=n(c),g=o(14),v=n(g),m=o(22),h=n(m),p=o(3),T=n(p),y=o(33),C=n(y),x=o(1),b=(0,v.default)(r),M=(0,h.default)(i),w={eventData:{deltaY:0}},P=(0,d.default)(l,w),S={testPointers:function(e){return e.numPointers>=3}},I=(0,f.default)(s,w);I.setConfiguration(S),t.stackScroll=b,t.stackScrollWheel=M,t.stackScrollTouchDrag=P,t.stackScrollMultiTouch=I},function(e,t,o){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.default=function(e,t,o,n,r){if(!e)throw new Error("getLuminance: parameter element must not be undefined");t=Math.round(t),o=Math.round(o);var i=a.getEnabledElement(e),l=i.image,s=[],u=0,d=l.getPixelData(),c=void 0,f=void 0,g=void 0;if(l.color)for(f=0;f<r;f++)for(g=0;g<n;g++){c=4*((f+o)*l.columns+(g+t));var v=d[c],m=d[c+1],h=d[c+2];s[u++]=.2126*v+.7152*m+.0722*h}else for(f=0;f<r;f++)for(g=0;g<n;g++)c=(f+o)*l.columns+(g+t),s[u++]=d[c]*l.slope+l.intercept;return s};var n=o(0),a=function(e){if(e&&e.__esModule)return e;var t={};if(null!=e)for(var o in e)Object.prototype.hasOwnProperty.call(e,o)&&(t[o]=e[o]);return t.default=e,t}(n)},function(e,t,o){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.default=function(e,t,o,n,a){var r=n/2*.5522848,i=a/2*.5522848,l=t+n,s=o+a,u=t+n/2,d=o+a/2;e.beginPath(),e.moveTo(t,d),e.bezierCurveTo(t,d-i,u-r,o,u,o),e.bezierCurveTo(u+r,o,l,d-i,l,d),e.bezierCurveTo(l,d+i,u+r,s,u,s),e.bezierCurveTo(u-r,s,t,d+i,t,d),e.closePath(),e.stroke()}},function(e,t,o){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.default=function(e,t,o,n){e.beginPath(),e.strokeStyle=o,e.lineWidth=n,e.arc(t.x,t.y,6,0,2*Math.PI),e.stroke()}},function(e,t,o){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.default=function(e,t,o,n,a){var r=Math.atan2(o.y-t.y,o.x-t.x);e.beginPath(),e.moveTo(t.x,t.y),e.lineTo(o.x,o.y),e.strokeStyle=n,e.lineWidth=a,e.stroke(),e.beginPath(),e.moveTo(o.x,o.y),e.lineTo(o.x-10*Math.cos(r-Math.PI/7),o.y-10*Math.sin(r-Math.PI/7)),e.lineTo(o.x-10*Math.cos(r+Math.PI/7),o.y-10*Math.sin(r+Math.PI/7)),e.lineTo(o.x,o.y),e.lineTo(o.x-10*Math.cos(r-Math.PI/7),o.y-10*Math.sin(r-Math.PI/7)),e.strokeStyle=n,e.lineWidth=a,e.stroke(),e.fillStyle=n,e.fill()}},function(e,t,o){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.default=function(e,t){for(var o=0,n=0,r=0,i=0,l=t.top;l<t.top+t.height;l++)for(var s=t.left;s<t.left+t.width;s++){var u={x:s,y:l};(0,a.default)(t,u)&&(o+=e[i],n+=e[i]*e[i],r++),i++}if(0===r)return{count:r,mean:0,variance:0,stdDev:0};var d=o/r,c=n/r-d*d;return{count:r,mean:d,variance:c,stdDev:Math.sqrt(c)}};var n=o(34),a=function(e){return e&&e.__esModule?e:{default:e}}(n)},function(e,t,o){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.default=function(e){var t={};return{activate:function(t){$(t).off("CornerstoneToolsKeyDown",e),$(t).on("CornerstoneToolsKeyDown",e)},disable:function(t){$(t).off("CornerstoneToolsKeyDown",e)},enable:function(t){$(t).off("CornerstoneToolsKeyDown",e)},deactivate:function(t){$(t).off("CornerstoneToolsKeyDown",e)},getConfiguration:function(){return t},setConfiguration:function(e){t=e}}}},function(e,t,o){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.default=function(e,t,o,n,r,s){function u(e,o){t.active=!0,Object.keys(t.handles).forEach(function(e){var n=t.handles[e];!0!==n.movesIndependently&&(n.x+=o.deltaPoints.image.x,n.y+=o.deltaPoints.image.y)}),a.updateImage(c);var r={toolType:n,element:c,measurementData:t};return $(c).trigger("CornerstoneToolsMeasurementModified",r),!1}function d(e,o){t.active=!1,t.invalidated=!1,$(c).off("CornerstoneToolsTouchDrag",u),$(c).off("CornerstoneToolsTouchPinch",d),$(c).off("CornerstoneToolsTouchPress",d),$(c).off("CornerstoneToolsTouchEnd",d),$(c).off("CornerstoneToolsDragEnd",d),$(c).off("CornerstoneToolsTap",d),!0===r&&(0,i.default)(o,t.handles)&&(0,l.removeToolState)(c,n,t),a.updateImage(c),"function"==typeof s&&s(e,o)}var c=e.element;return $(c).on("CornerstoneToolsTouchDrag",u),$(c).on("CornerstoneToolsTouchPinch",d),$(c).on("CornerstoneToolsTouchPress",d),$(c).on("CornerstoneToolsTouchEnd",d),$(c).on("CornerstoneToolsDragEnd",d),$(c).on("CornerstoneToolsTap",d),!0};var n=o(0),a=function(e){if(e&&e.__esModule)return e;var t={};if(null!=e)for(var o in e)Object.prototype.hasOwnProperty.call(e,o)&&(t[o]=e[o]);return t.default=e,t}(n),r=o(13),i=function(e){return e&&e.__esModule?e:{default:e}}(r),l=o(1)},function(e,t,o){"use strict";function n(e,t,o,a,i){if(o.value){var l=(new Date).getTime(),s=Math.abs(t.y-i.y),u=s/10;if(console.log("distanceRemaining: "+s),s<1)return t.y=i.y,void(o.value=!1);t.y>i.y?t.y-=u:t.y<i.y&&(t.y+=u),r.updateImage(a.element),r.requestAnimationFrame(function(){n(l,t,o,a,i)})}}Object.defineProperty(t,"__esModule",{value:!0}),t.default=function(e,t,o,a,s){function u(e,n){i.value=!1,!1===a.hasMoved&&(a.hasMoved=!0),a.active=!0;var l=n.currentPoints,s={x:l.page.x,y:l.page.y+v};h=r.pageToPixel(c,s.x,s.y),a.x=h.x,a.y=h.y,r.updateImage(c);var u={toolType:t,element:c,measurementData:o};$(c).trigger("CornerstoneToolsMeasurementModified",u)}function d(t,n){i.value=!1,a.active=!1,$(c).off("CornerstoneToolsTouchDrag",u),$(c).off(l,d),r.updateImage(c),"CornerstoneToolsTouchPress"===t.type&&(n.handlePressed=o,a.x=e.currentPoints.image.x,a.y=e.currentPoints.image.y),"function"==typeof s&&s(t,n)}i.value=!0;var c=e.element,f=r.getEnabledElement(c),g=(new Date).getTime(),v=-57,m={x:e.currentPoints.page.x,y:e.currentPoints.page.y+v},h=r.pageToPixel(c,m.x,m.y);$(c).on("CornerstoneToolsTouchDrag",u),$(c).on(l,d),n(g,a,i,f,h)};var a=o(0),r=function(e){if(e&&e.__esModule)return e;var t={};if(null!=e)for(var o in e)Object.prototype.hasOwnProperty.call(e,o)&&(t[o]=e[o]);return t.default=e,t}(a),i={value:!1},l=["CornerstoneToolsTouchEnd","CornerstoneToolsDragEnd","CornerstoneToolsTouchPinch","CornerstoneToolsTouchPress","CornerstoneToolsTap"].join(" ")},function(e,t,o){"use strict";function n(e,t){var o=Date.now();if(e!==d){if(o-c<=s)return t.preventDefault(),t.stopPropagation(),t.stopImmediatePropagation(),!1;d=e}c=o}function a(e,t,o){var n=o?f:g;t.forEach(function(t){$(e).on(t,n)})}function r(e,t,o){var n=o?f:g;t.forEach(function(t){$(e).off(t,n)})}function i(e){r(e,v,u.mouse),r(e,m,u.touch)}function l(e){i(e),a(e,v,u.mouse),a(e,m,u.touch)}Object.defineProperty(t,"__esModule",{value:!0});var s=2e3,u={mouse:0,touch:1},d=void 0,c=void 0,f=n.bind(null,u.mouse),g=n.bind(null,u.touch),v=["mousedown","mouseup"],m=["touchstart","touchend"],h={enable:l,disable:i};t.default=h},function(e,t,o){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.default=function(e){return{activate:function(t){$(t).off("CornerstoneToolsDoubleTap",e);var o={};$(t).on("CornerstoneToolsDoubleTap",o,e)},disable:function(t){$(t).off("CornerstoneToolsDoubleTap",e)},enable:function(t){$(t).off("CornerstoneToolsDoubleTap",e)},deactivate:function(t){$(t).off("CornerstoneToolsDoubleTap",e)}}}},function(e,t,o){"use strict";function n(e){return e&&e.__esModule?e:{default:e}}Object.defineProperty(t,"__esModule",{value:!0}),t.default=function(e,t){function o(o){var n=e.createNewMeasurement(o);n&&((0,C.addToolState)(o.element,e.toolType,n),$(o.element).off("CornerstoneToolsMouseMove",a),(0,g.default)(o,e.toolType,n,n.handles.end,function(){n.active=!1,(0,p.default)(o,n.handles)&&(0,C.removeToolState)(o.element,e.toolType,n),$(o.element).on("CornerstoneToolsMouseMove",a)},t))}function n(e,t){if((0,y.default)(t.which,e.data.mouseButtonMask))return o(t),!1}function a(t,o){if(l.default.setCoords(o),0===o.which){var n=(0,C.getToolState)(o.element,e.toolType);if(void 0!==n){for(var a=!1,i=o.currentPoints.canvas,s=0;s<n.data.length;s++){var u=n.data[s];!0===(0,c.default)(o.element,u.handles,i)&&(a=!0),(e.pointInsideRect(o.element,u,i)&&!u.active||!e.pointInsideRect(o.element,u,i)&&u.active)&&(u.active=!u.active,a=!0)}!0===a&&r.updateImage(o.element)}}}function i(o,n){function i(){l.active=!1,(0,p.default)(n,l.handles)&&(0,C.removeToolState)(n.element,e.toolType,l),r.updateImage(n.element),$(n.element).on("CornerstoneToolsMouseMove",a)}var l=void 0;if((0,y.default)(n.which,o.data.mouseButtonMask)){var s=n.startPoints.canvas,d=(0,C.getToolState)(o.currentTarget,e.toolType),c=void 0;if(void 0!==d)for(c=0;c<d.data.length;c++){l=d.data[c];var f=(0,u.default)(n.element,l.handles,s,25);if(void 0!==f)return $(n.element).off("CornerstoneToolsMouseMove",a),l.active=!0,(0,g.default)(n,e.toolType,l,f,i,t),o.stopImmediatePropagation(),!1}var v={deleteIfHandleOutsideImage:!0,preventHandleOutsideImage:t};if(void 0!==d&&void 0!==e.pointInsideRect)for(c=0;c<d.data.length;c++)if(l=d.data[c],e.pointInsideRect(n.element,l,s))return $(n.element).off("CornerstoneToolsMouseMove",a),(0,m.default)(o,l,d,e.toolType,v,i),$(n.element).on("CornerstoneToolsMouseMove",a),o.stopImmediatePropagation(),!1}}function s(t){$(t).off("CornerstoneImageRendered",e.onImageRendered),$(t).off("CornerstoneToolsMouseMove",a),$(t).off("CornerstoneToolsMouseDown",i),$(t).off("CornerstoneToolsMouseDownActivate",n),r.updateImage(t)}function d(t){$(t).off("CornerstoneImageRendered",e.onImageRendered),$(t).off("CornerstoneToolsMouseMove",a),$(t).off("CornerstoneToolsMouseDown",i),$(t).off("CornerstoneToolsMouseDownActivate",n),$(t).on("CornerstoneImageRendered",e.onImageRendered),r.updateImage(t)}function f(t,o){var l={mouseButtonMask:o};$(t).off("CornerstoneImageRendered",e.onImageRendered),$(t).off("CornerstoneToolsMouseMove",a),$(t).off("CornerstoneToolsMouseDown",i),$(t).off("CornerstoneToolsMouseDownActivate",n),$(t).on("CornerstoneImageRendered",e.onImageRendered),$(t).on("CornerstoneToolsMouseMove",l,a),$(t).on("CornerstoneToolsMouseDown",l,i),$(t).on("CornerstoneToolsMouseDownActivate",l,n),r.updateImage(t)}function v(t,o){var l={mouseButtonMask:o};$(t).off("CornerstoneImageRendered",e.onImageRendered),$(t).off("CornerstoneToolsMouseMove",a),$(t).off("CornerstoneToolsMouseDown",i),$(t).off("CornerstoneToolsMouseDownActivate",n),$(t).on("CornerstoneImageRendered",e.onImageRendered),$(t).on("CornerstoneToolsMouseMove",l,a),$(t).on("CornerstoneToolsMouseDown",l,i),r.updateImage(t)}return{enable:d,disable:s,activate:f,deactivate:v}};var a=o(0),r=function(e){if(e&&e.__esModule)return e;var t={};if(null!=e)for(var o in e)Object.prototype.hasOwnProperty.call(e,o)&&(t[o]=e[o]);return t.default=e,t}(a),i=o(25),l=n(i),s=o(15),u=n(s),d=o(26),c=n(d),f=o(20),g=n(f),v=o(27),m=n(v),h=o(13),p=n(h),T=o(3),y=n(T),C=o(1)},function(e,t,o){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.default=function(e){return{activate:function(t){$(t).off("CornerstoneToolsTouchPinch",e);var o={};$(t).on("CornerstoneToolsTouchPinch",o,e)},disable:function(t){$(t).off("CornerstoneToolsTouchPinch",e)},enable:function(t){$(t).off("CornerstoneToolsTouchPinch",e)},deactivate:function(t){$(t).off("CornerstoneToolsTouchPinch",e)}}}},function(e,t,o){"use strict";function n(e){return e&&e.__esModule?e:{default:e}}Object.defineProperty(t,"__esModule",{value:!0});var a=o(57);Object.defineProperty(t,"metaData",{enumerable:!0,get:function(){return n(a).default}});var r=o(58);Object.defineProperty(t,"referenceLines",{enumerable:!0,get:function(){return n(r).default}});var i=o(40);Object.defineProperty(t,"orientation",{enumerable:!0,get:function(){return n(i).default}});var l=o(31);Object.defineProperty(t,"requestPoolManager",{enumerable:!0,get:function(){return n(l).default}});var s=o(41);Object.defineProperty(t,"setContextToDisplayFontSize",{enumerable:!0,get:function(){return n(s).default}});var u=o(42);Object.defineProperty(t,"scrollToIndex",{enumerable:!0,get:function(){return n(u).default}});var d=o(33);Object.defineProperty(t,"scroll",{enumerable:!0,get:function(){return n(d).default}});var c=o(23);Object.defineProperty(t,"roundToDecimal",{enumerable:!0,get:function(){return n(c).default}});var f=o(30);Object.defineProperty(t,"projectPatientPointToImagePlane",{enumerable:!0,get:function(){return f.projectPatientPointToImagePlane}}),Object.defineProperty(t,"imagePointToPatientPoint",{enumerable:!0,get:function(){return f.imagePointToPatientPoint}}),Object.defineProperty(t,"planePlaneIntersection",{enumerable:!0,get:function(){return f.planePlaneIntersection}});var g=o(18);Object.defineProperty(t,"pointInsideBoundingBox",{enumerable:!0,get:function(){return n(g).default}});var v=o(34);Object.defineProperty(t,"pointInEllipse",{enumerable:!0,get:function(){return n(v).default}});var m=o(35);Object.defineProperty(t,"pauseEvent",{enumerable:!0,get:function(){return n(m).default}});var h=o(3);Object.defineProperty(t,"isMouseButtonEnabled",{enumerable:!0,get:function(){return n(h).default}});var p=o(24);Object.defineProperty(t,"getRGBPixels",{enumerable:!0,get:function(){return n(p).default}});var T=o(17);Object.defineProperty(t,"getDefaultSimultaneousRequests",{enumerable:!0,get:function(){return T.getDefaultSimultaneousRequests}}),Object.defineProperty(t,"getMaxSimultaneousRequests",{enumerable:!0,get:function(){return T.getMaxSimultaneousRequests}}),Object.defineProperty(t,"getBrowserInfo",{enumerable:!0,get:function(){return T.getBrowserInfo}}),Object.defineProperty(t,"isMobileDevice",{enumerable:!0,get:function(){return T.isMobileDevice}});var y=o(44);Object.defineProperty(t,"getLuminance",{enumerable:!0,get:function(){return n(y).default}});var C=o(5);Object.defineProperty(t,"drawTextBox",{enumerable:!0,get:function(){return n(C).default}});var x=o(45);Object.defineProperty(t,"drawEllipse",{enumerable:!0,get:function(){return n(x).default}});var b=o(46);Object.defineProperty(t,"drawCircle",{enumerable:!0,get:function(){return n(b).default}});var M=o(47);Object.defineProperty(t,"drawArrow",{enumerable:!0,get:function(){return n(M).default}});var w=o(36);Object.defineProperty(t,"copyPoints",{enumerable:!0,get:function(){return n(w).default}});var P=o(19);Object.defineProperty(t,"calculateSUV",{enumerable:!0,get:function(){return n(P).default}});var S=o(48);Object.defineProperty(t,"calculateEllipseStatistics",{enumerable:!0,get:function(){return n(S).default}});var I=o(62);Object.defineProperty(t,"probeTool4D",{enumerable:!0,get:function(){return n(I).default}});var $=o(37);Object.defineProperty(t,"incrementTimePoint",{enumerable:!0,get:function(){return n($).default}});var O=o(65);Object.defineProperty(t,"timeSeriesPlayer",{enumerable:!0,get:function(){return n(O).default}});var k=o(66);Object.defineProperty(t,"timeSeriesScroll",{enumerable:!0,get:function(){return k.timeSeriesScroll}}),Object.defineProperty(t,"timeSeriesScrollWheel",{enumerable:!0,get:function(){return k.timeSeriesScrollWheel}}),Object.defineProperty(t,"timeSeriesScrollTouchDrag",{enumerable:!0,get:function(){return k.timeSeriesScrollTouchDrag}});var _=o(67);Object.defineProperty(t,"wwwcSynchronizer",{enumerable:!0,get:function(){return n(_).default}});var D=o(68);Object.defineProperty(t,"updateImageSynchronizer",{enumerable:!0,get:function(){return n(D).default}});var j=o(69);Object.defineProperty(t,"Synchronizer",{enumerable:!0,get:function(){return n(j).default}});var E=o(70);Object.defineProperty(t,"stackScrollSynchronizer",{enumerable:!0,get:function(){return n(E).default}});var R=o(71);Object.defineProperty(t,"stackImagePositionSynchronizer",{enumerable:!0,get:function(){return n(R).default}});var A=o(72);Object.defineProperty(t,"stackImagePositionOffsetSynchronizer",{enumerable:!0,get:function(){return n(A).default}});var B=o(73);Object.defineProperty(t,"stackImageIndexSynchronizer",{enumerable:!0,get:function(){return n(B).default}});var N=o(74);Object.defineProperty(t,"panZoomSynchronizer",{enumerable:!0,get:function(){return n(N).default}});var H=o(6);Object.defineProperty(t,"toolStyle",{enumerable:!0,get:function(){return n(H).default}});var V=o(1);Object.defineProperty(t,"addToolState",{enumerable:!0,get:function(){return V.addToolState}}),Object.defineProperty(t,"getToolState",{enumerable:!0,get:function(){return V.getToolState}}),Object.defineProperty(t,"removeToolState",{enumerable:!0,get:function(){return V.removeToolState}}),Object.defineProperty(t,"clearToolState",{enumerable:!0,get:function(){return V.clearToolState}}),Object.defineProperty(t,"setElementToolStateManager",{enumerable:!0,get:function(){return V.setElementToolStateManager}}),Object.defineProperty(t,"getElementToolStateManager",{enumerable:!0,get:function(){return V.getElementToolStateManager}});var W=o(25);Object.defineProperty(t,"toolCoordinates",{enumerable:!0,get:function(){return n(W).default}});var L=o(4);Object.defineProperty(t,"toolColors",{enumerable:!0,get:function(){return n(L).default}});var Y=o(75);Object.defineProperty(t,"addTimeSeriesStateManager",{enumerable:!0,get:function(){return Y.addTimeSeriesStateManager}}),Object.defineProperty(t,"newTimeSeriesSpecificToolStateManager",{enumerable:!0,get:function(){return Y.newTimeSeriesSpecificToolStateManager}});var F=o(12);Object.defineProperty(t,"textStyle",{enumerable:!0,get:function(){return n(F).default}});var z=o(76);Object.defineProperty(t,"stackSpecificStateManager",{enumerable:!0,get:function(){return n(z).default}}),Object.defineProperty(t,"newStackSpecificToolStateManager",{enumerable:!0,get:function(){return z.newStackSpecificToolStateManager}}),Object.defineProperty(t,"addStackStateManager",{enumerable:!0,get:function(){return z.addStackStateManager}});var X=o(11);Object.defineProperty(t,"loadHandlerManager",{enumerable:!0,get:function(){return n(X).default}});var U=o(16);Object.defineProperty(t,"newImageIdSpecificToolStateManager",{enumerable:!0,get:function(){return U.newImageIdSpecificToolStateManager}}),Object.defineProperty(t,"globalImageIdSpecificToolStateManager",{enumerable:!0,get:function(){return U.globalImageIdSpecificToolStateManager}});var q=o(77);Object.defineProperty(t,"newFrameOfReferenceSpecificToolStateManager",{enumerable:!0,get:function(){return q.newFrameOfReferenceSpecificToolStateManager}}),Object.defineProperty(t,"globalFrameOfReferenceSpecificToolStateManager",{enumerable:!0,get:function(){return q.globalFrameOfReferenceSpecificToolStateManager}});var G=o(78);Object.defineProperty(t,"appState",{enumerable:!0,get:function(){return n(G).default}});var K=o(79);Object.defineProperty(t,"stackScrollKeyboard",{enumerable:!0,get:function(){return n(K).default}});var Z=o(43);Object.defineProperty(t,"stackScroll",{enumerable:!0,get:function(){return Z.stackScroll}}),Object.defineProperty(t,"stackScrollWheel",{enumerable:!0,get:function(){return Z.stackScrollWheel}}),Object.defineProperty(t,"stackScrollTouchDrag",{enumerable:!0,get:function(){return Z.stackScrollTouchDrag}}),Object.defineProperty(t,"stackScrollMultiTouch",{enumerable:!0,get:function(){return Z.stackScrollMultiTouch}});var J=o(80);Object.defineProperty(t,"stackPrefetch",{enumerable:!0,get:function(){return n(J).default}});var Q=o(81);Object.defineProperty(t,"scrollIndicator",{enumerable:!0,get:function(){return n(Q).default}});var ee=o(82);Object.defineProperty(t,"stackRenderers",{enumerable:!0,get:function(){return n(ee).default}});var te=o(84);Object.defineProperty(t,"playClip",{enumerable:!0,get:function(){return te.playClip}}),Object.defineProperty(t,"stopClip",{enumerable:!0,get:function(){return te.stopClip}});var oe=o(13);Object.defineProperty(t,"anyHandlesOutsideImage",{enumerable:!0,get:function(){return n(oe).default}});var ne=o(7);Object.defineProperty(t,"drawHandles",{enumerable:!0,get:function(){return n(ne).default}});var ae=o(15);Object.defineProperty(t,"getHandleNearImagePoint",{enumerable:!0,get:function(){return n(ae).default}});var re=o(26);Object.defineProperty(t,"handleActivator",{enumerable:!0,get:function(){return n(re).default}});var ie=o(27);Object.defineProperty(t,"moveAllHandles",{enumerable:!0,get:function(){return n(ie).default}});var le=o(20);Object.defineProperty(t,"moveHandle",{enumerable:!0,get:function(){return n(le).default}});var se=o(21);Object.defineProperty(t,"moveNewHandle",{enumerable:!0,get:function(){return n(se).default}});var ue=o(29);Object.defineProperty(t,"moveNewHandleTouch",{enumerable:!0,get:function(){return n(ue).default}});var de=o(50);Object.defineProperty(t,"touchMoveAllHandles",{enumerable:!0,get:function(){return n(de).default}});var ce=o(51);Object.defineProperty(t,"touchMoveHandle",{enumerable:!0,get:function(){return n(ce).default}});var fe=o(85);Object.defineProperty(t,"keyboardInput",{enumerable:!0,get:function(){return n(fe).default}});var ge=o(86);Object.defineProperty(t,"mouseInput",{enumerable:!0,get:function(){return n(ge).default}});var ve=o(87);Object.defineProperty(t,"mouseWheelInput",{enumerable:!0,get:function(){return n(ve).default}});var me=o(52);Object.defineProperty(t,"preventGhostClick",{enumerable:!0,get:function(){return n(me).default}});var he=o(88);Object.defineProperty(t,"touchInput",{enumerable:!0,get:function(){return n(he).default}});var pe=o(90);Object.defineProperty(t,"angle",{enumerable:!0,get:function(){return pe.angle}}),Object.defineProperty(t,"angleTouch",{enumerable:!0,get:function(){return pe.angleTouch}});var Te=o(91);Object.defineProperty(t,"angleXen",{enumerable:!0,get:function(){return Te.angleXen}});var ye=o(92);Object.defineProperty(t,"arrowAnnotate",{enumerable:!0,get:function(){return ye.arrowAnnotate}}),Object.defineProperty(t,"arrowAnnotateTouch",{enumerable:!0,get:function(){return ye.arrowAnnotateTouch}});var Ce=o(93);Object.defineProperty(t,"crosshairs",{enumerable:!0,get:function(){return Ce.crosshairs}}),Object.defineProperty(t,"crosshairsTouch",{enumerable:!0,get:function(){return Ce.crosshairsTouch}});var xe=o(28);Object.defineProperty(t,"displayTool",{enumerable:!0,get:function(){return n(xe).default}});var be=o(53);Object.defineProperty(t,"doubleTapTool",{enumerable:!0,get:function(){return n(be).default}});var Me=o(94);Object.defineProperty(t,"doubleTapZoom",{enumerable:!0,get:function(){return n(Me).default}});var we=o(95);Object.defineProperty(t,"dragProbe",{enumerable:!0,get:function(){return we.dragProbe}}),Object.defineProperty(t,"dragProbeTouch",{enumerable:!0,get:function(){return we.dragProbeTouch}});var Pe=o(96);Object.defineProperty(t,"ellipticalRoi",{enumerable:!0,get:function(){return Pe.ellipticalRoi}}),Object.defineProperty(t,"ellipticalRoiTouch",{enumerable:!0,get:function(){return Pe.ellipticalRoiTouch}});var Se=o(97);Object.defineProperty(t,"freehand",{enumerable:!0,get:function(){return Se.freehand}});var Ie=o(98);Object.defineProperty(t,"highlight",{enumerable:!0,get:function(){return Ie.highlight}}),Object.defineProperty(t,"highlightTouch",{enumerable:!0,get:function(){return Ie.highlightTouch}});var $e=o(99);Object.defineProperty(t,"imageStats",{enumerable:!0,get:function(){return n($e).default}});var Oe=o(49);Object.defineProperty(t,"keyboardTool",{enumerable:!0,get:function(){return n(Oe).default}});var ke=o(100);Object.defineProperty(t,"length",{enumerable:!0,get:function(){return ke.length}}),Object.defineProperty(t,"lengthTouch",{enumerable:!0,get:function(){return ke.lengthTouch}});var _e=o(101);Object.defineProperty(t,"magnify",{enumerable:!0,get:function(){return _e.magnify}}),Object.defineProperty(t,"magnifyTouchDrag",{enumerable:!0,get:function(){return _e.magnifyTouchDrag}});var De=o(102);Object.defineProperty(t,"magnify2",{enumerable:!0,get:function(){return De.magnify2}}),Object.defineProperty(t,"magnify2TouchDrag",{enumerable:!0,get:function(){return De.magnify2TouchDrag}});var je=o(54);Object.defineProperty(t,"mouseButtonRectangleTool",{enumerable:!0,get:function(){return n(je).default}});var Ee=o(8);Object.defineProperty(t,"mouseButtonTool",{enumerable:!0,get:function(){return n(Ee).default}});var Re=o(22);Object.defineProperty(t,"mouseWheelTool",{enumerable:!0,get:function(){return n(Re).default}});var Ae=o(32);Object.defineProperty(t,"multiTouchDragTool",{enumerable:!0,get:function(){return n(Ae).default}});var Be=o(103);Object.defineProperty(t,"orientationMarkers",{enumerable:!0,get:function(){return n(Be).default}});var Ne=o(104);Object.defineProperty(t,"pan",{enumerable:!0,get:function(){return Ne.pan}}),Object.defineProperty(t,"panTouchDrag",{enumerable:!0,get:function(){return Ne.panTouchDrag}});var He=o(105);Object.defineProperty(t,"panMultiTouch",{enumerable:!0,get:function(){return n(He).default}});var Ve=o(106);Object.defineProperty(t,"probe",{enumerable:!0,get:function(){return Ve.probe}}),Object.defineProperty(t,"probeTouch",{enumerable:!0,get:function(){return Ve.probeTouch}});var We=o(107);Object.defineProperty(t,"probex",{enumerable:!0,get:function(){return We.probex}}),Object.defineProperty(t,"probexTouch",{enumerable:!0,get:function(){return We.probexTouch}});var Le=o(108);Object.defineProperty(t,"rectangleRoi",{enumerable:!0,get:function(){return Le.rectangleRoi}}),Object.defineProperty(t,"rectangleRoiTouch",{enumerable:!0,get:function(){return Le.rectangleRoiTouch}});var Ye=o(109);Object.defineProperty(t,"rotate",{enumerable:!0,get:function(){return Ye.rotate}}),Object.defineProperty(t,"rotateTouchDrag",{enumerable:!0,get:function(){return Ye.rotateTouchDrag}});var Fe=o(110);Object.defineProperty(t,"rotateTouch",{enumerable:!0,get:function(){return n(Fe).default}});var ze=o(111);Object.defineProperty(t,"saveAs",{enumerable:!0,get:function(){return n(ze).default}});var Xe=o(112);Object.defineProperty(t,"seedAnnotate",{enumerable:!0,get:function(){return Xe.seedAnnotate}}),Object.defineProperty(t,"seedAnnotateTouch",{enumerable:!0,get:function(){return Xe.seedAnnotateTouch}});var Ue=o(113);Object.defineProperty(t,"simpleAngle",{enumerable:!0,get:function(){return Ue.simpleAngle}}),Object.defineProperty(t,"simpleAngleTouch",{enumerable:!0,get:function(){return Ue.simpleAngleTouch}});var qe=o(14);Object.defineProperty(t,"simpleMouseButtonTool",{enumerable:!0,get:function(){return n(qe).default}});var Ge=o(114);Object.defineProperty(t,"textMarker",{enumerable:!0,get:function(){return Ge.textMarker}}),Object.defineProperty(t,"textMarkerTouch",{enumerable:!0,get:function(){return Ge.textMarkerTouch}});var Ke=o(10);Object.defineProperty(t,"touchDragTool",{enumerable:!0,get:function(){return n(Ke).default}});var Ze=o(55);Object.defineProperty(t,"touchPinchTool",{enumerable:!0,get:function(){return n(Ze).default}});var Je=o(9);Object.defineProperty(t,"touchTool",{enumerable:!0,get:function(){return n(Je).default}});var Qe=o(115);Object.defineProperty(t,"wwwc",{enumerable:!0,get:function(){return Qe.wwwc}}),Object.defineProperty(t,"wwwcTouchDrag",{enumerable:!0,get:function(){return Qe.wwwcTouchDrag}});var et=o(116);Object.defineProperty(t,"wwwclod",{enumerable:!0,get:function(){return et.wwwclod}}),Object.defineProperty(t,"wwwclodTouchDrag",{enumerable:!0,get:function(){return et.wwwclodTouchDrag}});var tt=o(117);Object.defineProperty(t,"wwwcRegion",{enumerable:!0,get:function(){return tt.wwwcRegion}}),Object.defineProperty(t,"wwwcRegionTouch",{enumerable:!0,get:function(){return tt.wwwcRegionTouch}});var ot=o(118);Object.defineProperty(t,"zoom",{enumerable:!0,get:function(){return ot.zoom}}),Object.defineProperty(t,"zoomWheel",{enumerable:!0,get:function(){return ot.zoomWheel}}),Object.defineProperty(t,"zoomTouchPinch",{enumerable:!0,get:function(){return ot.zoomTouchPinch}}),Object.defineProperty(t,"zoomTouchDrag",{enumerable:!0,get:function(){return ot.zoomTouchDrag}});var nt=o(119);Object.defineProperty(t,"brush",{enumerable:!0,get:function(){return nt.brush}});var at=o(120);Object.defineProperty(t,"version",{enumerable:!0,get:function(){return n(at).default}})},function(e,t,o){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var n=o(0),a=function(e){if(e&&e.__esModule)return e;var t={};if(null!=e)for(var o in e)Object.prototype.hasOwnProperty.call(e,o)&&(t[o]=e[o]);return t.default=e,t}(n),r=a.metaData;t.default=r},function(e,t,o){"use strict";function n(e){return e&&e.__esModule?e:{default:e}}Object.defineProperty(t,"__esModule",{value:!0});var a=o(38),r=n(a),i=o(59),l=n(i),s=o(39),u=n(s),d={calculateReferenceLine:r.default,tool:l.default,renderActiveReferenceLine:u.default};t.default=d},function(e,t,o){"use strict";function n(e,t){var o=(0,s.getToolState)(e.currentTarget,c);if(void 0!==o){var n=o.data[0].synchronizationContext,a=n.getSourceElements(),r=o.data[0].renderer,i=t.canvasContext.canvas.getContext("2d");l.setToPixelCoordinateSystem(t.enabledElement,i),$.each(a,function(o,n){n!==e.currentTarget&&r(i,t,e.currentTarget,n)})}}function a(e,t,o){o=o||d.default,(0,s.addToolState)(e,c,{synchronizationContext:t,renderer:o}),$(e).on("CornerstoneImageRendered",n),l.updateImage(e)}function r(e){$(e).off("CornerstoneImageRendered",n),l.updateImage(e)}Object.defineProperty(t,"__esModule",{value:!0});var i=o(0),l=function(e){if(e&&e.__esModule)return e;var t={};if(null!=e)for(var o in e)Object.prototype.hasOwnProperty.call(e,o)&&(t[o]=e[o]);return t.default=e,t}(i),s=o(1),u=o(39),d=function(e){return e&&e.__esModule?e:{default:e}}(u),c="referenceLines",f={enable:a,disable:r};t.default=f},function(e,t,o){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.default=function(e){for(var t="",o=e.x<0?"R":"L",n=e.y<0?"A":"P",r=e.z<0?"F":"H",i=new a.Vector3(Math.abs(e.x),Math.abs(e.y),Math.abs(e.z)),l=0;l<3;l++)if(i.x>1e-4&&i.x>i.y&&i.x>i.z)t+=o,i.x=0;else if(i.y>1e-4&&i.y>i.x&&i.y>i.z)t+=n,i.y=0;else{if(!(i.z>1e-4&&i.z>i.x&&i.z>i.y))break;t+=r,i.z=0}return t};var n=o(2),a=function(e){if(e&&e.__esModule)return e;var t={};if(null!=e)for(var o in e)Object.prototype.hasOwnProperty.call(e,o)&&(t[o]=e[o]);return t.default=e,t}(n)},function(e,t,o){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.default=function(e){var t=e.replace("H","f");return t=t.replace("F","h"),t=t.replace("R","l"),t=t.replace("L","r"),t=t.replace("A","p"),t=t.replace("P","a"),t=t.toUpperCase()}},function(e,t,o){"use strict";function n(e){return e&&e.__esModule?e:{default:e}}function a(e){var t=[];e.timeSeries.stacks.forEach(function(o){var n=void 0;n=!0===o.preventCache?s.loadImage(o.imageIds[e.imageIdIndex]):s.loadAndCacheImage(o.imageIds[e.imageIdIndex]),n.then(function(o){var n=Math.round(e.handles.end.x)+Math.round(e.handles.end.y)*o.width,a=o.getPixelData()[n];t.push(a)})}),e.lineSample.set(t)}function r(e){var t=(0,m.getToolState)(e.element,"timeSeries");if(void 0!==t&&void 0!==t.data&&0!==t.data.length){var o=t.data[0],n={timeSeries:o,lineSample:new y.default,imageIdIndex:o.stacks[o.currentStackIndex].currentImageIdIndex,visible:!0,handles:{end:{x:e.currentPoints.image.x,y:e.currentPoints.image.y,highlight:!0,active:!0}}};return a(n),p.default.add(n),n}}function i(e,t){var o=(0,m.getToolState)(e.currentTarget,C);if(o){var n=t.canvasContext.canvas.getContext("2d");s.setToPixelCoordinateSystem(t.enabledElement,n);for(var a=0;a<o.data.length;a++){n.save();var r=o.data[a];n.beginPath(),(0,f.default)(n,t,r.handles,"white"),n.stroke();var i=(0,v.default)(t.enabledElement,t.canvasContext,15);n.font=i.fontSize+"px Arial";var l=Math.round(r.handles.end.x),u=Math.round(r.handles.end.y),d=r.handles.end.x+3,c=r.handles.end.y-3;n.fillStyle="white",n.fillText(l+","+u,d,c),n.restore()}}}Object.defineProperty(t,"__esModule",{value:!0});var l=o(0),s=function(e){if(e&&e.__esModule)return e;var t={};if(null!=e)for(var o in e)Object.prototype.hasOwnProperty.call(e,o)&&(t[o]=e[o]);return t.default=e,t}(l),u=o(8),d=n(u),c=o(7),f=n(c),g=o(41),v=n(g),m=o(1),h=o(63),p=n(h),T=o(64),y=n(T),C="probe4D",x=(0,d.default)({createNewMeasurement:r,onImageRendered:i,toolType:C});t.default=x},function(e,t,o){"use strict";function n(){var e=this;e.measurements=[],this.add=function(t){var o=e.measurements.push(t),n={index:o,measurement:t};$(e).trigger("CornerstoneMeasurementAdded",n)},this.remove=function(t){var o=e.measurements[t];e.measurements.splice(t,1);var n={index:t,measurement:o};$(e).trigger("CornerstoneMeasurementRemoved",n)}}Object.defineProperty(t,"__esModule",{value:!0});var a=new n;t.default=a},function(e,t,o){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.default=function(){var e=this;e.samples=[],this.set=function(t){e.samples=t,$(e).trigger("CornerstoneLineSampleUpdated")}}},function(e,t,o){"use strict";function n(e,t){if(void 0===e)throw new Error("playClip: element must not be undefined");void 0===t&&(t=30);var o=(0,r.getToolState)(e,"timeSeries");if(void 0!==o&&void 0!==o.data&&0!==o.data.length){var n=(0,r.getToolState)(e,s),a=void 0;void 0===n||0===n.data.length?(a={intervalId:void 0,framesPerSecond:t,lastFrameTimeStamp:void 0,frameRate:0},(0,r.addToolState)(e,s,a)):(a=n.data[0],a.framesPerSecond=t),void 0===a.intervalId&&(a.intervalId=setInterval(function(){a.framesPerSecond>0?(0,l.default)(e,1,!0):(0,l.default)(e,-1,!0)},1e3/Math.abs(a.framesPerSecond)))}}function a(e){var t=(0,r.getToolState)(e,s);if(t&&t.data&&t.data.length){var o=t.data[0];clearInterval(o.intervalId),o.intervalId=void 0}}Object.defineProperty(t,"__esModule",{value:!0});var r=o(1),i=o(37),l=function(e){return e&&e.__esModule?e:{default:e}}(i),s="timeSeriesPlayer",u={start:n,stop:a};t.default=u},function(e,t,o){"use strict";function n(e){return e&&e.__esModule?e:{default:e}}function a(e,t){$(t.element).off("CornerstoneToolsMouseDrag",i),$(t.element).off("CornerstoneToolsMouseUp",a),$(t.element).off("CornerstoneToolsMouseClick",a)}function r(e,t){if((0,T.default)(t.which,e.data.mouseButtonMask)){var o={deltaY:0,options:e.data.options};return $(t.element).on("CornerstoneToolsMouseDrag",o,i),$(t.element).on("CornerstoneToolsMouseUp",a),$(t.element).on("CornerstoneToolsMouseClick",a),e.stopImmediatePropagation(),!1}}function i(e,t){e.data.deltaY+=t.deltaPoints.page.y;var o=(0,y.getToolState)(t.element,"timeSeries");if(void 0!==o&&void 0!==o.data&&0!==o.data.length){var n=o.data[0],a=$(t.element).height()/n.stacks.length;if(void 0!==e.data.options&&void 0!==e.data.options.timeSeriesScrollSpeed&&(a=e.data.options.timeSeriesScrollSpeed),e.data.deltaY>=a||e.data.deltaY<=-a){var r=Math.round(e.data.deltaY/a),i=e.data.deltaY%a;(0,h.default)(t.element,r),e.data.deltaY=i}return!1}}function l(e,t){var o=-t.direction;(0,h.default)(t.element,o)}function s(e){var t=e.originalEvent.detail,o={deltaY:0};o.deltaY+=t.deltaPoints.page.y;var n=(0,y.getToolState)(t.element,"stack");if(void 0!==n&&void 0!==n.data&&0!==n.data.length){if(o.deltaY>=3||o.deltaY<=-3){var a=o.deltaY/3,r=o.deltaY%3;(0,h.default)(o.element,a),o.deltaY=r}return!1}}Object.defineProperty(t,"__esModule",{value:!0}),t.timeSeriesScrollTouchDrag=t.timeSeriesScrollWheel=t.timeSeriesScroll=void 0;var u=o(14),d=n(u),c=o(10),f=n(c),g=o(22),v=n(g),m=o(37),h=n(m),p=o(3),T=n(p),y=o(1),C=(0,d.default)(r),x=(0,v.default)(l),b=(0,f.default)(s);t.timeSeriesScroll=C,t.timeSeriesScrollWheel=x,t.timeSeriesScrollTouchDrag=b},function(e,t,o){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.default=function(e,t,o){if(o!==t){var n=a.getViewport(t),r=a.getViewport(o);r.voi.windowWidth===n.voi.windowWidth&&r.voi.windowCenter===n.voi.windowCenter&&r.invert===n.invert||(r.voi.windowWidth=n.voi.windowWidth,r.voi.windowCenter=n.voi.windowCenter,r.invert=n.invert,e.setViewport(o,r))}};var n=o(0),a=function(e){if(e&&e.__esModule)return e;var t={};if(null!=e)for(var o in e)Object.prototype.hasOwnProperty.call(e,o)&&(t[o]=e[o]);return t.default=e,t}(n)},function(e,t,o){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.default=function(e,t,o){o!==t&&a.updateImage(o)};var n=o(0),a=function(e){if(e&&e.__esModule)return e;var t={};if(null!=e)for(var o in e)Object.prototype.hasOwnProperty.call(e,o)&&(t[o]=e[o]);return t.default=e,t}(n)},function(e,t,o){"use strict";function n(e,t){function o(e,t){l.length&&s.length&&(u=!0,s.forEach(function(o){var n=s.indexOf(o);if(-1!==n){var a=d.imageIds.targetElements[n],r=l.indexOf(e);if(-1!==r){var u=d.imageIds.sourceElements[r],f=void 0;f=u===a?0:d.distances[u][a],c(i,e,o,t,f)}}}),u=!1)}function n(e,t){!0!==u&&o(e.currentTarget,t)}function a(e,t){var o=t.element;i.remove(o)}var i=this,l=[],s=[],u=!1,d={},c=t;this.setHandler=function(e){c=e},this.getHandler=function(){return c},this.getDistances=function(){l.length&&s.length&&(d.distances={},d.imageIds={sourceElements:[],targetElements:[]},l.forEach(function(e){var t=r.getEnabledElement(e);if(t&&t.image){var o=t.image.imageId,n=r.metaData.get("imagePlane",o);if(n&&n.imagePositionPatient){var a=n.imagePositionPatient;d.hasOwnProperty(t)||(d.distances[o]={},d.imageIds.sourceElements.push(o),s.forEach(function(t){var n=r.getEnabledElement(t);if(n&&n.image){var i=n.image.imageId;if(d.imageIds.targetElements.push(i),e!==t&&o!==i&&!d.distances[o].hasOwnProperty(i)){var l=r.metaData.get("imagePlane",i);if(l&&l.imagePositionPatient){var s=l.imagePositionPatient;d.distances[o][i]=s.clone().sub(a)}}}}),Object.keys(d.distances[o]).length||delete d.distances[o])}}}))},this.addSource=function(t){-1===l.indexOf(t)&&(l.push(t),$(t).on(e,n),i.getDistances(),i.updateDisableHandlers())},this.addTarget=function(e){-1===s.indexOf(e)&&(s.push(e),i.getDistances(),c(i,e,e,0),i.updateDisableHandlers())},this.add=function(e){i.addSource(e),i.addTarget(e)},this.removeSource=function(t){var a=l.indexOf(t);-1!==a&&(l.splice(a,1),$(t).off(e,n),i.getDistances(),o(t),i.updateDisableHandlers())},this.removeTarget=function(e){var t=s.indexOf(e);-1!==t&&(s.splice(t,1),i.getDistances(),c(i,e,e,0),i.updateDisableHandlers())},this.remove=function(e){i.removeTarget(e),i.removeSource(e)},this.getSourceElements=function(){return l},this.getTargetElements=function(){return s},this.displayImage=function(e,t,o){u=!0,r.displayImage(e,t,o),u=!1},this.setViewport=function(e,t){u=!0,r.setViewport(e,t),u=!1},this.updateDisableHandlers=function(){$.unique(l.concat(s)).forEach(function(e){$(e).off("CornerstoneElementDisabled",a),$(e).on("CornerstoneElementDisabled",a)})},this.destroy=function(){$.unique(l.concat(s)).forEach(function(e){i.remove(e)})}}Object.defineProperty(t,"__esModule",{value:!0});var a=o(0),r=function(e){if(e&&e.__esModule)return e;var t={};if(null!=e)for(var o in e)Object.prototype.hasOwnProperty.call(e,o)&&(t[o]=e[o]);return t.default=e,t}(a);t.default=n},function(e,t,o){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.default=function(e,t,o,n){if(t!==o&&n&&n.direction){var i=(0,r.getToolState)(o,"stack"),s=i.data[0],u=s.currentImageIdIndex+n.direction;if(u=Math.min(Math.max(u,0),s.imageIds.length-1),s.currentImageIdIndex!==u){var d=l.default.getStartLoadHandler(),c=l.default.getEndLoadHandler(),f=l.default.getErrorLoadingHandler();d&&d(o);var g=void 0;g=!0===s.preventCache?a.loadImage(s.imageIds[u]):a.loadAndCacheImage(s.imageIds[u]),g.then(function(t){var n=a.getViewport(o);s.currentImageIdIndex=u,e.displayImage(o,t,n),c&&c(o,t)},function(e){var t=s.imageIds[u];f&&f(o,t,e)})}}};var n=o(0),a=function(e){if(e&&e.__esModule)return e;var t={};if(null!=e)for(var o in e)Object.prototype.hasOwnProperty.call(e,o)&&(t[o]=e[o]);return t.default=e,t}(n),r=o(1),i=o(11),l=function(e){return e&&e.__esModule?e:{default:e}}(i)},function(e,t,o){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.default=function(e,t,o){if(o!==t){var n=a.getEnabledElement(t).image,i=a.metaData.get("imagePlane",n.imageId),s=i.imagePositionPatient,u=(0,r.getToolState)(o,"stack"),d=u.data[0],c=Number.MAX_VALUE,f=-1;if($.each(d.imageIds,function(e,t){var o=a.metaData.get("imagePlane",t),n=o.imagePositionPatient,r=n.distanceToSquared(s);r<c&&(c=r,f=e)}),f!==d.currentImageIdIndex){var g=l.default.getStartLoadHandler(),v=l.default.getEndLoadHandler(),m=l.default.getErrorLoadingHandler();if(g&&g(o),-1!==f){var h=void 0;h=!0===d.preventCache?a.loadImage(d.imageIds[f]):a.loadAndCacheImage(d.imageIds[f]),h.then(function(t){var n=a.getViewport(o);d.currentImageIdIndex=f,e.displayImage(o,t,n),v&&v(o,t)},function(e){var t=d.imageIds[f];m&&m(o,t,e)})}}}};var n=o(0),a=function(e){if(e&&e.__esModule)return e;var t={};if(null!=e)for(var o in e)Object.prototype.hasOwnProperty.call(e,o)&&(t[o]=e[o]);return t.default=e,t}(n),r=o(1),i=o(11),l=function(e){return e&&e.__esModule?e:{default:e}}(i)},function(e,t,o){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.default=function(e,t,o,n,i){if(o!==t){var s=a.getEnabledElement(t),u=a.metaData.get("imagePlane",s.image.imageId),d=u.imagePositionPatient,c=(0,r.getToolState)(o,"stack"),f=c.data[0],g=Number.MAX_VALUE,v=-1;if(i){var m=d.clone().add(i);if(f.imageIds.forEach(function(e,t){var o=a.metaData.get("imagePlane",e),n=o.imagePositionPatient,r=m.distanceToSquared(n);r<g&&(g=r,v=t)}),v!==f.currentImageIdIndex&&-1!==v){var h=l.default.getStartLoadHandler(),p=l.default.getEndLoadHandler(),T=l.default.getErrorLoadingHandler();h&&h(o);var y=void 0;y=!0===f.preventCache?a.loadImage(f.imageIds[v]):a.loadAndCacheImage(f.imageIds[v]),y.then(function(t){var n=a.getViewport(o);f.currentImageIdIndex=v,e.displayImage(o,t,n),p&&p(o,t)},function(e){var t=f.imageIds[v];T&&T(o,t,e)})}}}};var n=o(0),a=function(e){if(e&&e.__esModule)return e;var t={};if(null!=e)for(var o in e)Object.prototype.hasOwnProperty.call(e,o)&&(t[o]=e[o]);return t.default=e,t}(n),r=o(1),i=o(11),l=function(e){return e&&e.__esModule?e:{default:e}}(i)},function(e,t,o){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.default=function(e,t,o){if(o!==t){var n=(0,r.getToolState)(t,"stack"),i=n.data[0],s=(0,r.getToolState)(o,"stack"),u=s.data[0],d=i.currentImageIdIndex;if((d=Math.min(Math.max(d,0),u.imageIds.length-1))!==u.currentImageIdIndex){var c=l.default.getStartLoadHandler(),f=l.default.getEndLoadHandler(),g=l.default.getErrorLoadingHandler();c&&c(o);var v=void 0;v=!0===u.preventCache?a.loadImage(u.imageIds[d]):a.loadAndCacheImage(u.imageIds[d]),v.then(function(t){var n=a.getViewport(o);u.currentImageIdIndex=d,e.displayImage(o,t,n),f&&f(o,t)},function(e){var t=u.imageIds[d];g&&g(o,t,e)})}}};var n=o(0),a=function(e){if(e&&e.__esModule)return e;var t={};if(null!=e)for(var o in e)Object.prototype.hasOwnProperty.call(e,o)&&(t[o]=e[o]);return t.default=e,t}(n),r=o(1),i=o(11),l=function(e){return e&&e.__esModule?e:{default:e}}(i)},function(e,t,o){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.default=function(e,t,o){if(o!==t){var n=a.getViewport(t),r=a.getViewport(o);r.scale===n.scale&&r.translation.x===n.translation.x&&r.translation.y===n.translation.y||(r.scale=n.scale,r.translation.x=n.translation.x,r.translation.y=n.translation.y,e.setViewport(o,r))}};var n=o(0),a=function(e){if(e&&e.__esModule)return e;var t={};if(null!=e)for(var o in e)Object.prototype.hasOwnProperty.call(e,o)&&(t[o]=e[o]);return t.default=e,t}(n)},function(e,t,o){"use strict";function n(e,t){function o(o,n,r){if(!(e.indexOf(n)>=0))return t.add(o,n,r);!1===a.hasOwnProperty(n)&&(a[n]={data:[]}),a[n].data.push(r)}function n(o,n){return e.indexOf(n)>=0?(!1===a.hasOwnProperty(n)&&(a[n]={data:[]}),a[n]):t.get(o,n)}var a={};return{get:n,add:o}}function a(e,t){t=t||["timeSeries"];var o=(0,i.getElementToolStateManager)(e);void 0===o&&(o=r.globalImageIdSpecificToolStateManager);var a=n(t,o);l.push(a),(0,i.setElementToolStateManager)(e,a)}Object.defineProperty(t,"__esModule",{value:!0}),t.newTimeSeriesSpecificToolStateManager=t.addTimeSeriesStateManager=void 0;var r=o(16),i=o(1),l=[];t.addTimeSeriesStateManager=a,t.newTimeSeriesSpecificToolStateManager=n},function(e,t,o){"use strict";function n(e,t){function o(){return i}function n(e){i=e}function a(o,n,a){if(!(e.indexOf(n)>=0))return t.add(o,n,a);!1===i.hasOwnProperty(n)&&(i[n]={data:[]}),i[n].data.push(a)}function r(o,n){return e.indexOf(n)>=0?(!1===i.hasOwnProperty(n)&&(i[n]={data:[]}),i[n]):t.get(o,n)}var i={};return{get:r,add:a,saveToolState:o,restoreToolState:n,toolState:i}}function a(e,t){var o=(0,i.getElementToolStateManager)(e);o||(o=r.globalImageIdSpecificToolStateManager);var a=["stack","stackPrefetch","playClip","volume","slab","referenceLines","crosshairs","stackRenderer"];t&&(a=a.concat(t));var s=n(a,o);l.push(s),(0,i.setElementToolStateManager)(e,s)}Object.defineProperty(t,"__esModule",{value:!0}),t.addStackStateManager=t.newStackSpecificToolStateManager=void 0;var r=o(16),i=o(1),l=[];t.newStackSpecificToolStateManager=n,t.addStackStateManager=a},function(e,t,o){"use strict";function n(){function e(e,t,o){!1===n.hasOwnProperty(e)&&(n[e]={});var a=n[e];!1===a.hasOwnProperty(t)&&(a[t]={data:[]}),a[t].data.push(o)}function t(e,t){if(!1!==n.hasOwnProperty(e)){var o=n[e];if(!1!==o.hasOwnProperty(t)){return o[t]}}}function o(e,t,o){if(!1!==n.hasOwnProperty(e)){var a=n[e];if(!1!==a.hasOwnProperty(t)){for(var r=a[t],i=-1,l=0;l<r.data.length;l++)r.data[l]===o&&(i=l);-1!==i&&r.data.splice(i,1)}}}var n={};return{get:t,add:e,remove:o}}Object.defineProperty(t,"__esModule",{value:!0});var a=n();t.newFrameOfReferenceSpecificToolStateManager=n,t.globalFrameOfReferenceSpecificToolStateManager=a},function(e,t,o){"use strict";function n(e){var t={imageIdToolState:l.globalImageIdSpecificToolStateManager.saveToolState(),elementToolState:{},elementViewport:{}};return e.forEach(function(e){var o=(0,s.getElementToolStateManager)(e);o!==l.globalImageIdSpecificToolStateManager&&(t.elementToolState[e.id]=o.saveToolState(),t.elementViewport[e.id]=i.getViewport(e))}),t}function a(e){if(e.hasOwnProperty("imageIdToolState")&&e.hasOwnProperty("elementToolState")&&e.hasOwnProperty("elementViewport"))return l.globalImageIdSpecificToolStateManager.restoreToolState(e.imageIdToolState),Object.keys(e.elementViewport).forEach(function(t){var o=document.getElementById(t);if(o&&e.elementToolState.hasOwnProperty(t)){var n=(0,s.getElementToolStateManager)(o);if(n!==l.globalImageIdSpecificToolStateManager){n.restoreToolState(e.elementToolState[t]);var a=e.elementViewport[t];i.setViewport(o,a),i.updateImage(o)}}}),e}Object.defineProperty(t,"__esModule",{value:!0});var r=o(0),i=function(e){if(e&&e.__esModule)return e;var t={};if(null!=e)for(var o in e)Object.prototype.hasOwnProperty.call(e,o)&&(t[o]=e[o]);return t.default=e,t}(r),l=o(16),s=o(1),u={save:n,restore:a};t.default=u},function(e,t,o){"use strict";function n(e){return e&&e.__esModule?e:{default:e}}function a(e,t){var o=t.keyCode;if(o===u.UP||o===u.DOWN){var n=1;o===u.DOWN&&(n=-1),(0,i.default)(t.element,n)}}Object.defineProperty(t,"__esModule",{value:!0});var r=o(33),i=n(r),l=o(49),s=n(l),u={UP:38,DOWN:40},d=(0,s.default)(a);t.default=d},function(e,t,o){"use strict";function n(e){return e&&e.__esModule?e:{default:e}}function a(e,t){e=Math.round(e)||0,t=Math.round(t)||0;var o=[],n=t-e+1;if(n<=0)return o;for(;n--;)o[n]=t--;return o}function r(e,t){var o=[],n=[];return e.forEach(function(e){e<t?o.push(e):e>t&&n.push(e)}),{low:e.indexOf(S(o)),high:e.indexOf(I(n))}}function i(e){function t(e){var t=s.indicesToRequest.indexOf(e);t>-1&&s.indicesToRequest.splice(t,1)}function o(e){t(i.imageIds.indexOf(e.imageId))}function n(t){console.log("prefetch errored"),f&&f(e,d,t,"stackPrefetch")}var a=(0,y.getToolState)(e,"stack");if(a&&a.data&&a.data.length){var i=a.data[0],l=(0,y.getToolState)(e,x);if(l){var s=l.data[0]||{};if(s.indicesToRequest&&s.indicesToRequest.length||(s.enabled=!1),!1!==s.enabled){l.data[0].indicesToRequest.sort(function(e,t){return e-t});if(s.indicesToRequest.slice().forEach(function(e){var o=i.imageIds[e];if(o){var n=v.imageCache.getImagePromise(o);n&&"resolved"===n.state()&&t(e)}}),s.indicesToRequest.length){h.default.clearRequestStack(b,e);for(var u=r(s.indicesToRequest,i.currentImageIdIndex),d=void 0,c=void 0,f=T.default.getErrorLoadingHandler(),g=u.low,m=u.high;g>0||m<s.indicesToRequest.length;)g>=0&&(c=s.indicesToRequest[g--],d=i.imageIds[c],h.default.addRequest(e,d,b,!1,o,n)),m<s.indicesToRequest.length&&(c=s.indicesToRequest[m++],d=i.imageIds[c],h.default.addRequest(e,d,b,!1,o,n));h.default.startGrabbing()}}}}}function l(e,t){var o=e.data.element,n=void 0;try{n=(0,y.getToolState)(o,"stack")}catch(e){return}if(n&&n.data&&n.data.length){var a=n.data[0],r=a.imageIds.indexOf(t.imageId);if(!(r<0)){var i=(0,y.getToolState)(o,x);i&&i.data&&i.data.length&&i.data[0].indicesToRequest.push(r)}}}function s(e){clearTimeout(w),w=setTimeout(function(){var t=e.target;try{i(t)}catch(e){return}},P)}function u(e){(0,y.getToolState)(e,x).data=[];var t=(0,y.getToolState)(e,"stack");if(t&&t.data&&t.data.length){var o=t.data[0];if(!0===o.preventCache)return void console.warn("A stack that should not be cached was given the stackPrefetch");var n={indicesToRequest:a(0,o.imageIds.length-1),enabled:!0,direction:1},r=n.indicesToRequest.indexOf(o.currentImageIdIndex);n.indicesToRequest.splice(r,1),(0,y.addToolState)(e,x,n),i(e),$(e).off("CornerstoneNewImage",s),$(e).on("CornerstoneNewImage",s),$(v.events).off("CornerstoneImageCachePromiseRemoved",l),$(v.events).on("CornerstoneImageCachePromiseRemoved",{element:e},l)}}function d(e){clearTimeout(w),$(e).off("CornerstoneNewImage",s),$(v.events).off("CornerstoneImageCachePromiseRemoved",l);var t=(0,y.getToolState)(e,x);t&&t.data.length&&(t.data[0].enabled=!1,h.default.clearRequestStack(b))}function c(){return M}function f(e){M=e,e.maxSimultaneousRequests&&(0,C.setMaxSimultaneousRequests)(e.maxSimultaneousRequests)}Object.defineProperty(t,"__esModule",{value:!0});var g=o(0),v=function(e){if(e&&e.__esModule)return e;var t={};if(null!=e)for(var o in e)Object.prototype.hasOwnProperty.call(e,o)&&(t[o]=e[o]);return t.default=e,t}(g),m=o(31),h=n(m),p=o(11),T=n(p),y=o(1),C=o(17),x="stackPrefetch",b="interaction",M={},w=void 0,P=300,S=function(e){return Math.max.apply(null,e)},I=function(e){return Math.min.apply(null,e)},O={enable:u,disable:d,getConfiguration:c,setConfiguration:f};t.default=O},function(e,t,o){"use strict";function n(e,t){var o=t.element,n=t.enabledElement.canvas.width,a=t.enabledElement.canvas.height;if(!n||!a)return!1;var r=t.enabledElement.canvas.getContext("2d");r.setTransform(1,0,0,1,0,0),r.save();var s=u.getConfiguration();r.fillStyle=s.backgroundColor,"horizontal"===s.orientation?r.fillRect(0,a-l,n,l):r.fillRect(0,0,l,a);var d=(0,i.getToolState)(o,"stack");if(d&&d.data&&d.data.length){var c=d.data[0].imageIds,f=d.data[0].currentImageIdIndex,g=n/c.length,v=a/c.length,m=g*f,h=v*f;r.fillStyle=s.fillColor,"horizontal"===s.orientation?r.fillRect(m,a-l,g,l):r.fillRect(0,h,l,v),r.restore()}}Object.defineProperty(t,"__esModule",{value:!0});var a=o(28),r=function(e){return e&&e.__esModule?e:{default:e}}(a),i=o(1),l=6,s={backgroundColor:"rgb(19, 63, 141)",fillColor:"white",orientation:"horizontal"},u=(0,r.default)(n);u.setConfiguration(s),t.default=u},function(e,t,o){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var n=o(83),a=function(e){return e&&e.__esModule?e:{default:e}}(n),r={};r.FusionRenderer=a.default,t.default=r},function(e,t,o){"use strict";function n(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}Object.defineProperty(t,"__esModule",{value:!0});var a=function(){function e(e,t){for(var o=0;o<t.length;o++){var n=t[o];n.enumerable=n.enumerable||!1,n.configurable=!0,"value"in n&&(n.writable=!0),Object.defineProperty(e,n.key,n)}}return function(t,o,n){return o&&e(t.prototype,o),n&&e(t,n),t}}(),r=o(0),i=function(e){if(e&&e.__esModule)return e;var t={};if(null!=e)for(var o in e)Object.prototype.hasOwnProperty.call(e,o)&&(t[o]=e[o]);return t.default=e,t}(r),l=function(){function e(){n(this,e),this.currentImageIdIndex=0,this.layerIds=[],this.findImageFn=void 0}return a(e,[{key:"render",value:function(e,t){var o=this;if(!Number.isInteger(this.currentImageIdIndex))throw new Error("FusionRenderer: render - Image ID Index is not an integer");if(!this.findImageFn)throw new Error("No findImage function has been defined");var n=t[0],a=n.imageIds[this.currentImageIdIndex];i.loadAndCacheImage(a).then(function(r){if(o.layerIds&&o.layerIds[0]){var l=o.layerIds[0];i.getLayer(e,l).image=r}else{var s=i.addLayer(e,r,n.options);o.layerIds.push(s)}i.updateImage(e),t.slice(1,t.length).forEach(function(t,n){var r=o.findImageFn(t.imageIds,a,1);r&&i.loadAndCacheImage(r).then(function(a){var r=n+1;if(o.layerIds&&o.layerIds[r]){var l=o.layerIds[r];i.getLayer(e,l).image=a}else{var s=i.addLayer(e,a,t.options);o.layerIds.push(s)}i.updateImage(e,!0)})})})}}]),e}();t.default=l},function(e,t,o){"use strict";function n(e,t){var o=void 0,n=void 0,a=void 0,r=0,i=e.length,l=[];for(l.isTimeVarying=!1,("number"!=typeof t||t<=0)&&(t=1),o=1;o<i;o++)a=Number(e[o])/t|0,l.push(a),1===o?n=a:a!==n&&(l.isTimeVarying=!0),r+=a;return l.length>0&&(a=l.isTimeVarying?r/l.length|0:l[0],l.push(a)),l}function a(e){var t=e.intervalId;void 0!==t&&(e.intervalId=void 0,e.usingFrameTimeVector?clearTimeout(t):clearInterval(t))}function r(e){var t={element:e},o=$.Event("CornerstoneToolsClipStopped",t);$(e).trigger(o,t)}function i(e,t){var o=void 0,i=void 0;if(void 0===e)throw new Error("playClip: element must not be undefined");var l=(0,f.getToolState)(e,"stack");if(l&&l.data&&l.data.length){var s=l.data[0],d=(0,f.getToolState)(e,g);d&&d.data&&d.data.length?(o=d.data[0],a(o)):(o={intervalId:void 0,framesPerSecond:30,lastFrameTimeStamp:void 0,frameRate:0,frameTimeVector:void 0,ignoreFrameTimeVector:!1,usingFrameTimeVector:!1,speed:1,reverse:!1,loop:!0},(0,f.addToolState)(e,g,o)),(t<0||t>0)&&(o.framesPerSecond=Number(t),o.reverse=o.framesPerSecond<0,o.ignoreFrameTimeVector=!0),!0!==o.ignoreFrameTimeVector&&o.frameTimeVector&&o.frameTimeVector.length===s.imageIds.length&&(i=n(o.frameTimeVector,o.speed));var v=function(){var t=void 0,n=void 0,i=void 0,l=void 0,d=void 0,f=s.currentImageIdIndex,g=s.imageIds.length;if(o.reverse?f--:f++,!o.loop&&(f<0||f>=g))return a(o),void r(e);f>=g&&(f=0),f<0&&(f=g-1),f!==s.currentImageIdIndex&&(i=c.default.getStartLoadHandler(),l=c.default.getEndLoadHandler(),d=c.default.getErrorLoadingHandler(),i&&i(e),n=u.getViewport(e),t=!0===s.preventCache?u.loadImage(s.imageIds[f]):u.loadAndCacheImage(s.imageIds[f]),t.then(function(t){s.currentImageIdIndex=f,u.displayImage(e,t,n),l&&l(e,t)},function(t){var o=s.imageIds[f];d&&d(e,o,t)}))};i&&i.length>0&&i.isTimeVarying?(o.usingFrameTimeVector=!0,o.intervalId=setTimeout(function e(){o.intervalId=setTimeout(e,i[s.currentImageIdIndex]),v()},0)):(o.usingFrameTimeVector=!1,o.intervalId=setInterval(v,1e3/Math.abs(o.framesPerSecond)))}}function l(e){var t=(0,f.getToolState)(e,g);t&&t.data&&t.data.length&&a(t.data[0])}Object.defineProperty(t,"__esModule",{value:!0}),t.stopClip=t.playClip=void 0;var s=o(0),u=function(e){if(e&&e.__esModule)return e;var t={};if(null!=e)for(var o in e)Object.prototype.hasOwnProperty.call(e,o)&&(t[o]=e[o]);return t.default=e,t}(s),d=o(11),c=function(e){return e&&e.__esModule?e:{default:e}}(d),f=o(1),g="playClip";t.playClip=i,t.stopClip=l},function(e,t,o){"use strict";function n(e){var t=e.currentTarget,o={event:window.event||e,element:t,viewport:s.getViewport(t),image:s.getEnabledElement(t).image,currentPoints:{page:{x:u,y:d},image:s.pageToPixel(t,u,d)},keyCode:e.keyCode,which:e.which};o.currentPoints.canvas=s.pixelToCanvas(t,o.currentPoints.image);var n={keydown:"CornerstoneToolsKeyDown",keypress:"CornerstoneToolsKeyPress",keyup:"CornerstoneToolsKeyUp"};$(t).trigger(n[e.type],o)}function a(e){u=e.pageX||e.originalEvent.pageX,d=e.pageY||e.originalEvent.pageY}function r(e){i(e),$(e).on(c,n),$(e).on("mousemove",a)}function i(e){$(e).off(c,n),$(e).off("mousemove",a)}Object.defineProperty(t,"__esModule",{value:!0});var l=o(0),s=function(e){if(e&&e.__esModule)return e;var t={};if(null!=e)for(var o in e)Object.prototype.hasOwnProperty.call(e,o)&&(t[o]=e[o]);return t.default=e,t}(l),u=void 0,d=void 0,c="keydown keypress keyup",f={enable:r,disable:i};t.default=f},function(e,t,o){"use strict";function n(e){return e&&e.__esModule?e:{default:e}}function a(e){if(e&&e.__esModule)return e;var t={};if(null!=e)for(var o in e)Object.prototype.hasOwnProperty.call(e,o)&&(t[o]=e[o]);return t.default=e,t}function r(){x=!1}function i(e){$(e.element).trigger("CornerstoneToolsMouseDownActivate",e)}function l(e){var t=e.currentTarget,o="CornerstoneToolsMouseDoubleClick",n={page:h.point.pageToPoint(e),image:v.pageToPixel(t,e.pageX,e.pageY),client:{x:e.clientX,y:e.clientY}};n.canvas=v.pixelToCanvas(t,n.image);var a=(0,T.default)(n),r={event:e,which:e.buttons,viewport:v.getViewport(t),image:v.getEnabledElement(t).image,element:t,startPoints:n,lastPoints:a,currentPoints:n,deltaPoints:{x:0,y:0},type:o},i=$.Event(o,r);$(r.element).trigger(i,r)}function s(e){function t(e){var t={page:h.point.pageToPoint(e),image:v.pageToPixel(n,e.pageX,e.pageY),client:{x:e.clientX,y:e.clientY}};t.canvas=v.pixelToCanvas(n,t.image);var o={page:h.point.subtract(t.page,l.page),image:h.point.subtract(t.image,l.image),client:h.point.subtract(t.client,l.client),canvas:h.point.subtract(t.canvas,l.canvas)},r={which:c,viewport:v.getViewport(n),image:v.getEnabledElement(n).image,element:n,startPoints:a,lastPoints:l,currentPoints:t,deltaPoints:o,type:"CornerstoneToolsMouseDrag"};return $(r.element).trigger("CornerstoneToolsMouseDrag",r),l=(0,T.default)(t),(0,C.default)(e)}function o(e){clearTimeout(b);var r="CornerstoneToolsMouseUp";x&&(r="CornerstoneToolsMouseClick");var i={page:h.point.pageToPoint(e),image:v.pageToPixel(n,e.pageX,e.pageY),client:{x:e.clientX,y:e.clientY}};i.canvas=v.pixelToCanvas(n,i.image);var s={page:h.point.subtract(i.page,l.page),image:h.point.subtract(i.image,l.image),client:h.point.subtract(i.client,l.client),canvas:h.point.subtract(i.canvas,l.canvas)},d={event:e,which:c,viewport:v.getViewport(n),image:v.getEnabledElement(n).image,element:n,startPoints:a,lastPoints:l,currentPoints:i,deltaPoints:s,type:r},f=$.Event(r,d);$(d.element).trigger(f,d),$(document).off("mousemove",t),$(document).off("mouseup",o),$(d.element).on("mousemove",u),x=!0}b=setTimeout(r,M);var n=e.currentTarget;$(n).off("mousemove",u);var a={page:h.point.pageToPoint(e),image:v.pageToPixel(n,e.pageX,e.pageY),client:{x:e.clientX,y:e.clientY}};a.canvas=v.pixelToCanvas(n,a.image);var l=(0,T.default)(a),s={event:e,which:e.buttons,viewport:v.getViewport(n),image:v.getEnabledElement(n).image,element:n,startPoints:a,lastPoints:l,currentPoints:a,deltaPoints:{x:0,y:0},type:"CornerstoneToolsMouseDown"},d=$.Event("CornerstoneToolsMouseDown",s);if($(s.element).trigger(d,s),!1===d.isImmediatePropagationStopped()&&!0===i(s))return(0,C.default)(e);var c=e.buttons;return $(document).on("mousemove",t),$(document).on("mouseup",o),(0,C.default)(e)}function u(e){var t=e.currentTarget,o={page:h.point.pageToPoint(e),image:v.pageToPixel(t,e.pageX,e.pageY),client:{x:e.clientX,y:e.clientY}};o.canvas=v.pixelToCanvas(t,o.image);var n=(0,T.default)(o),a=e.buttons,r={page:h.point.pageToPoint(e),image:v.pageToPixel(t,e.pageX,e.pageY),client:{x:e.clientX,y:e.clientY}};r.canvas=v.pixelToCanvas(t,r.image);var i={page:h.point.subtract(r.page,n.page),image:h.point.subtract(r.image,n.image),client:h.point.subtract(r.client,n.client),canvas:h.point.subtract(r.canvas,n.canvas)},l={which:a,viewport:v.getViewport(t),image:v.getEnabledElement(t).image,element:t,startPoints:o,lastPoints:n,currentPoints:r,deltaPoints:i,type:"CornerstoneToolsMouseMove"};$(t).trigger("CornerstoneToolsMouseMove",l),n=(0,T.default)(r)}function d(e){$(e).off("mousedown",s),$(e).off("mousemove",u),$(e).off("dblclick",l)}function c(e){d(e),$(e).on("mousedown",s),$(e).on("mousemove",u),$(e).on("dblclick",l)}function f(){document.body.style.cursor="default"}Object.defineProperty(t,"__esModule",{value:!0});var g=o(0),v=a(g),m=o(2),h=a(m),p=o(36),T=n(p),y=o(35),C=n(y),x=!0,b=void 0,M=200,w={enable:c,disable:d,resetCursor:f};t.default=w},function(e,t,o){"use strict";function n(e){if(!("mousewheel"===e.originalEvent.type&&0===e.originalEvent.wheelDeltaY||"DOMMouseScroll"===e.originalEvent.type&&1===e.originalEvent.axis)){e.preventDefault();var t=e.currentTarget,o=void 0,n=void 0;void 0!==e.pageX&&void 0!==e.pageY?(o=e.pageX,n=e.pageY):e.originalEvent&&void 0!==e.originalEvent.pageX&&void 0!==e.originalEvent.pageY?(o=e.originalEvent.pageX,n=e.originalEvent.pageY):(o=e.x,n=e.y);var a=l.pageToPixel(t,o,n);e=window.event||e;var r=void 0;r=e.originalEvent&&e.originalEvent.wheelDelta?-e.originalEvent.wheelDelta:e.originalEvent&&e.originalEvent.deltaY?-e.originalEvent.deltaY:e.originalEvent&&e.originalEvent.detail?-e.originalEvent.detail:e.wheelDelta;var i=r<0?-1:1,s={element:t,viewport:l.getViewport(t),image:l.getEnabledElement(t).image,direction:i,pageX:o,pageY:n,imageX:a.x,imageY:a.y};$(t).trigger("CornerstoneToolsMouseWheel",s)}}function a(e){r(e),$(e).on(s,n)}function r(e){$(e).unbind(s,n)}Object.defineProperty(t,"__esModule",{value:!0});var i=o(0),l=function(e){if(e&&e.__esModule)return e;var t={};if(null!=e)for(var o in e)Object.prototype.hasOwnProperty.call(e,o)&&(t[o]=e[o]);return t.default=e,t}(i),s="mousewheel DOMMouseScroll",u={enable:a,disable:r};t.default=u},function(e,t,o){"use strict";function n(e){if(e&&e.__esModule)return e;var t={};if(null!=e)for(var o in e)Object.prototype.hasOwnProperty.call(e,o)&&(t[o]=e[o]);return t.default=e,t}function a(e){return e&&e.__esModule?e:{default:e}}function r(e){var t=e.currentTarget||e.srcEvent.currentTarget,o=void 0,n=void 0,a=void 0,r=void 0,i=void 0,l=void 0;switch(e.preventDefault(),(e.pointers&&e.pointers.length>1||e.originalEvent&&e.originalEvent.touches&&e.originalEvent.touches.length>1)&&(D=!1,clearTimeout(S)),e.type){case"tap":D=!1,clearTimeout(S),x={page:g.point.pageToPoint(e.pointers[0]),image:c.pageToPixel(t,e.pointers[0].pageX,e.pointers[0].pageY),client:{x:e.pointers[0].clientX,y:e.pointers[0].clientY}},x.canvas=c.pixelToCanvas(t,x.image),n="CornerstoneToolsTap",w={event:e,viewport:c.getViewport(t),image:c.getEnabledElement(t).image,element:t,currentPoints:x,type:n,isTouchEvent:!0},o=$.Event(n,w),$(t).trigger(o,w);break;case"doubletap":D=!1,clearTimeout(S),x={page:g.point.pageToPoint(e.pointers[0]),image:c.pageToPixel(t,e.pointers[0].pageX,e.pointers[0].pageY),client:{x:e.pointers[0].clientX,y:e.pointers[0].clientY}},x.canvas=c.pixelToCanvas(t,x.image),n="CornerstoneToolsDoubleTap",w={event:e,viewport:c.getViewport(t),image:c.getEnabledElement(t).image,element:t,currentPoints:x,type:n,isTouchEvent:!0},o=$.Event(n,w),$(t).trigger(o,w);break;case"pinchstart":D=!1,clearTimeout(S),O=1;break;case"pinchmove":if(D=!1,clearTimeout(S),!0===_){O=e.scale,_=!1;break}a=(e.scale-O)/O,C={page:e.center,image:c.pageToPixel(t,e.center.x,e.center.y)},C.canvas=c.pixelToCanvas(t,C.image),n="CornerstoneToolsTouchPinch",w={event:e,startPoints:C,viewport:c.getViewport(t),image:c.getEnabledElement(t).image,element:t,direction:e.scale<1?1:-1,scaleChange:a,type:n,isTouchEvent:!0},o=$.Event(n,w),$(t).trigger(o,w),O=e.scale;break;case"touchstart":O=1,clearTimeout(S),clearTimeout(P),P=setTimeout(function(){C={page:g.point.pageToPoint(e.originalEvent.touches[0]),image:c.pageToPixel(t,e.originalEvent.touches[0].pageX,e.originalEvent.touches[0].pageY),client:{x:e.originalEvent.touches[0].clientX,y:e.originalEvent.touches[0].clientY}},C.canvas=c.pixelToCanvas(t,C.image),n="CornerstoneToolsTouchStart",e.originalEvent.touches.length>1&&(n="CornerstoneToolsMultiTouchStart"),w={event:e,viewport:c.getViewport(t),image:c.getEnabledElement(t).image,element:t,startPoints:C,currentPoints:C,type:n,isTouchEvent:!0},o=$.Event(n,w),$(t).trigger(o,w),!1===o.isImmediatePropagationStopped()&&(n="CornerstoneToolsTouchStartActive",e.originalEvent.touches.length>1&&(n="CornerstoneToolsMultiTouchStartActive"),w.type=n,$(t).trigger(n,w)),b=(0,m.default)(C)},50),D=!0,I=0,S=setTimeout(function(){D&&(x={page:g.point.pageToPoint(e.originalEvent.touches[0]),image:c.pageToPixel(t,e.originalEvent.touches[0].pageX,e.originalEvent.touches[0].pageY),client:{x:e.originalEvent.touches[0].clientX,y:e.originalEvent.touches[0].clientY}},x.canvas=c.pixelToCanvas(t,C.image),n="CornerstoneToolsTouchPress",w={event:e,viewport:c.getViewport(t),image:c.getEnabledElement(t).image,element:t,currentPoints:x,type:n,isTouchEvent:!0},o=$.Event(n,w),$(t).trigger(o,w))},E);break;case"touchend":O=1,D=!1,clearTimeout(S),setTimeout(function(){C={page:g.point.pageToPoint(e.originalEvent.changedTouches[0]),image:c.pageToPixel(t,e.originalEvent.changedTouches[0].pageX,e.originalEvent.changedTouches[0].pageY),client:{x:e.originalEvent.changedTouches[0].clientX,y:e.originalEvent.changedTouches[0].clientY}},C.canvas=c.pixelToCanvas(t,C.image),n="CornerstoneToolsTouchEnd",w={event:e,viewport:c.getViewport(t),image:c.getEnabledElement(t).image,element:t,startPoints:C,currentPoints:C,type:n,isTouchEvent:!0},o=$.Event(n,w),$(t).trigger(o,w)},50);break;case"panmove":r={x:e.deltaX-j.x,y:e.deltaY-j.y},j={x:e.deltaX,y:e.deltaY},x={page:{x:b.page.x+r.x,y:b.page.y+r.y},image:c.pageToPixel(t,b.page.x+r.x,b.page.y+r.y),client:{x:b.client.x+r.x,y:b.client.y+r.y}},x.canvas=c.pixelToCanvas(t,x.image),M={page:g.point.subtract(x.page,b.page),image:g.point.subtract(x.image,b.image),client:g.point.subtract(x.client,b.client),canvas:g.point.subtract(x.canvas,b.canvas)},I+=Math.sqrt(M.page.x*M.page.x+M.page.y*M.page.y),I>R&&(D=!1,clearTimeout(S)),n="CornerstoneToolsTouchDrag",e.pointers.length>1&&(n="CornerstoneToolsMultiTouchDrag"),w={viewport:c.getViewport(t),image:c.getEnabledElement(t).image,element:t,startPoints:C,lastPoints:b,currentPoints:x,deltaPoints:M,numPointers:e.pointers.length,type:n,isTouchEvent:!0},o=$.Event(n,w),$(t).trigger(o,w),b=(0,m.default)(x);break;case"panstart":j={x:e.deltaX,y:e.deltaY},x={page:g.point.pageToPoint(e.pointers[0]),image:c.pageToPixel(t,e.pointers[0].pageX,e.pointers[0].pageY),client:{x:e.pointers[0].clientX,y:e.pointers[0].clientY}},x.canvas=c.pixelToCanvas(t,x.image),b=(0,m.default)(x);break;case"panend":return D=!1,(clearTimeout(S),b)?(x={page:g.point.pageToPoint(e.pointers[0]),image:c.pageToPixel(t,e.pointers[0].pageX,e.pointers[0].pageY),client:{x:e.pointers[0].clientX,y:e.pointers[0].clientY}},x.canvas=c.pixelToCanvas(t,x.image),M={page:g.point.subtract(x.page,b.page),image:g.point.subtract(x.image,b.image),client:g.point.subtract(x.client,b.client),canvas:g.point.subtract(x.canvas,b.canvas)},n="CornerstoneToolsDragEnd",w={event:e.srcEvent,viewport:c.getViewport(t),image:c.getEnabledElement(t).image,element:t,startPoints:C,lastPoints:b,currentPoints:x,deltaPoints:M,type:n,isTouchEvent:!0},o=$.Event(n,w),$(t).trigger(o,w),i=e.pointers.length-e.changedPointers.length,2===i&&(_=!0),(0,p.default)(e)):!1;case"rotatemove":D=!1,clearTimeout(S),l=e.rotation-k,k=e.rotation,n="CornerstoneToolsTouchRotate",w={event:e.srcEvent,viewport:c.getViewport(t),image:c.getEnabledElement(t).image,element:t,rotation:l,type:n},o=$.Event(n,w),$(t).trigger(o,w)}return!1}function i(e){l(e);var t={inputClass:u.default.SUPPORT_POINTER_EVENTS?u.default.PointerEventInput:u.default.TouchInput},o=new u.default.Manager(e,t),n={pointers:0,direction:u.default.DIRECTION_ALL,threshold:0},a=new u.default.Pan(n),i=new u.default.Pinch({threshold:0}),s=new u.default.Rotate({threshold:0});i.recognizeWith(a),i.recognizeWith(s),s.recognizeWith(a);var d=new u.default.Tap({event:"doubletap",taps:2,interval:1500,threshold:50,posThreshold:50});d.recognizeWith(a),o.add([d,a,s,i]),o.on("tap doubletap panstart panmove panend pinchstart pinchmove rotatemove",r),y.default.enable(e),$(e).on("touchstart touchend",r),$(e).data("hammer",o)}function l(e){y.default.disable(e),$(e).off("touchstart touchend",r);var t=$(e).data("hammer");t&&t.off("tap doubletap panstart panmove panend pinchmove rotatemove",r)}Object.defineProperty(t,"__esModule",{value:!0});var s=o(89),u=a(s),d=o(0),c=n(d),f=o(2),g=n(f),v=o(36),m=a(v),h=o(35),p=a(h),T=o(52),y=a(T),C=void 0,x=void 0,b=void 0,M=void 0,w=void 0,P=void 0,S=void 0,I=void 0,O=1,k=0,_=!1,D=!1,j=void 0,E=700,R=5,A={enable:i,disable:l};t.default=A},function(e,t){e.exports=o},function(e,t,o){"use strict";function n(e){return e&&e.__esModule?e:{default:e}}function a(e){if(e&&e.__esModule)return e;var t={};if(null!=e)for(var o in e)Object.prototype.hasOwnProperty.call(e,o)&&(t[o]=e[o]);return t.default=e,t}function r(e){return{visible:!0,active:!0,handles:{start:{x:e.currentPoints.image.x-20,y:e.currentPoints.image.y+10,highlight:!0,active:!1},end:{x:e.currentPoints.image.x,y:e.currentPoints.image.y,highlight:!0,active:!0},start2:{x:e.currentPoints.image.x-20,y:e.currentPoints.image.y+10,highlight:!0,active:!1},end2:{x:e.currentPoints.image.x,y:e.currentPoints.image.y+20,highlight:!0,active:!1},textBox:{active:!1,hasMoved:!1,movesIndependently:!1,drawnIndependently:!0,allowedOutsideImage:!0,hasBoundingBox:!0}}}}function i(e,t,o){var n={start:u.pixelToCanvas(e,t.handles.start),end:u.pixelToCanvas(e,t.handles.end)},a=c.lineSegment.distanceToPoint(n,o);return a<5||(n.start=u.pixelToCanvas(e,t.handles.start2),n.end=u.pixelToCanvas(e,t.handles.end2),(a=c.lineSegment.distanceToPoint(n,o))<5)}function l(e,t){var o=(0,$.getToolState)(e.currentTarget,O);if(void 0!==o){var n=t.canvasContext.canvas.getContext("2d");n.setTransform(1,0,0,1,0,0);for(var a=void 0,r=x.default.getToolWidth(),i=M.default.getFont(),l=k.getConfiguration(),s=0;s<o.data.length;s++){n.save(),l&&l.shadow&&(n.shadowColor=l.shadowColor||"#000000",n.shadowOffsetX=l.shadowOffsetX||1,n.shadowOffsetY=l.shadowOffsetY||1);var d=o.data[s];a=d.active?P.default.getActiveColor():P.default.getToolColor(),n.beginPath(),n.strokeStyle=a,n.lineWidth=r;var f=u.pixelToCanvas(t.element,d.handles.start),g=u.pixelToCanvas(t.element,d.handles.end);n.moveTo(f.x,f.y),n.lineTo(g.x,g.y);var v=u.pixelToCanvas(t.element,d.handles.start2),m=u.pixelToCanvas(t.element,d.handles.end2);n.moveTo(v.x,v.y),n.lineTo(m.x,m.y),n.stroke();var h={drawHandlesIfActive:l&&l.drawHandlesOnHover,hideHandlesIfMoved:l&&l.hideHandlesIfMoved};(0,I.default)(n,t,d.handles,a,h),n.fillStyle=a;var T=(Math.ceil(d.handles.start.x)-Math.ceil(d.handles.end.x))*t.image.columnPixelSpacing,C=(Math.ceil(d.handles.start.y)-Math.ceil(d.handles.end.y))*t.image.rowPixelSpacing,b=(Math.ceil(d.handles.start2.x)-Math.ceil(d.handles.end2.x))*t.image.columnPixelSpacing,w=(Math.ceil(d.handles.start2.y)-Math.ceil(d.handles.end2.y))*t.image.rowPixelSpacing,S=Math.acos(Math.abs((T*b+C*w)/(Math.sqrt(T*T+C*C)*Math.sqrt(b*b+w*w))));S*=180/Math.PI;var _=(0,y.default)(S,2),D=_.toString()+String.fromCharCode(parseInt("00B0",16));if(!d.handles.textBox.hasMoved){var j=(d.handles.start.x+d.handles.end.x)/2,E=(d.handles.start.y+d.handles.end.y)/2;d.handles.textBox.x=j,d.handles.textBox.y=E}var R={centering:{x:!1,y:!0}},A=u.pixelToCanvas(t.element,d.handles.textBox);n.font=i;var B=(0,p.default)(n,D,A.x,A.y,a,R);if(d.handles.textBox.boundingBox=B,d.handles.textBox.hasMoved){var N={start:{},end:{}},H={x:(f.x+g.x)/2,y:(f.y+g.y)/2},V={x:(v.x+m.x)/2,y:(v.y+m.y)/2},W=[f,g,H,v,m,V];N.end.x=A.x,N.end.y=A.y,N.start=c.point.findClosestPoint(W,N.end);var L=[{x:B.left+B.width/2,y:B.top},{x:B.left,y:B.top+B.height/2},{x:B.left+B.width/2,y:B.top+B.height},{x:B.left+B.width,y:B.top+B.height/2}];N.end=c.point.findClosestPoint(L,N.start),n.beginPath(),n.strokeStyle=a,n.lineWidth=r,n.setLineDash([2,3]),n.moveTo(N.start.x,N.start.y),n.lineTo(N.end.x,N.end.y),n.stroke()}n.restore()}}}Object.defineProperty(t,"__esModule",{value:!0}),t.angleTouch=t.angle=void 0;var s=o(0),u=a(s),d=o(2),c=a(d),f=o(8),g=n(f),v=o(9),m=n(v),h=o(5),p=n(h),T=o(23),y=n(T),C=o(6),x=n(C),b=o(12),M=n(b),w=o(4),P=n(w),S=o(7),I=n(S),$=o(1),O="angle",k=(0,g.default)({createNewMeasurement:r,onImageRendered:l,pointNearTool:i,toolType:O}),_=(0,m.default)({createNewMeasurement:r,onImageRendered:l,pointNearTool:i,toolType:O});t.angle=k,t.angleTouch=_},function(e,t,o){"use strict";function n(e){return e&&e.__esModule?e:{default:e}}function a(e){if(e&&e.__esModule)return e;var t={};if(null!=e)for(var o in e)Object.prototype.hasOwnProperty.call(e,o)&&(t[o]=e[o]);return t.default=e,t}function r(e){return{visible:!0,active:!0,complete:!1,handles:{start:{x:e.currentPoints.image.x,y:e.currentPoints.image.y,highlight:!0,active:!1},end:{x:e.currentPoints.image.x,y:e.currentPoints.image.y,highlight:!0,active:!0},start2:{x:e.currentPoints.image.x-20,y:e.currentPoints.image.y+20,highlight:!0,active:!1},end2:{x:e.currentPoints.image.x,y:e.currentPoints.image.y+20,highlight:!0,active:!1},textBox:{active:!1,hasMoved:!1,movesIndependently:!1,drawnIndependently:!0,allowedOutsideImage:!0,hasBoundingBox:!0}}}}function i(e,t,o){var n={start:C.pixelToCanvas(e,t.handles.start),end:C.pixelToCanvas(e,t.handles.end)},a=b.lineSegment.distanceToPoint(n,o);return a<5||(n.start=C.pixelToCanvas(e,t.handles.start2),n.end=C.pixelToCanvas(e,t.handles.end2),(a=b.lineSegment.distanceToPoint(n,o))<5)}function l(e,t){var o=(0,J.getToolState)(e.currentTarget,Q);if(void 0!==o){var n=t.canvasContext.canvas.getContext("2d");n.setTransform(1,0,0,1,0,0);for(var a=void 0,r=O.default.getToolWidth(),i=_.default.getFont(),l=ne.getConfiguration(),s=0;s<o.data.length;s++){n.save(),l&&l.shadow&&(n.shadowColor=void 0===l.shadowColor?"#000000":l.shadowColor,n.shadowOffsetX=void 0===l.shadowOffsetX?1:l.shadowOffsetX,n.shadowOffsetX=void 0===l.shadowOffsetY?1:l.shadowOffsetY,n.shadowBlur=void 0===l.shadowBlur?1:l.shadowBlur);var u=o.data[s];a=u.active?j.default.getActiveColor():j.default.getToolColor(),n.beginPath(),n.strokeStyle=a,n.lineWidth=r;var d=C.pixelToCanvas(t.element,u.handles.start),c=C.pixelToCanvas(t.element,u.handles.end);n.moveTo(d.x,d.y),n.lineTo(c.x,c.y);var f={start:u.handles.start,end:u.handles.end},g={start2:u.handles.start2,end2:u.handles.end2,textBox:u.handles.textBox},v=C.pixelToCanvas(t.element,u.handles.start2),m=C.pixelToCanvas(t.element,u.handles.end2);u.complete&&(n.moveTo(v.x,v.y),n.lineTo(m.x,m.y)),n.stroke();var h={drawHandlesIfActive:l&&l.drawHandlesOnHover,hideHandlesIfMoved:l&&l.hideHandlesIfMoved};(0,R.default)(n,t,f,a,h),u.complete&&(0,R.default)(n,t,g,a,h),n.fillStyle=a;var p=t.image.columnPixelSpacing||1,T=t.image.rowPixelSpacing||1,y="";t.image.rowPixelSpacing&&t.image.columnPixelSpacing||(y=" (isotropic)");var x=(Math.ceil(u.handles.start.x)-Math.ceil(u.handles.end.x))*p,M=(Math.ceil(u.handles.start.y)-Math.ceil(u.handles.end.y))*T,P=(Math.ceil(u.handles.start2.x)-Math.ceil(u.handles.end2.x))*p,I=(Math.ceil(u.handles.start2.y)-Math.ceil(u.handles.end2.y))*T,$=Math.acos(Math.abs((x*P+M*I)/(Math.sqrt(x*x+M*M)*Math.sqrt(P*P+I*I))));$*=180/Math.PI;var k=(0,S.default)($,2),D=k.toString()+String.fromCharCode(parseInt("00B0",16))+y;if(!u.handles.textBox.hasMoved){var E=(u.handles.start.x+u.handles.end.x)/2,A=(u.handles.start.y+u.handles.end.y)/2-10;u.handles.textBox.x=E,u.handles.textBox.y=A}ee.centering={x:!1,y:!0};var B=C.pixelToCanvas(t.element,u.handles.textBox);if(n.font=i,u.complete){var N=(0,w.default)(n,D,B.x,B.y,a,ee);if(u.handles.textBox.boundingBox=N,u.handles.textBox.hasMoved){var H={start:{},end:{}},V={x:(d.x+c.x)/2,y:(d.y+c.y)/2},W={x:(v.x+m.x)/2,y:(v.y+m.y)/2},L=[d,c,V,v,m,W];H.end.x=B.x,H.end.y=B.y,H.start=b.point.findClosestPoint(L,H.end);var Y=[{x:N.left+N.width/2,y:N.top},{x:N.left,y:N.top+N.height/2},{x:N.left+N.width/2,y:N.top+N.height},{x:N.left+N.width,y:N.top+N.height/2}];H.end=b.point.findClosestPoint(Y,H.start),n.beginPath(),n.strokeStyle=a,n.lineWidth=r,n.setLineDash([2,3]),n.moveTo(H.start.x,H.start.y),n.lineTo(H.end.x,H.end.y),n.stroke()}}n.restore()}}}function s(e){var t=(0,J.getToolState)(e,Q);if(void 0!==t)for(var o=0;o<t.data.length;o++)if(!1===t.data[o].complete)return t.data[o]}function u(e){var t=e.element;document.body.style.cursor="none";var o={mouseButtonMask:e.which},n=void 0,a=void 0,i=s(e.element);if(i)n=i,n.complete=!0,n.handles.start2={x:e.currentPoints.image.x,y:e.currentPoints.image.y,highlight:!0,active:!1},n.handles.end2={x:e.currentPoints.image.x,y:e.currentPoints.image.y,highlight:!0,active:!0},a=n.handles.end2;else{if(!(n=r(e)))return;(0,J.addToolState)(e.element,Q,n),a=n.handles.end}$(t).off("CornerstoneToolsMouseMove",c),$(t).off("CornerstoneToolsMouseDown",f),$(t).off("CornerstoneToolsMouseDownActivate",d),C.updateImage(t);var l=z.default;n.handles.end.isMoving=!1,n.handles.end2.isMoving=!1,l(e,Q,n,a,function(){n.active=!1,document.body.style.cursor="default",n.invalidated=!0,(0,G.default)(e,n.handles)&&(0,J.removeToolState)(t,Q,n),$(t).on("CornerstoneToolsMouseMove",o,c),$(t).on("CornerstoneToolsMouseDown",o,f),$(t).on("CornerstoneToolsMouseDownActivate",o,d);a.isMoving=!1;var r={toolType:Q,element:t,measurementData:n};$(t).trigger("CornerstoneToolsMeasurementFinished",r),C.updateImage(t)},!0)}function d(e,t){if((0,Z.default)(t.which,e.data.mouseButtonMask))return u(t),!1}function c(e,t){if(B.default.setCoords(t),0===t.which){var o=(0,J.getToolState)(t.element,Q);if(o){for(var n=!1,a=0;a<o.data.length;a++){var r=t.currentPoints.canvas,l=o.data[a];!0===(0,W.default)(t.element,l.handles,r)&&(n=!0),(i(t.element,l,r)&&!l.active||!i(t.element,l,r)&&l.active)&&(l.active=!l.active,n=!0)}!0===n&&C.updateImage(t.element)}}}function f(e,t){function o(){document.body.style.cursor="default";for(var e in n.handles)n.handles[e].isMoving=!1;n.invalidated=!0,(0,G.default)(t,n.handles)&&(0,J.removeToolState)(a,Q,n),C.updateImage(a),$(a).on("CornerstoneToolsMouseMove",t,c)}var n=void 0,a=t.element;if((0,Z.default)(t.which,e.data.mouseButtonMask)){var r=t.startPoints.canvas,l=(0,J.getToolState)(e.currentTarget,Q);if(l){var s=void 0;for(s=0;s<l.data.length;s++){n=l.data[s];var u=(0,H.default)(a,n.handles,r,6);if(u)return u.isMoving=!1,document.body.style.cursor="none",$(a).off("CornerstoneToolsMouseMove",c),n.active=!0,(0,Y.default)(t,Q,n,u,o,!1),e.stopImmediatePropagation(),!1}for(s=0;s<l.data.length;s++)if(n=l.data[s],n.active=!1,i(a,n,r))return n.active=!0,$(a).off("CornerstoneToolsMouseMove",c),(0,U.default)(e,n,l,Q,ee,o),e.stopImmediatePropagation(),!1}}}function g(e){$(e).off("CornerstoneImageRendered",l),$(e).off("CornerstoneToolsMouseMove",c),$(e).off("CornerstoneToolsMouseDown",f),$(e).off("CornerstoneToolsMouseDownActivate",d);var t=s(e);t&&(0,J.removeToolState)(e,Q,t),C.updateImage(e)}function v(e){$(e).off("CornerstoneImageRendered",l),$(e).off("CornerstoneToolsMouseMove",c),$(e).off("CornerstoneToolsMouseDown",f),$(e).off("CornerstoneToolsMouseDownActivate",d),$(e).on("CornerstoneImageRendered",l),C.updateImage(e)}function m(e,t){var o={mouseButtonMask:t};$(e).off("CornerstoneImageRendered",l),$(e).off("CornerstoneToolsMouseMove",c),$(e).off("CornerstoneToolsMouseDown",f),$(e).off("CornerstoneToolsMouseDownActivate",d),$(e).on("CornerstoneImageRendered",l),$(e).on("CornerstoneToolsMouseMove",o,c),$(e).on("CornerstoneToolsMouseDown",o,f),$(e).on("CornerstoneToolsMouseDownActivate",o,d),C.updateImage(e)}function h(e,t){var o={mouseButtonMask:t},n="CornerstoneToolsToolDeactivated",a={mouseButtonMask:t,toolType:Q,type:n},r=$.Event(n,a);$(e).trigger(r,a),$(e).off("CornerstoneImageRendered",l),$(e).off("CornerstoneToolsMouseMove",c),$(e).off("CornerstoneToolsMouseDown",f),$(e).off("CornerstoneToolsMouseDownActivate",d),$(e).on("CornerstoneImageRendered",l),$(e).on("CornerstoneToolsMouseMove",o,c),$(e).on("CornerstoneToolsMouseDown",o,f);var i=s(e);i&&(0,J.removeToolState)(e,Q,i),C.updateImage(e)}function p(){return te}function T(e){te=e}Object.defineProperty(t,"__esModule",{value:!0}),t.angleXen=void 0;var y=o(0),C=a(y),x=o(2),b=a(x),M=o(5),w=n(M),P=o(23),S=n(P),I=o(6),O=n(I),k=o(12),_=n(k),D=o(4),j=n(D),E=o(7),R=n(E),A=o(25),B=n(A),N=o(15),H=n(N),V=o(26),W=n(V),L=o(20),Y=n(L),F=o(21),z=n(F),X=o(27),U=n(X),q=o(13),G=n(q),K=o(3),Z=n(K),J=o(1),Q="angleXen",ee={},te={},oe={enable:v,disable:g,activate:m,deactivate:h,getConfiguration:p,setConfiguration:T,mouseDownCallback:f,mouseMoveCallback:c,mouseDownActivateCallback:d,pointNearTool:i,addNewMeasurement:u},ne=oe;t.angleXen=ne},function(e,t,o){"use strict";function n(e){return e&&e.__esModule?e:{default:e}}function a(e){if(e&&e.__esModule)return e;var t={};if(null!=e)for(var o in e)Object.prototype.hasOwnProperty.call(e,o)&&(t[o]=e[o]);return t.default=e,t}function r(e){e(prompt("Enter your annotation:"))}function i(e,t,o){o(prompt("Change your annotation:"))}function l(e){function t(t){null===t?(0,z.removeToolState)(e.element,X,o):o.text=t,o.active=!1,m.updateImage(e.element),$(e.element).on("CornerstoneToolsMouseMove",n,q.mouseMoveCallback),$(e.element).on("CornerstoneToolsMouseDown",n,q.mouseDownCallback),$(e.element).on("CornerstoneToolsMouseDownActivate",n,q.mouseDownActivateCallback),$(e.element).on("CornerstoneToolsMouseDoubleClick",n,q.mouseDoubleClickCallback)}var o=s(e),n={mouseButtonMask:e.which};(0,z.addToolState)(e.element,X,o),$(e.element).off("CornerstoneToolsMouseMove",q.mouseMoveCallback),$(e.element).off("CornerstoneToolsMouseDown",q.mouseDownCallback),$(e.element).off("CornerstoneToolsMouseDownActivate",q.mouseDownActivateCallback),$(e.element).off("CornerstoneToolsMouseDoubleClick",q.mouseDoubleClickCallback),m.updateImage(e.element),(0,A.default)(e,X,o,o.handles.end,function(){(0,V.default)(e,o.handles)&&(0,z.removeToolState)(e.element,X,o);var n=q.getConfiguration();void 0===o.text&&n.getTextCallback(t),m.updateImage(e.element)})}function s(e){return{visible:!0,active:!0,handles:{start:{x:e.currentPoints.image.x,y:e.currentPoints.image.y,highlight:!0,active:!1},end:{x:e.currentPoints.image.x,y:e.currentPoints.image.y,highlight:!0,active:!1},textBox:{active:!1,hasMoved:!1,movesIndependently:!1,drawnIndependently:!0,allowedOutsideImage:!0,hasBoundingBox:!0}}}}function u(e,t,o){var n={start:m.pixelToCanvas(e,t.handles.start),end:m.pixelToCanvas(e,t.handles.end)};return p.lineSegment.distanceToPoint(n,o)<25}function d(e,t){var o=(0,z.getToolState)(e.currentTarget,X);if(o){var n=t.enabledElement,a=t.canvasContext.canvas.getContext("2d");a.setTransform(1,0,0,1,0,0);for(var r=void 0,i=P.default.getToolWidth(),l=I.default.getFont(),s=q.getConfiguration(),u=0;u<o.data.length;u++){a.save(),s&&s.shadow&&(a.shadowColor=s.shadowColor||"#000000",a.shadowOffsetX=s.shadowOffsetX||1,a.shadowOffsetY=s.shadowOffsetY||1);var d=o.data[u];r=d.active?k.default.getActiveColor():k.default.getToolColor();var c=m.pixelToCanvas(t.element,d.handles.start),f=m.pixelToCanvas(t.element,d.handles.end);s.arrowFirst?(0,E.default)(a,f,c,r,i):(0,E.default)(a,c,f,r,i);var g={drawHandlesIfActive:s&&s.drawHandlesOnHover};if(s.drawHandles&&(0,D.default)(a,t,d.handles,r,g),d.text&&""!==d.text){a.font=l;var v=a.measureText(d.text).width+10,h=I.default.getFontSize()+10,T=Math.max(v,h)/2+5;f.x<c.x&&(T=-T);var y=void 0;if(!d.handles.textBox.hasMoved){y=s.arrowFirst?{x:f.x-v/2+T,y:f.y-h/2}:{x:c.x-v/2-T,y:c.y-h/2};var C=m.internal.getTransform(n);C.invert();var x=C.transformPoint(y.x,y.y);d.handles.textBox.x=x.x,d.handles.textBox.y=x.y}y=m.pixelToCanvas(t.element,d.handles.textBox);var b=(0,M.default)(a,d.text,y.x,y.y,r);if(d.handles.textBox.boundingBox=b,d.handles.textBox.hasMoved){var w={start:{},end:{}},S={x:(c.x+f.x)/2,y:(c.y+f.y)/2},$=[c,f,S];w.end.x=y.x,w.end.y=y.y,w.start=p.point.findClosestPoint($,w.end);var O=[{x:b.left+b.width/2,y:b.top},{x:b.left,y:b.top+b.height/2},{x:b.left+b.width/2,y:b.top+b.height},{x:b.left+b.width,y:b.top+b.height/2}];w.end=p.point.findClosestPoint(O,w.start),a.beginPath(),a.strokeStyle=r,a.lineWidth=i,a.setLineDash([2,3]),a.moveTo(w.start.x,w.start.y),a.lineTo(w.end.x,w.end.y),a.stroke()}}a.restore()}}}function c(e){function t(e){null===e?(0,z.removeToolState)(o,X,n):n.text=e,n.active=!1,m.updateImage(o),$(o).on("CornerstoneToolsTouchPress",G.pressCallback),$(o).on("CornerstoneToolsTouchStartActive",G.touchDownActivateCallback),$(o).on("CornerstoneToolsTap",G.tapCallback)}var o=e.element,n=s(e);(0,z.addToolState)(o,X,n),$(o).off("CornerstoneToolsTouchPress",G.pressCallback),$(o).off("CornerstoneToolsTouchStartActive",G.touchDownActivateCallback),$(o).off("CornerstoneToolsTap",G.tapCallback),m.updateImage(o),(0,N.default)(e,X,n,n.handles.end,function(){m.updateImage(o),(0,V.default)(e,n.handles)&&(0,z.removeToolState)(o,X,n);var a=q.getConfiguration();void 0===n.text&&a.getTextCallback(t)})}function f(e,t){function o(e,t,o){!0===o?(0,z.removeToolState)(n,X,e):e.text=t,e.active=!1,m.updateImage(n)}var n=t.element,a=void 0;if(!e.data||!e.data.mouseButtonMask||(0,L.default)(t.which,e.data.mouseButtonMask)){var r=q.getConfiguration(),i=t.currentPoints.canvas,l=(0,z.getToolState)(n,X);if(l)for(var s=0;s<l.data.length;s++)if(a=l.data[s],u(n,a,i)||(0,F.default)(a.handles.textBox,i))return a.active=!0,m.updateImage(n),r.changeTextCallback(a,t,o),e.stopImmediatePropagation(),!1}}function g(e,t){function o(e,t,o){console.log("pressCallback doneChangingTextCallback"),!0===o?(0,z.removeToolState)(n,X,e):e.text=t,e.active=!1,m.updateImage(n),$(n).on("CornerstoneToolsTouchStart",G.touchStartCallback),$(n).on("CornerstoneToolsTouchStartActive",G.touchDownActivateCallback),$(n).on("CornerstoneToolsTap",G.tapCallback)}var n=t.element,a=void 0;if(!e.data||!e.data.mouseButtonMask||(0,L.default)(t.which,e.data.mouseButtonMask)){var r=q.getConfiguration(),i=t.currentPoints.canvas,l=(0,z.getToolState)(n,X);if(l){if(t.handlePressed)return $(n).off("CornerstoneToolsTouchStart",G.touchStartCallback),$(n).off("CornerstoneToolsTouchStartActive",G.touchDownActivateCallback),$(n).off("CornerstoneToolsTap",G.tapCallback),r.changeTextCallback(t.handlePressed,t,o),e.stopImmediatePropagation(),!1;for(var s=0;s<l.data.length;s++)if(a=l.data[s],u(n,a,i)||(0,F.default)(a.handles.textBox,i))return a.active=!0,m.updateImage(n),$(n).off("CornerstoneToolsTouchStart",G.touchStartCallback),$(n).off("CornerstoneToolsTouchStartActive",G.touchDownActivateCallback),$(n).off("CornerstoneToolsTap",G.tapCallback),r.changeTextCallback(a,t,o),e.stopImmediatePropagation(),!1;return!1}}}Object.defineProperty(t,"__esModule",{value:!0}),t.arrowAnnotateTouch=t.arrowAnnotate=void 0;var v=o(0),m=a(v),h=o(2),p=a(h),T=o(8),y=n(T),C=o(9),x=n(C),b=o(5),M=n(b),w=o(6),P=n(w),S=o(12),I=n(S),O=o(4),k=n(O),_=o(7),D=n(_),j=o(47),E=n(j),R=o(21),A=n(R),B=o(29),N=n(B),H=o(13),V=n(H),W=o(3),L=n(W),Y=o(18),F=n(Y),z=o(1),X="arrowAnnotate",U={getTextCallback:r,changeTextCallback:i,drawHandles:!1,drawHandlesOnHover:!0,arrowFirst:!0},q=(0,y.default)({addNewMeasurement:l,createNewMeasurement:s,onImageRendered:d,pointNearTool:u,toolType:X,mouseDoubleClickCallback:f});q.setConfiguration(U);var G=(0,x.default)({addNewMeasurement:c,createNewMeasurement:s,onImageRendered:d,pointNearTool:u,toolType:X,pressCallback:g});t.arrowAnnotate=q,t.arrowAnnotateTouch=G},function(e,t,o){"use strict";function n(e){return e&&e.__esModule?e:{default:e}}function a(e,t){e.stopImmediatePropagation();var o=(0,y.getToolState)(e.currentTarget,M);if(o){var n=e.currentTarget,a=h.getEnabledElement(n),r=a.image.imageId,i=h.metaData.get("imagePlane",r),l=t.currentPoints.image,s=(0,b.imagePointToPatientPoint)(l,i);o.data[0].synchronizationContext.getSourceElements().forEach(function(e){if(e!==n){var t=Number.MAX_VALUE,o=-1,a=(0,y.getToolState)(e,"stack");if(void 0!==a){var r=a.data[0];if(r.imageIds.forEach(function(e,n){var a=h.metaData.get("imagePlane",e),r=a.imagePositionPatient,i=a.rowCosines.clone(),l=a.columnCosines.clone(),u=l.clone().cross(i.clone()),d=Math.abs(u.clone().dot(r)-u.clone().dot(s));d<t&&(t=d,o=n)}),o!==r.currentImageIdIndex&&-1!==o&&void 0!==r.imageIds[o]){var i=T.default.getStartLoadHandler(),l=T.default.getEndLoadHandler(),u=T.default.getErrorLoadingHandler();i&&i(e);var d=void 0;d=!0===r.preventCache?h.loadImage(r.imageIds[o]):h.loadAndCacheImage(r.imageIds[o]),d.then(function(t){var n=h.getViewport(e);r.currentImageIdIndex=o,h.displayImage(e,t,n),l&&l(e,t)},function(t){var n=r.imageIds[o];u&&u(e,n,t)})}}}})}}function r(e,t){$(t.element).off("CornerstoneToolsMouseDrag",l),$(t.element).off("CornerstoneToolsMouseUp",r)}function i(e,t){if((0,x.default)(t.which,e.data.mouseButtonMask))return $(t.element).on("CornerstoneToolsMouseDrag",l),$(t.element).on("CornerstoneToolsMouseUp",r),a(e,t),!1}function l(e,t){return a(e,t),!1}function s(e,t,o){var n={mouseButtonMask:t};(0,y.clearToolState)(e,M),(0,y.addToolState)(e,M,{synchronizationContext:o}),$(e).off("CornerstoneToolsMouseDown",i),$(e).on("CornerstoneToolsMouseDown",n,i)}function u(e){$(e).off("CornerstoneToolsMouseDown",i)}function d(e,t){$(t.element).off("CornerstoneToolsTouchDrag",f),$(t.element).off("CornerstoneToolsDragEnd",d)}function c(e,t){return $(t.element).on("CornerstoneToolsTouchDrag",f),$(t.element).on("CornerstoneToolsDragEnd",d),a(e,t),!1}function f(e,t){return a(e,t),!1}function g(e,t){(0,y.clearToolState)(e,M),(0,y.addToolState)(e,M,{synchronizationContext:t}),$(e).off("CornerstoneToolsTouchStart",c),$(e).on("CornerstoneToolsTouchStart",c)}function v(e){$(e).off("CornerstoneToolsTouchStart",c)}Object.defineProperty(t,"__esModule",{value:!0}),t.crosshairsTouch=t.crosshairs=void 0;var m=o(0),h=function(e){if(e&&e.__esModule)return e;var t={};if(null!=e)for(var o in e)Object.prototype.hasOwnProperty.call(e,o)&&(t[o]=e[o]);return t.default=e,t}(m),p=o(11),T=n(p),y=o(1),C=o(3),x=n(C),b=o(30),M="crosshairs",w={activate:s,deactivate:u,enable:s,disable:u},P={activate:g,deactivate:v,enable:g,disable:v};t.crosshairs=w,t.crosshairsTouch=P},function(e,t,o){"use strict";function n(e){i.fitToWindow(e.element)}function a(e,t){return u.strategy(t),!1}Object.defineProperty(t,"__esModule",{value:!0});var r=o(0),i=function(e){if(e&&e.__esModule)return e;var t={};if(null!=e)for(var o in e)Object.prototype.hasOwnProperty.call(e,o)&&(t[o]=e[o]);return t.default=e,t}(r),l=o(53),s=function(e){return e&&e.__esModule?e:{default:e}}(l),u=(0,s.default)(a);u.strategies={default:n},u.strategy=n,t.default=u},function(e,t,o){"use strict";function n(e){return e&&e.__esModule?e:{default:e}}function a(e){var t=c.getEnabledElement(e.element),o=t.canvas.getContext("2d");o.setTransform(1,0,0,1,0,0);var n=y.default.getActiveColor(),a=p.default.getFont(),r=p.default.getFontSize(),i=k.getConfiguration();o.save(),i&&i.shadow&&(o.shadowColor=i.shadowColor||"#000000",o.shadowOffsetX=i.shadowOffsetX||1,o.shadowOffsetY=i.shadowOffsetY||1);var l=Math.round(e.currentPoints.image.x),s=Math.round(e.currentPoints.image.y),u=void 0,d=void 0,f=void 0;if(!(l<0||s<0||l>=e.image.columns||s>=e.image.rows)){if(e.image.color)u=(0,M.default)(e.element,l,s,1,1),d=l+", "+s,f="R: "+u[0]+" G: "+u[1]+" B: "+u[2]+" A: "+u[3];else{u=c.getStoredPixels(e.element,l,s,1,1);var g=u[0],v=g*e.image.slope+e.image.intercept,m=(0,P.default)(e.image,g);d=l+", "+s,f="SP: "+g+" MO: "+parseFloat(v.toFixed(3)),m&&(f+=" SUV: "+parseFloat(m.toFixed(3)))}var h={x:e.currentPoints.image.x+3,y:e.currentPoints.image.y-3},T=c.pixelToCanvas(e.element,h);o.font=a,o.fillStyle=n,(0,x.default)(o,f,T.x,T.y+r+5,n),(0,x.default)(o,d,T.x,T.y,n),o.restore()}}function r(e){var t=e.element,o=c.getEnabledElement(t),n=o.image,a=o.canvas.getContext("2d");a.setTransform(1,0,0,1,0,0);var r=y.default.getActiveColor(),i=p.default.getFont(),l=k.getConfiguration();a.save(),l&&l.shadow&&(a.shadowColor=l.shadowColor||"#000000",a.shadowOffsetX=l.shadowOffsetX||1,a.shadowOffsetY=l.shadowOffsetY||1);var s=c.metaData.get("generalSeriesModule",n.imageId),u=void 0;s&&(u=s.modality);var d=void 0;d=!0===e.isTouchEvent?c.pageToPixel(t,e.currentPoints.page.x,e.currentPoints.page.y-4*p.default.getFontSize()):c.pageToPixel(t,e.currentPoints.page.x,e.currentPoints.page.y-p.default.getFontSize()/2);var f=void 0,g="";if(!(d.x<0||d.y<0||d.x>=n.columns||d.y>=n.rows)){if(n.color)f=(0,M.default)(t,d.x,d.y,1,1),g="R: "+f[0]+" G: "+f[1]+" B: "+f[2];else{f=c.getStoredPixels(t,d.x,d.y,1,1);var v=f[0],m=v*e.image.slope+e.image.intercept,h=parseFloat(m.toFixed(2));if("CT"===u)g+="HU: "+h;else if("PT"===u){g+=h;var T=(0,P.default)(e.image,v);T&&(g+=" SUV: "+parseFloat(T.toFixed(2)))}else g+=h}var C=c.pixelToCanvas(t,d);a.font=i,a.fillStyle=r;var b=void 0,w=a.measureText(g).width;b=!0===e.isTouchEvent?{x:-w/2-5,y:-p.default.getFontSize()-10-12}:{x:12,y:-(p.default.getFontSize()+10)/2},a.beginPath(),a.strokeStyle=r,a.arc(C.x,C.y,6,0,2*Math.PI),a.stroke(),(0,x.default)(a,g,C.x+b.x,C.y+b.y,r),a.restore()}}function i(e,t){var o=t.element;$(o).off("CornerstoneImageRendered",s),$(o).off("CornerstoneToolsMouseDrag",u),$(o).off("CornerstoneToolsMouseUp",i),$(o).off("CornerstoneToolsMouseClick",i),c.updateImage(t.element)}function l(e,t){var o=t.element;if((0,I.default)(t.which,e.data.mouseButtonMask))return $(o).on("CornerstoneImageRendered",s),$(o).on("CornerstoneToolsMouseDrag",u),$(o).on("CornerstoneToolsMouseUp",i),$(o).on("CornerstoneToolsMouseClick",i),k.strategy(t),!1}function s(){O&&(k.strategy(O),O=null)}function u(e,t){var o=t.element;return O=t,c.updateImage(o),!1}Object.defineProperty(t,"__esModule",{value:!0}),t.dragProbeTouch=t.dragProbe=void 0;var d=o(0),c=function(e){if(e&&e.__esModule)return e;var t={};if(null!=e)for(var o in e)Object.prototype.hasOwnProperty.call(e,o)&&(t[o]=e[o]);return t.default=e,t}(d),f=o(14),g=n(f),v=o(10),m=n(v),h=o(12),p=n(h),T=o(4),y=n(T),C=o(5),x=n(C),b=o(24),M=n(b),w=o(19),P=n(w),S=o(3),I=n(S),O=void 0,k=(0,g.default)(l);k.strategies={default:a,minimal:r},k.strategy=a;var _={fireOnTouchStart:!0},D=(0,m.default)(u,_);t.dragProbe=k,t.dragProbeTouch=D},function(e,t,o){"use strict";function n(e){return e&&e.__esModule?e:{default:e}}function a(e){if(e&&e.__esModule)return e;var t={};if(null!=e)for(var o in e)Object.prototype.hasOwnProperty.call(e,o)&&(t[o]=e[o]);return t.default=e,t}function r(e){return{visible:!0,active:!0,invalidated:!0,handles:{start:{x:e.currentPoints.image.x,y:e.currentPoints.image.y,highlight:!0,active:!1},end:{x:e.currentPoints.image.x,y:e.currentPoints.image.y,highlight:!0,active:!0},textBox:{active:!1,hasMoved:!1,movesIndependently:!1,drawnIndependently:!0,allowedOutsideImage:!0,hasBoundingBox:!0}}}}function i(e,t,o,n){var a=f.pixelToCanvas(e,t.handles.start),r=f.pixelToCanvas(e,t.handles.end),i={left:Math.min(a.x,r.x)+n/2,top:Math.min(a.y,r.y)+n/2,width:Math.abs(a.x-r.x)-n,height:Math.abs(a.y-r.y)-n},l={left:Math.min(a.x,r.x)-n/2,top:Math.min(a.y,r.y)-n/2,width:Math.abs(a.x-r.x)+n,height:Math.abs(a.y-r.y)+n},s=(0,k.default)(i,o);return!(!(0,k.default)(l,o)||s)}function l(e,t,o){return i(e,t,o,15)}function s(e,t,o){return i(e,t,o,25)}function u(e){var t=e.toString().split(".");return t[0]=t[0].replace(/\B(?=(\d{3})+(?!\d))/g,","),t.join(".")}function d(e,t){var o=(0,R.getToolState)(e.currentTarget,A);if(o){var n=t.image,a=t.element,r=C.default.getToolWidth(),i=B.getConfiguration(),l=t.canvasContext.canvas.getContext("2d"),s=f.metaData.get("generalSeriesModule",n.imageId),d=void 0;s&&(d=s.modality),l.setTransform(1,0,0,1,0,0);for(var c=0;c<o.data.length;c++){l.save();var g=o.data[c];i&&i.shadow&&(l.shadowColor=i.shadowColor||"#000000",l.shadowOffsetX=i.shadowOffsetX||1,l.shadowOffsetY=i.shadowOffsetY||1);var m=b.default.getColorIfActive(g.active),h=f.pixelToCanvas(a,g.handles.start),p=f.pixelToCanvas(a,g.handles.end),T=Math.min(h.x,p.x),y=Math.min(h.y,p.y),x=Math.abs(h.x-p.x),M=Math.abs(h.y-p.y);if(l.beginPath(),l.strokeStyle=m,l.lineWidth=r,(0,$.default)(l,T,y,x,M),l.closePath(),i&&i.drawHandlesOnHover)if(!0===g.active)(0,w.default)(l,t,g.handles,m);else{var P={drawHandlesIfActive:!0};(0,w.default)(l,t,g.handles,m,P)}else(0,w.default)(l,t,g.handles,m);var I=void 0,O=void 0,k=void 0;if(!1===g.invalidated)O=g.meanStdDev,k=g.meanStdDevSUV,I=g.area;else{var _={left:Math.round(Math.min(g.handles.start.x,g.handles.end.x)),top:Math.round(Math.min(g.handles.start.y,g.handles.end.y)),width:Math.round(Math.abs(g.handles.start.x-g.handles.end.x)),height:Math.round(Math.abs(g.handles.start.y-g.handles.end.y))};if(!n.color){var j=f.getPixels(a,_.left,_.top,_.width,_.height);O=(0,D.default)(j,_),"PT"===d&&(k={mean:(0,E.default)(n,(O.mean-n.intercept)/n.slope),stdDev:(0,E.default)(n,(O.stdDev-n.intercept)/n.slope)}),O&&!isNaN(O.mean)&&(g.meanStdDev=O,g.meanStdDevSUV=k)}var N=n.columnPixelSpacing||1,H=n.rowPixelSpacing||1;I=Math.PI*(_.width*N/2)*(_.height*H/2),isNaN(I)||(g.area=I),g.invalidated=!1}var V=[];if(O&&void 0!==O.mean){var W="";"CT"===d&&(W=" HU");var L="Mean: "+u(O.mean.toFixed(2))+W,Y="StdDev: "+u(O.stdDev.toFixed(2))+W;if(k&&void 0!==k.mean){L+=" SUV: "+u(k.mean.toFixed(2)),Y+=" SUV: "+u(k.stdDev.toFixed(2))}V.push(L),V.push(Y)}if(I){var F=" mm"+String.fromCharCode(178);n.rowPixelSpacing&&n.columnPixelSpacing||(F=" pixels"+String.fromCharCode(178));var z="Area: "+u(I.toFixed(2))+F;V.push(z)}g.handles.textBox.hasMoved||(g.handles.textBox.x=Math.max(g.handles.start.x,g.handles.end.x),g.handles.textBox.y=(g.handles.start.y+g.handles.end.y)/2);var X=f.pixelToCanvas(a,g.handles.textBox),U={centering:{x:!1,y:!0}},q=(0,S.default)(l,V,X.x,X.y,m,U);if(g.handles.textBox.boundingBox=q,g.handles.textBox.hasMoved){var G={start:{},end:{x:X.x,y:X.y}},K=[{x:T+x/2,y:y},{x:T,y:y+M/2},{x:T+x/2,y:y+M},{x:T+x,y:y+M/2}];G.start=v.point.findClosestPoint(K,G.end);var Z=[{x:q.left+q.width/2,y:q.top},{x:q.left,y:q.top+q.height/2},{x:q.left+q.width/2,y:q.top+q.height},{x:q.left+q.width,y:q.top+q.height/2}];G.end=v.point.findClosestPoint(Z,G.start),l.beginPath(),l.strokeStyle=m,l.lineWidth=r,l.setLineDash([2,3]),l.moveTo(G.start.x,G.start.y),l.lineTo(G.end.x,G.end.y),l.stroke()}l.restore()}}}Object.defineProperty(t,"__esModule",{value:!0}),t.ellipticalRoiTouch=t.ellipticalRoi=void 0;var c=o(0),f=a(c),g=o(2),v=a(g),m=o(8),h=n(m),p=o(9),T=n(p),y=o(6),C=n(y),x=o(4),b=n(x),M=o(7),w=n(M),P=o(5),S=n(P),I=o(45),$=n(I),O=o(34),k=n(O),_=o(48),D=n(_),j=o(19),E=n(j),R=o(1),A="ellipticalRoi",B=(0,h.default)({createNewMeasurement:r,onImageRendered:d,pointNearTool:l,toolType:A}),N=(0,T.default)({createNewMeasurement:r,onImageRendered:d,pointNearTool:s,toolType:A});t.ellipticalRoi=B,t.ellipticalRoiTouch=N},function(e,t,o){"use strict";function n(e){return e&&e.__esModule?e:{default:e}}function a(e){if(e&&e.__esModule)return e;var t={};if(null!=e)for(var o in e)Object.prototype.hasOwnProperty.call(e,o)&&(t[o]=e[o]);return t.default=e,t}function r(e){var t=(0,j.getToolState)(e.element,E);if(void 0!==t){var o=A.getConfiguration(),n=t.data[o.currentTool],a={x:e.currentPoints.image.x,y:e.currentPoints.image.y,highlight:!0,active:!0,lines:[]};n.handles.length&&n.handles[o.currentHandle-1].lines.push(e.currentPoints.image),n.handles.push(a),o.currentHandle+=1,o.freehand=!1,x.updateImage(e.element)}}function i(e,t){var o=(0,j.getToolState)(e.element,E);if(void 0!==o){var n=o.data[t];if(void 0!==n.handles)for(var a=e.currentPoints.canvas,r=0;r<n.handles.length;r++){var i=x.pixelToCanvas(e.element,n.handles[r]);if(M.point.distance(i,a)<5)return r}}}function l(e){var t=(0,j.getToolState)(e.element,E);if(t)for(var o=void 0,n=0;n<t.data.length;n++)if(void 0!==(o=i(e,n)))return{handleNearby:o,toolIndex:n}}function s(e,t){if($(t.element).off("CornerstoneToolsMouseUp",s),void 0!==(0,j.getToolState)(t.element,E)){var o=A.getConfiguration();t.event.shiftKey||(o.freehand=!1),x.updateImage(t.element)}}function u(e,t){var o=(0,j.getToolState)(t.element,E);if(o){var n=A.getConfiguration(),a=o.data[n.currentTool],r=Math.max(t.currentPoints.image.x,0);r=Math.min(r,t.image.width),n.mouseLocation.handles.start.x=r;var l=Math.max(t.currentPoints.image.y,0);l=Math.min(l,t.image.height),n.mouseLocation.handles.start.y=l;var s=n.currentHandle;if(n.modifying&&(a.active=!0,a.highlight=!0,a.handles[s].x=n.mouseLocation.handles.start.x,a.handles[s].y=n.mouseLocation.handles.start.y,s)){var u=a.handles[s-1].lines.length-1,d=a.handles[s-1].lines[u];d.x=n.mouseLocation.handles.start.x,d.y=n.mouseLocation.handles.start.y}if(n.freehand)a.handles[s-1].lines.push(t.currentPoints.image);else{var c=i(t,n.currentTool);void 0!==c&&c<a.handles.length-1&&(n.mouseLocation.handles.start.x=a.handles[c].x,n.mouseLocation.handles.start.y=a.handles[c].y)}x.updateImage(t.element)}}function d(e){$(e.element).on("CornerstoneToolsMouseMove",u),$(e.element).on("CornerstoneToolsMouseUp",s);var t={visible:!0,active:!0,handles:[]},o=A.getConfiguration();o.mouseLocation.handles.start.x=e.currentPoints.image.x,o.mouseLocation.handles.start.y=e.currentPoints.image.y,(0,j.addToolState)(e.element,E,t);var n=(0,j.getToolState)(e.element,E);o.currentTool=n.data.length-1}function c(e,t){var o=(0,j.getToolState)(e.element,E);if(o){var n=A.getConfiguration(),a=o.data[n.currentTool];a.active=!1,a.highlight=!1,void 0!==t&&a.handles[n.currentHandle-1].lines.push({x:a.handles[t].x,y:a.handles[t].y}),n.modifying&&(n.modifying=!1),n.currentHandle=0,n.currentTool=-1,$(e.element).off("CornerstoneToolsMouseMove",u),x.updateImage(e.element)}}function f(e,t){if((0,D.default)(t.which,e.data.mouseButtonMask)){var o=(0,j.getToolState)(t.element,E),n=void 0,a=void 0,f=A.getConfiguration(),g=f.currentTool;if(f.modifying)return void c(t);if(g<0){var v=l(t);v?(n=v.handleNearby,a=v.toolIndex,void 0!==n&&($(t.element).on("CornerstoneToolsMouseMove",u),$(t.element).on("CornerstoneToolsMouseUp",s),f.modifying=!0,f.currentHandle=n,f.currentTool=a)):(d(t),r(t))}else g>=0&&o.data[g].active&&(n=i(t,g),void 0!==n?c(t,n):t.event.shiftKey?f.freehand=!0:r(t));return!1}}function g(e,t){var o=(0,j.getToolState)(e.currentTarget,E);if(void 0!==o){var n=A.getConfiguration(),a=t.canvasContext.canvas.getContext("2d");a.setTransform(1,0,0,1,0,0);for(var r=void 0,i=P.default.getToolWidth(),l=I.default.getFillColor(),s=0;s<o.data.length;s++){a.save();var u=o.data[s];u.active?(r=I.default.getActiveColor(),l=I.default.getFillColor()):(r=I.default.getToolColor(),l=I.default.getToolColor());var d=void 0;if(u.handles.length)for(var c=0;c<u.handles.length;c++){d=u.handles[c];var f=x.pixelToCanvas(t.element,d);a.beginPath(),a.strokeStyle=r,a.lineWidth=i,a.moveTo(f.x,f.y);for(var g=0;g<u.handles[c].lines.length;g++){var v=x.pixelToCanvas(t.element,u.handles[c].lines[g]);a.lineTo(v.x,v.y),a.stroke()}var m=x.pixelToCanvas(t.element,n.mouseLocation.handles.start);c===u.handles.length-1&&(!u.active||n.freehand||n.modifying||(a.lineTo(m.x,m.y),a.stroke()))}var h={fill:l};u.active&&(0,k.default)(a,t,n.mouseLocation.handles,r,h),(0,k.default)(a,t,u.handles,r,h),a.restore()}}}function v(e){$(e).off("CornerstoneToolsMouseDown",f),$(e).off("CornerstoneToolsMouseUp",s),$(e).off("CornerstoneToolsMouseMove",u),$(e).off("CornerstoneImageRendered",g),$(e).on("CornerstoneImageRendered",g),x.updateImage(e)}function m(e){$(e).off("CornerstoneToolsMouseDown",f),$(e).off("CornerstoneToolsMouseUp",s),$(e).off("CornerstoneToolsMouseMove",u),$(e).off("CornerstoneImageRendered",g),x.updateImage(e)}function h(e,t){var o={mouseButtonMask:t};$(e).off("CornerstoneToolsMouseDown",o,f),$(e).off("CornerstoneToolsMouseUp",s),$(e).off("CornerstoneToolsMouseMove",u),$(e).off("CornerstoneImageRendered",g),$(e).on("CornerstoneImageRendered",g),$(e).on("CornerstoneToolsMouseDown",o,f),x.updateImage(e)}function p(e){$(e).off("CornerstoneToolsMouseDown",f),$(e).off("CornerstoneToolsMouseUp",s),$(e).off("CornerstoneToolsMouseMove",u),$(e).off("CornerstoneImageRendered",g),$(e).on("CornerstoneImageRendered",g),x.updateImage(e)}function T(){return R}function y(e){R=e}Object.defineProperty(t,"__esModule",{value:!0}),t.freehand=void 0;var C=o(0),x=a(C),b=o(2),M=a(b),w=o(6),P=n(w),S=o(4),I=n(S),O=o(7),k=n(O),_=o(3),D=n(_),j=o(1),E="freehand",R={mouseLocation:{handles:{start:{highlight:!0,active:!0}}},freehand:!1,modifying:!1,currentHandle:0,currentTool:-1},A={enable:v,disable:m,activate:h,deactivate:p,getConfiguration:T,setConfiguration:y};t.freehand=A},function(e,t,o){"use strict";function n(e){return e&&e.__esModule?e:{default:e}}function a(e){if(e&&e.__esModule)return e;var t={};if(null!=e)for(var o in e)Object.prototype.hasOwnProperty.call(e,o)&&(t[o]=e[o]);return t.default=e,t}function r(e){var t=(0,M.getToolState)(e.event.currentTarget,w);if(!(t&&t.data&&t.data.length>0)){return{visible:!0,active:!0,handles:{start:{x:e.currentPoints.image.x,y:e.currentPoints.image.y,highlight:!0,active:!1},end:{x:e.currentPoints.image.x,y:e.currentPoints.image.y,highlight:!0,active:!0}}}}}function i(e,t,o){var n=d.pixelToCanvas(e,t.handles.start),a=d.pixelToCanvas(e,t.handles.end),r={left:Math.min(n.x,a.x),top:Math.min(n.y,a.y),width:Math.abs(n.x-a.x),height:Math.abs(n.y-a.y)},i=!1;return o.x>=r.left&&o.x<=r.left+r.width&&o.y>=r.top&&o.y<=r.top+r.height&&(i=!0),i}function l(e,t,o){var n=d.pixelToCanvas(e,t.handles.start),a=d.pixelToCanvas(e,t.handles.end),r={left:Math.min(n.x,a.x),top:Math.min(n.y,a.y),width:Math.abs(n.x-a.x),height:Math.abs(n.y-a.y)};return f.rect.distanceToPoint(r,o)<5}function s(e,t){var o=(0,M.getToolState)(e.currentTarget,w);if(void 0!==o){var n=t.canvasContext.canvas.getContext("2d");n.setTransform(1,0,0,1,0,0);var a=void 0,r=T.default.getToolWidth();n.save();var i=o.data[0];if(i){a=i.active?C.default.getActiveColor():C.default.getToolColor();var l=d.pixelToCanvas(t.element,i.handles.start),s=d.pixelToCanvas(t.element,i.handles.end),u={left:Math.min(l.x,s.x),top:Math.min(l.y,s.y),width:Math.abs(l.x-s.x),height:Math.abs(l.y-s.y)};n.beginPath(),n.strokeStyle="transparent",n.rect(0,0,n.canvas.clientWidth,n.canvas.clientHeight),n.rect(u.width+u.left,u.top,-u.width,u.height),n.stroke(),n.fillStyle="rgba(0,0,0,0.7)",n.fill(),n.closePath(),n.beginPath(),n.strokeStyle=a,n.lineWidth=r,n.setLineDash([4]),n.strokeRect(u.left,u.top,u.width,u.height),n.setLineDash([]),(0,b.default)(n,t,i.handles,a),n.restore()}}}Object.defineProperty(t,"__esModule",{value:!0}),t.highlightTouch=t.highlight=void 0;var u=o(0),d=a(u),c=o(2),f=a(c),g=o(54),v=n(g),m=o(9),h=n(m),p=o(6),T=n(p),y=o(4),C=n(y),x=o(7),b=n(x),M=o(1),w="highlight",P=(0,v.default)({createNewMeasurement:r,onImageRendered:s,pointNearTool:l,pointInsideRect:i,toolType:w},!0),S=(0,h.default)({createNewMeasurement:r,onImageRendered:s,pointNearTool:l,pointInsideRect:i,toolType:w},!0);t.highlight=P,t.highlightTouch=S},function(e,t,o){"use strict";function n(e){return e&&e.__esModule?e:{default:e}}function a(e,t){var o=t.image,n=o.stats,a=t.canvasContext.canvas.getContext("2d");a.setTransform(1,0,0,1,0,0);var r=[];Object.keys(n).forEach(function(e){var t=e+" : "+n[e];r.push(t)}),(0,s.default)(a,r,0,0,"orange"),r.forEach(function(e){console.log(e)})}Object.defineProperty(t,"__esModule",{value:!0});var r=o(28),i=n(r),l=o(5),s=n(l),u=(0,i.default)(a);t.default=u},function(e,t,o){"use strict";function n(e){return e&&e.__esModule?e:{default:e}}function a(e){if(e&&e.__esModule)return e;var t={};if(null!=e)for(var o in e)Object.prototype.hasOwnProperty.call(e,o)&&(t[o]=e[o]);return t.default=e,t}function r(e){return{visible:!0,active:!0,handles:{start:{x:e.currentPoints.image.x,y:e.currentPoints.image.y,highlight:!0,active:!1},end:{x:e.currentPoints.image.x,y:e.currentPoints.image.y,highlight:!0,active:!0},textBox:{active:!1,hasMoved:!1,movesIndependently:!1,drawnIndependently:!0,allowedOutsideImage:!0,hasBoundingBox:!0}}}}function i(e,t,o){var n=c.point.distanceSquared(u.pixelToCanvas(e,t.handles.start),o),a=c.point.distanceSquared(u.pixelToCanvas(e,t.handles.end),o);return n<25||a<25}function l(e,t){var o=(0,w.getToolState)(e.currentTarget,P);if(o){var n=t.canvasContext.canvas.getContext("2d");n.setTransform(1,0,0,1,0,0);for(var a=y.default.getToolWidth(),r=S.getConfiguration(),i=0;i<o.data.length;i++){n.save(),r&&r.shadow&&(n.shadowColor=void 0===r.shadowColor?"#000000":r.shadowColor,n.shadowOffsetX=void 0===r.shadowOffsetX?1:r.shadowOffsetX,n.shadowOffsetX=void 0===r.shadowOffsetY?1:r.shadowOffsetY,n.shadowBlur=void 0===r.shadowBlur?1:r.shadowBlur);var l=o.data[i],s=x.default.getColorIfActive(l.active),d=u.pixelToCanvas(t.element,l.handles.start),f=u.pixelToCanvas(t.element,l.handles.end);n.beginPath(),n.strokeStyle=s,n.lineWidth=a,n.moveTo(d.x,d.y),n.lineTo(f.x,f.y),n.stroke();var g={drawHandlesIfActive:r&&r.drawHandlesOnHover,hideHandlesIfMoved:r&&r.hideHandlesIfMoved};(0,M.default)(n,t,l.handles,s,g),n.fillStyle=s;var v=(l.handles.end.x-l.handles.start.x)*(t.image.columnPixelSpacing||1),m=(l.handles.end.y-l.handles.start.y)*(t.image.rowPixelSpacing||1),h=Math.sqrt(v*v+m*m);l.length=h;var T=" mm";t.image.rowPixelSpacing&&t.image.columnPixelSpacing||(T=" pixels");var C=""+h.toFixed(2)+T;if(!l.handles.textBox.hasMoved){var b={x:Math.max(l.handles.start.x,l.handles.end.x)};b.x===l.handles.start.x?b.y=l.handles.start.y:b.y=l.handles.end.y,l.handles.textBox.x=b.x,l.handles.textBox.y=b.y}var I=u.pixelToCanvas(t.element,l.handles.textBox);I.x+=10;var $={centering:{x:!1,y:!0}},O=(0,p.default)(n,C,I.x,I.y,s,$);if(l.handles.textBox.boundingBox=O,l.handles.textBox.hasMoved){var k={start:{},end:{}},_={x:(d.x+f.x)/2,y:(d.y+f.y)/2},D=[d,f,_];k.end.x=I.x,k.end.y=I.y,k.start=c.point.findClosestPoint(D,k.end);var j=[{x:O.left+O.width/2,y:O.top},{x:O.left,y:O.top+O.height/2},{x:O.left+O.width/2,y:O.top+O.height},{x:O.left+O.width,y:O.top+O.height/2}];k.end=c.point.findClosestPoint(j,k.start),n.beginPath(),n.strokeStyle=s,n.lineWidth=a,n.setLineDash([2,3]),n.moveTo(k.start.x,k.start.y),n.lineTo(k.end.x,k.end.y),n.stroke()}n.restore()}}}Object.defineProperty(t,"__esModule",{value:!0}),t.lengthTouch=t.length=void 0;var s=o(0),u=a(s),d=o(2),c=a(d),f=o(8),g=n(f),v=o(9),m=n(v),h=o(5),p=n(h),T=o(6),y=n(T),C=o(4),x=n(C),b=o(7),M=n(b),w=o(1),P="length",S=(0,g.default)({createNewMeasurement:r,onImageRendered:l,pointNearTool:i,toolType:P}),I=(0,m.default)({createNewMeasurement:r,onImageRendered:l,pointNearTool:i,toolType:P});t.length=S,t.lengthTouch=I},function(e,t,o){"use strict";function n(e){return e&&e.__esModule?e:{default:e}}function a(e,t){var o=t.element;$(o).off("CornerstoneToolsMouseDrag",u),$(o).off("CornerstoneToolsMouseUp",a),$(o).off("CornerstoneToolsMouseClick",a),$(o).off("CornerstoneNewImage",l),r(t)}function r(e){$(e.element).find(".magnifyTool").hide(),document.body.style.cursor="default"}function i(e,t){var o=t.element;if((0,w.default)(t.which,e.data.mouseButtonMask))return $(o).on("CornerstoneToolsMouseDrag",t,u),$(o).on("CornerstoneToolsMouseUp",t,a),$(o).on("CornerstoneToolsMouseClick",t,a),I=t.currentPoints,$(o).on("CornerstoneNewImage",t,l),d(t),!1}function l(e,t){t.currentPoints=I,d(t)}function s(e,t){var o=t.element;$(t.element).off("CornerstoneToolsDragEnd",s),$(t.element).off("CornerstoneToolsTouchEnd",s),$(o).off("CornerstoneNewImage",l),r(t)}function u(e,t){return I=t.currentPoints,d(t),!0===t.isTouchEvent&&($(t.element).on("CornerstoneToolsDragEnd",s),$(t.element).on("CornerstoneToolsTouchEnd",s)),!1}function d(e){var t=$(e.element).find(".magnifyTool").get(0);t||c(e.element);var o=O.getConfiguration(),n=o.magnifySize,a=o.magnificationLevel,r=$(e.element).find("canvas").not(".magnifyTool").get(0);r.getContext("2d").setTransform(1,0,0,1,0,0);var i=t.getContext("2d");i.setTransform(1,0,0,1,0,0);var l=n/a,s=y.pixelToCanvas(e.element,e.currentPoints.image);!0===e.isTouchEvent&&(s.y-=1.25*l),s.x=Math.max(s.x,0),s.x=Math.min(s.x,r.width),s.y=Math.max(s.y,0),s.y=Math.min(s.y,r.height),i.clearRect(0,0,n,n),i.fillStyle="transparent",i.fillRect(0,0,n,n);var u={x:s.x-.5*l,y:s.y-.5*l};"Safari"===S&&(u.x=Math.max(u.x,0),u.y=Math.max(u.y,0)),u.x=Math.min(u.x,r.width),u.y=Math.min(u.y,r.height);var d={x:(r.width-u.x)*a,y:(r.height-u.y)*a};i.drawImage(r,u.x,u.y,r.width-u.x,r.height-u.y,0,0,d.x,d.y),t.style.top=s.y-.5*n+"px",t.style.left=s.x-.5*n+"px",t.style.display="block",document.body.style.cursor="none"}function c(e){if(0===$(e).find(".magnifyTool").length){var t=document.createElement("canvas");t.classList.add("magnifyTool");var o=O.getConfiguration();t.width=o.magnifySize,t.height=o.magnifySize,t.style.position="absolute",e.appendChild(t)}}function f(e){$(e).find(".magnifyTool").remove()}function g(e){$(e).off("CornerstoneToolsMouseDown",i),f(e)}function v(e){if(!S){var t=(0,b.getBrowserInfo)(),o=t.split(" ");S=o[0]}c(e)}function m(e,t){var o={mouseButtonMask:t};$(e).off("CornerstoneToolsMouseDown",i),$(e).on("CornerstoneToolsMouseDown",o,i),c(e)}function h(){return P}function p(e){P=e}Object.defineProperty(t,"__esModule",{value:!0}),t.magnifyTouchDrag=t.magnify=void 0;var T=o(0),y=function(e){if(e&&e.__esModule)return e;var t={};if(null!=e)for(var o in e)Object.prototype.hasOwnProperty.call(e,o)&&(t[o]=e[o]);return t.default=e,t}(T),C=o(10),x=n(C),b=o(17),M=o(3),w=n(M),P={magnifySize:100,magnificationLevel:2},S=void 0,I=void 0,O={enable:v,activate:m,deactivate:g,disable:g,getConfiguration:h,setConfiguration:p},k={fireOnTouchStart:!0,activateCallback:c,disableCallback:f},_=(0,x.default)(u,k);t.magnify=O,t.magnifyTouchDrag=_},function(e,t,o){"use strict";function n(e){return e&&e.__esModule?e:{default:e}}function a(e,t){$(t.element).off("CornerstoneToolsMouseDrag",u),$(t.element).off("CornerstoneToolsMouseUp",a),$(t.element).off("CornerstoneToolsMouseClick",a),r(t)}function r(e){$(e.element).find(".magnifyTool").hide(),document.body.style.cursor="default",_=null}function i(e,t){var o=t.element;if((0,S.default)(t.which,e.data.mouseButtonMask))return $(o).on("CornerstoneToolsMouseDrag",t,u),$(o).on("CornerstoneToolsMouseUp",t,a),$(o).on("CornerstoneToolsMouseClick",t,a),k=t.currentPoints,$(o).on("CornerstoneNewImage",t,l),$(o).on("CornerstonePreRender",t,g),!1}function l(e,t){t.currentPoints=k,d(t)}function s(e,t){var o=t.element;$(t.element).off("CornerstoneToolsDragEnd",s),$(t.element).off("CornerstoneToolsTouchEnd",s),$(o).off("CornerstoneNewImage",l),r(t)}function u(e,t){return k=t.currentPoints,d(t),!0===t.isTouchEvent&&($(t.element).on("CornerstoneToolsDragEnd",s),$(t.element).on("CornerstoneToolsTouchEnd",s)),!1}function d(e){var t=$(e.element).find(".magnifyTool").get(0);t||c(e.element);var o=D.getConfiguration(),n=o.magnifySize,a=o.magnificationLevel;if(null!==_){var r=$(e.element).find("canvas").not(".magnifyTool").get(0);r.getContext("2d").setTransform(1,0,0,1,0,0);var i=t.getContext("2d");i.setTransform(1,0,0,1,0,0);var l=n,s=x.pixelToCanvas(e.element,e.currentPoints.image);!0===e.isTouchEvent&&(s.y-=1.25*l),s.x=Math.max(s.x,0),s.x=Math.min(s.x,r.width),s.y=Math.max(s.y,0),s.y=Math.min(s.y,r.height),i.clearRect(0,0,n,n),i.fillStyle="transparent",i.fillRect(0,0,n,n);var u={x:s.x*a-.5*l,y:s.y*a-.5*l};"Safari"===O&&(u.x=Math.max(u.x,0),u.y=Math.max(u.y,0)),u.x=Math.min(u.x,_.width),u.y=Math.min(u.y,_.height),i.drawImage(_,u.x,u.y,l,l,0,0,l,l),t.style.top=s.y-.5*n+"px",t.style.left=s.x-.5*n+"px",t.style.display="block",document.body.style.cursor="none"}}function c(e){if(0===$(e).find(".magnifyTool").length){var t=document.createElement("canvas");t.classList.add("magnifyTool");var o=D.getConfiguration();t.width=o.magnifySize,t.height=o.magnifySize,t.style.position="absolute",t.style.display="none",e.appendChild(t)}}function f(e){$(e).find(".magnifyTool").remove()}function g(e,t){var o=t.enabledElement,n=D.getConfiguration(),a=n.magnificationLevel,r=o.canvas,i=o.image,l=document.createElement("canvas");$(o.element).off("CornerstonePreRender",g),l.width=r.width*a,l.height=r.height*a;var s=x.getViewport(o.element);s.scale*=a,v(l,i,s),_=l,d({element:t.enabledElement.element,currentPoints:k})}function v(e,t,o){var n={};n.image=t,n.canvas=e,n.viewport=o,n.invalid=!0,t.render(n,!0)}function m(e){$(e).off("CornerstoneToolsMouseDown",i),f(e)}function h(e){var t=D.getConfiguration(t);if(!O){var o=(0,w.getBrowserInfo)(),n=o.split(" ");O=n[0]}c(e)}function p(e,t){var o={mouseButtonMask:t};$(e).off("CornerstoneToolsMouseDown",i),$(e).on("CornerstoneToolsMouseDown",o,i),c(e)}function T(){return I}function y(e){I=e}Object.defineProperty(t,"__esModule",{value:!0}),t.magnify2TouchDrag=t.magnify2=void 0;var C=o(0),x=function(e){if(e&&e.__esModule)return e;var t={};if(null!=e)for(var o in e)Object.prototype.hasOwnProperty.call(e,o)&&(t[o]=e[o]);return t.default=e,t}(C),b=o(10),M=n(b),w=o(17),P=o(3),S=n(P),I={magnifySize:300,magnificationLevel:5},O=void 0,k=void 0,_=null,D={enable:h,activate:p,deactivate:m,disable:m,getConfiguration:T,setConfiguration:y},j={fireOnTouchStart:!0,activateCallback:c,disableCallback:f},E=(0,M.default)(u,j);t.magnify2=D,t.magnify2TouchDrag=E},function(e,t,o){"use strict";function n(e){return e&&e.__esModule?e:{default:e}}function a(e){var t=s.getEnabledElement(e),o=s.metaData.get("imagePlane",t.image.imageId);if(o&&o.rowCosines&&o.columnCosines){var n=d.default.getOrientationString(o.rowCosines),a=d.default.getOrientationString(o.columnCosines),r=d.default.invertOrientationString(n);return{top:d.default.invertOrientationString(a),bottom:a,left:r,right:n}}}function r(e){var t=s.getEnabledElement(e),o=void 0;o={x:t.image.width/2,y:5};var n=s.pixelToCanvas(e,o);o={x:t.image.width/2,y:t.image.height-5};var a=s.pixelToCanvas(e,o);o={x:5,y:t.image.height/2};var r=s.pixelToCanvas(e,o);return o={x:t.image.width-10,y:t.image.height/2},{top:n,bottom:a,left:r,right:s.pixelToCanvas(e,o)}}function i(e,t){var o=t.element,n=a(o);if(n){var i=r(o,n),l=t.canvasContext.canvas.getContext("2d");l.setTransform(1,0,0,1,0,0);var s=v.default.getToolColor(),u={top:l.measureText(n.top).width,left:l.measureText(n.left).width,right:l.measureText(n.right).width,bottom:l.measureText(n.bottom).width};(0,h.default)(l,n.top,i.top.x-u.top/2,i.top.y,s),(0,h.default)(l,n.left,i.left.x-u.left/2,i.left.y,s);var d=p.getConfiguration();d&&d.drawAllMarkers&&((0,h.default)(l,n.right,i.right.x-u.right/2,i.right.y,s),(0,h.default)(l,n.bottom,i.bottom.x-u.bottom/2,i.bottom.y,s))}}Object.defineProperty(t,"__esModule",{value:!0});var l=o(0),s=function(e){if(e&&e.__esModule)return e;var t={};if(null!=e)for(var o in e)Object.prototype.hasOwnProperty.call(e,o)&&(t[o]=e[o]);return t.default=e,t}(l),u=o(40),d=n(u),c=o(28),f=n(c),g=o(4),v=n(g),m=o(5),h=n(m),p=(0,f.default)(i);t.default=p},function(e,t,o){"use strict";function n(e){return e&&e.__esModule?e:{default:e}}function a(e,t){$(t.element).off("CornerstoneToolsMouseDrag",i),$(t.element).off("CornerstoneToolsMouseUp",a),$(t.element).off("CornerstoneToolsMouseClick",a)}function r(e,t){if((0,v.default)(t.which,e.data.mouseButtonMask))return $(t.element).on("CornerstoneToolsMouseDrag",i),$(t.element).on("CornerstoneToolsMouseUp",a),$(t.element).on("CornerstoneToolsMouseClick",a),!1}function i(e,t){var o=t.viewport.scale,n=t.viewport.scale;return t.image.rowPixelSpacing<t.image.columnPixelSpacing?o*=t.image.columnPixelSpacing/t.image.rowPixelSpacing:t.image.columnPixelSpacing<t.image.rowPixelSpacing&&(n*=t.image.rowPixelSpacing/t.image.columnPixelSpacing),t.viewport.translation.x+=t.deltaPoints.page.x/o,t.viewport.translation.y+=t.deltaPoints.page.y/n,s.setViewport(t.element,t.viewport),!1}Object.defineProperty(t,"__esModule",{value:!0}),t.panTouchDrag=t.pan=void 0;var l=o(0),s=function(e){if(e&&e.__esModule)return e;var t={};if(null!=e)for(var o in e)Object.prototype.hasOwnProperty.call(e,o)&&(t[o]=e[o]);return t.default=e,t}(l),u=o(14),d=n(u),c=o(10),f=n(c),g=o(3),v=n(g),m=(0,d.default)(r),h=(0,f.default)(i);t.pan=m,t.panTouchDrag=h},function(e,t,o){"use strict";function n(e,t){var o=u.getConfiguration();if(o&&o.testPointers(t))return t.viewport.translation.x+=t.deltaPoints.page.x/t.viewport.scale,t.viewport.translation.y+=t.deltaPoints.page.y/t.viewport.scale,r.setViewport(t.element,t.viewport),!1}Object.defineProperty(t,"__esModule",{value:!0});var a=o(0),r=function(e){if(e&&e.__esModule)return e;var t={};if(null!=e)for(var o in e)Object.prototype.hasOwnProperty.call(e,o)&&(t[o]=e[o]);return t.default=e,t}(a),i=o(32),l=function(e){return e&&e.__esModule?e:{default:e}}(i),s={testPointers:function(e){return e.numPointers>=2}},u=(0,l.default)(n);u.setConfiguration(s),t.default=u},function(e,t,o){"use strict";function n(e){return e&&e.__esModule?e:{default:e}}function a(e){if(e&&e.__esModule)return e;var t={};if(null!=e)for(var o in e)Object.prototype.hasOwnProperty.call(e,o)&&(t[o]=e[o]);return t.default=e,t}function r(e){return{visible:!0,active:!0,handles:{end:{x:e.currentPoints.image.x,y:e.currentPoints.image.y,highlight:!0,active:!0}}}}function i(e,t,o){var n=u.pixelToCanvas(e,t.handles.end);return c.point.distance(n,o)<5}function l(e,t){var o=(0,$.getToolState)(e.currentTarget,O);if(o){var n=t.canvasContext.canvas.getContext("2d");n.setTransform(1,0,0,1,0,0);for(var a=void 0,r=y.default.getFont(),i=y.default.getFontSize(),l=0;l<o.data.length;l++){n.save();var s=o.data[l];a=s.active?p.default.getActiveColor():p.default.getToolColor(),(0,x.default)(n,t,s.handles,a);var d=Math.round(s.handles.end.x),c=Math.round(s.handles.end.y),f=void 0,g=void 0,v=void 0;if(d<0||c<0||d>=t.image.columns||c>=t.image.rows)return;if(t.image.color)g=d+", "+c,f=(0,P.default)(t.element,d,c,1,1),v="R: "+f[0]+" G: "+f[1]+" B: "+f[2];else{f=u.getStoredPixels(t.element,d,c,1,1);var m=f[0],h=m*t.image.slope+t.image.intercept,T=(0,I.default)(t.image,m);g=d+", "+c,v="SP: "+m+" MO: "+parseFloat(h.toFixed(3)),T&&(v+=" SUV: "+parseFloat(T.toFixed(3)))}var C={x:s.handles.end.x+3,y:s.handles.end.y-3},b=u.pixelToCanvas(t.element,C);n.font=r,n.fillStyle=a,(0,M.default)(n,v,b.x,b.y+i+5,a),(0,M.default)(n,g,b.x,b.y,a),n.restore()}}}Object.defineProperty(t,"__esModule",{value:!0}),t.probeTouch=t.probe=void 0;var s=o(0),u=a(s),d=o(2),c=a(d),f=o(8),g=n(f),v=o(9),m=n(v),h=o(4),p=n(h),T=o(12),y=n(T),C=o(7),x=n(C),b=o(5),M=n(b),w=o(24),P=n(w),S=o(19),I=n(S),$=o(1),O="probe",k=(0,g.default)({createNewMeasurement:r,onImageRendered:l,pointNearTool:i,toolType:O}),_=(0,m.default)({createNewMeasurement:r,onImageRendered:l,pointNearTool:i,toolType:O});t.probe=k,t.probeTouch=_},function(e,t,o){"use strict";function n(e){return e&&e.__esModule?e:{default:e}}function a(e){if(e&&e.__esModule)return e;var t={};if(null!=e)for(var o in e)Object.prototype.hasOwnProperty.call(e,o)&&(t[o]=e[o]);return t.default=e,t}function r(e){return{visible:!0,active:!0,handles:{end:{x:e.currentPoints.image.x,y:e.currentPoints.image.y,highlight:!0,active:!0}}}}function i(e,t,o){var n=d.pixelToCanvas(e,t.handles.end);return f.point.distanceSquared(n,o)<25}function l(e,t,o,n){var a=void 0,r=void 0,i=d.metaData.get("generalSeriesModule",t.imageId),l="";if(i&&"CT"===i.modality&&(l=" HU"),t.color){r=(0,S.default)(e,o,n,1,1);var s=O.getConfiguration();a=s.valuesmap?s.valuesmap(t.imageId,r)+l:"R: "+r[0]+" G: "+r[1]+" B: "+r[2]}else{r=d.getStoredPixels(e,o,n,1,1);var u=r[0],c=u*t.slope+t.intercept;a=String(c)+l}return a}function s(e,t){var o=(0,I.getToolState)(e.currentTarget,$);if(o){var n=t.canvasContext.canvas.getContext("2d");n.setTransform(1,0,0,1,0,0);for(var a=void 0,r=C.default.getFont(),i=C.default.getFontSize(),s=0;s<o.data.length;s++){n.save();var u=o.data[s],c=O.getConfiguration();c&&c.shadow&&(n.shadowColor=void 0===c.shadowColor?"#000000":c.shadowColor,n.shadowOffsetX=void 0===c.shadowOffsetX?1:c.shadowOffsetX,n.shadowOffsetX=void 0===c.shadowOffsetY?1:c.shadowOffsetY,n.shadowBlur=void 0===c.shadowBlur?1:c.shadowBlur);var f=void 0===c.handleRadius?1.5:c.handleRadius;a=u.active?T.default.getActiveColor():T.default.getToolColor(),(0,b.default)(n,t,u.handles,a,{handleRadius:f});var g=Math.round(u.handles.end.x),v=Math.round(u.handles.end.y);if(g<0||v<0||g>=t.image.columns||v>=t.image.rows)return;var m=u.cache,h=void 0;void 0===m||m.x!==g||m.y!==v?(h=l(t.element,t.image,g,v),u.cache={x:g,y:v,str:h}):h=m.str;var p={x:u.handles.end.x+3,y:u.handles.end.y-3},y=d.pixelToCanvas(t.element,p);n.font=r,n.fillStyle=a,(0,w.default)(n,h,y.x,y.y+i+5,a),n.restore()}}}Object.defineProperty(t,"__esModule",{value:!0}),t.probexTouch=t.probex=void 0;var u=o(0),d=a(u),c=o(2),f=a(c),g=o(8),v=n(g),m=o(9),h=n(m),p=o(4),T=n(p),y=o(12),C=n(y),x=o(7),b=n(x),M=o(5),w=n(M),P=o(24),S=n(P),I=o(1),$="probex",O=(0,v.default)({createNewMeasurement:r,onImageRendered:s,pointNearTool:i,toolType:$}),k=(0,h.default)({createNewMeasurement:r,onImageRendered:s,pointNearTool:i,toolType:$});t.probex=O,t.probexTouch=k},function(e,t,o){"use strict";function n(e){return e&&e.__esModule?e:{default:e}}function a(e){if(e&&e.__esModule)return e;var t={};if(null!=e)for(var o in e)Object.prototype.hasOwnProperty.call(e,o)&&(t[o]=e[o]);return t.default=e,t}function r(e){return{visible:!0,active:!0,invalidated:!0,handles:{start:{x:e.currentPoints.image.x,y:e.currentPoints.image.y,highlight:!0,active:!1},end:{x:e.currentPoints.image.x,y:e.currentPoints.image.y,highlight:!0,active:!0},textBox:{active:!1,hasMoved:!1,movesIndependently:!1,drawnIndependently:!0,allowedOutsideImage:!0,hasBoundingBox:!0}}}}function i(e,t,o){var n=c.pixelToCanvas(e,t.handles.start),a=c.pixelToCanvas(e,t.handles.end),r={left:Math.min(n.x,a.x),top:Math.min(n.y,a.y),width:Math.abs(n.x-a.x),height:Math.abs(n.y-a.y)};return g.rect.distanceToPoint(r,o)<5}function l(e,t){for(var o=0,n=0,a=0,r=0,i=t.top;i<t.top+t.height;i++)for(var l=t.left;l<t.left+t.width;l++)o+=e[r],n+=e[r]*e[r],a++,r++;if(0===a)return{count:a,mean:0,variance:0,stdDev:0};var s=o/a,u=n/a-s*s;return{count:a,mean:s,variance:u,stdDev:Math.sqrt(u)}}function s(e){var t=e.toString().split(".");return t[0]=t[0].replace(/\B(?=(\d{3})+(?!\d))/g,","),t.join(".")}function u(e,t){var o=(0,$.getToolState)(e.currentTarget,O);if(o){var n=t.image,a=t.element,r=y.default.getToolWidth(),i=k.getConfiguration(),u=t.canvasContext.canvas.getContext("2d"),d=c.metaData.get("generalSeriesModule",n.imageId),f=void 0;d&&(f=d.modality),u.setTransform(1,0,0,1,0,0);for(var v=0;v<o.data.length;v++){u.save();var m=o.data[v];i&&i.shadow&&(u.shadowColor=i.shadowColor||"#000000",u.shadowOffsetX=i.shadowOffsetX||1,u.shadowOffsetY=i.shadowOffsetY||1);var h=x.default.getColorIfActive(m.active),p=c.pixelToCanvas(a,m.handles.start),T=c.pixelToCanvas(a,m.handles.end),C=Math.min(p.x,T.x),b=Math.min(p.y,T.y),w=Math.abs(p.x-T.x),S=Math.abs(p.y-T.y);if(u.beginPath(),u.strokeStyle=h,u.lineWidth=r,u.rect(C,b,w,S),u.stroke(),i&&i.drawHandlesOnHover)if(!0===m.active)(0,M.default)(u,t,m.handles,h);else{var _={drawHandlesIfActive:!0};(0,M.default)(u,t,m.handles,h,_)}else(0,M.default)(u,t,m.handles,h);var D=void 0,j=void 0,E=void 0;if(!1===m.invalidated)j=m.meanStdDev,E=m.meanStdDevSUV,D=m.area;else{var R={left:Math.min(m.handles.start.x,m.handles.end.x),top:Math.min(m.handles.start.y,m.handles.end.y),width:Math.abs(m.handles.start.x-m.handles.end.x),height:Math.abs(m.handles.start.y-m.handles.end.y)};if(!n.color){j=l(c.getPixels(a,R.left,R.top,R.width,R.height),R),"PT"===f&&(E={mean:(0,I.default)(n,(j.mean-n.intercept)/n.slope),stdDev:(0,I.default)(n,(j.stdDev-n.intercept)/n.slope)}),j&&!isNaN(j.mean)&&(m.meanStdDev=j,m.meanStdDevSUV=E)}D=R.width*(n.columnPixelSpacing||1)*(R.height*(n.rowPixelSpacing||1)),isNaN(D)||(m.area=D),m.invalidated=!1}var A=[];if(j&&j.mean){var B="";"CT"===f&&(B=" HU");var N="Mean: "+s(j.mean.toFixed(2))+B,H="StdDev: "+s(j.stdDev.toFixed(2))+B;if(E&&void 0!==E.mean){N+=" SUV: "+s(E.mean.toFixed(2)),H+=" SUV: "+s(E.stdDev.toFixed(2))}A.push(N),A.push(H)}if(D){var V=" mm"+String.fromCharCode(178);n.rowPixelSpacing&&n.columnPixelSpacing||(V=" pixels"+String.fromCharCode(178));var W="Area: "+s(D.toFixed(2))+V;A.push(W)}m.handles.textBox.hasMoved||(m.handles.textBox.x=Math.max(m.handles.start.x,m.handles.end.x),m.handles.textBox.y=(m.handles.start.y+m.handles.end.y)/2);var L=c.pixelToCanvas(a,m.handles.textBox),Y={centering:{x:!1,y:!0}},F=(0,P.default)(u,A,L.x,L.y,h,Y);if(m.handles.textBox.boundingBox=F,m.handles.textBox.hasMoved){var z={start:{},end:{x:L.x,y:L.y}},X=[{x:C+w/2,y:b},{x:C,y:b+S/2},{x:C+w/2,y:b+S},{x:C+w,y:b+S/2}];z.start=g.point.findClosestPoint(X,z.end);var U=[{x:F.left+F.width/2,y:F.top},{x:F.left,y:F.top+F.height/2},{x:F.left+F.width/2,y:F.top+F.height},{x:F.left+F.width,y:F.top+F.height/2}];z.end=g.point.findClosestPoint(U,z.start),u.beginPath(),u.strokeStyle=h,u.lineWidth=r,u.setLineDash([2,3]),u.moveTo(z.start.x,z.start.y),u.lineTo(z.end.x,z.end.y),u.stroke()}u.restore()}}}Object.defineProperty(t,"__esModule",{value:!0}),t.rectangleRoiTouch=t.rectangleRoi=void 0;var d=o(0),c=a(d),f=o(2),g=a(f),v=o(8),m=n(v),h=o(9),p=n(h),T=o(6),y=n(T),C=o(4),x=n(C),b=o(7),M=n(b),w=o(5),P=n(w),S=o(19),I=n(S),$=o(1),O="rectangleRoi",k=(0,m.default)({createNewMeasurement:r,onImageRendered:u,pointNearTool:i,toolType:O}),_=(0,p.default)({createNewMeasurement:r,onImageRendered:u,pointNearTool:i,toolType:O});t.rectangleRoi=k,t.rectangleRoiTouch=_},function(e,t,o){"use strict";function n(e){return e&&e.__esModule?e:{default:e}}function a(e){var t=e.element.getBoundingClientRect(e.element),o={x:e.currentPoints.client.x,y:e.currentPoints.client.y},n=e.element.clientWidth,a=e.element.clientHeight,r={x:o.x-t.left-n/2,y:-1*(o.y-t.top-a/2)},i=Math.atan2(r.y,r.x),l=i*(180/Math.PI),s=-1*l+90;e.viewport.rotation=s,c.setViewport(e.element,e.viewport)}function r(e){e.viewport.rotation+=e.deltaPoints.page.x/e.viewport.scale,c.setViewport(e.element,e.viewport)}function i(e){e.viewport.rotation+=e.deltaPoints.page.y/e.viewport.scale,c.setViewport(e.element,e.viewport)}function l(e,t){$(t.element).off("CornerstoneToolsMouseDrag",u),$(t.element).off("CornerstoneToolsMouseUp",l),$(t.element).off("CornerstoneToolsMouseClick",l)}function s(e,t){if((0,p.default)(t.which,e.data.mouseButtonMask))return $(t.element).on("CornerstoneToolsMouseDrag",u),$(t.element).on("CornerstoneToolsMouseUp",l),$(t.element).on("CornerstoneToolsMouseClick",l),!1}function u(e,t){return T.strategy(t),c.setViewport(t.element,t.viewport),!1}Object.defineProperty(t,"__esModule",{value:!0}),t.rotateTouchDrag=t.rotate=void 0;var d=o(0),c=function(e){if(e&&e.__esModule)return e;var t={};if(null!=e)for(var o in e)Object.prototype.hasOwnProperty.call(e,o)&&(t[o]=e[o]);return t.default=e,t}(d),f=o(14),g=n(f),v=o(10),m=n(v),h=o(3),p=n(h),T=(0,g.default)(s);T.strategies={default:a,horizontal:r,vertical:i},T.strategy=a;var y=(0,m.default)(u);t.rotate=T,t.rotateTouchDrag=y},function(e,t,o){"use strict";function n(e,t){return t.viewport.rotation+=t.rotation,l.setViewport(t.element,t.viewport),!1}function a(e){$(e).off("CornerstoneToolsTouchRotate",n)}function r(e){$(e).off("CornerstoneToolsTouchRotate",n),$(e).on("CornerstoneToolsTouchRotate",n)}Object.defineProperty(t,"__esModule",{value:!0});var i=o(0),l=function(e){if(e&&e.__esModule)return e;var t={};if(null!=e)for(var o in e)Object.prototype.hasOwnProperty.call(e,o)&&(t[o]=e[o]);return t.default=e,t}(i),s={activate:r,disable:a};t.default=s},function(e,t,o){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.default=function(e,t){var o=$(e).find("canvas").get(0),n=document.createElement("a");if(n.download=t,n.href=o.toDataURL(),document.createEvent){var a=document.createEvent("MouseEvents");a.initMouseEvent("click",!0,!0,window,0,0,0,0,0,!1,!1,!1,!1,0,null),n.dispatchEvent(a)}else n.fireEvent&&n.fireEvent("onclick")}},function(e,t,o){"use strict";function n(e){return e&&e.__esModule?e:{default:e}}function a(e){if(e&&e.__esModule)return e;var t={};if(null!=e)for(var o in e)Object.prototype.hasOwnProperty.call(e,o)&&(t[o]=e[o]);return t.default=e,t}function r(e){e(prompt("Enter your annotation:"))}function i(e,t,o){o(prompt("Change your annotation:"))}function l(e){function t(e){null===e?(0,Y.removeToolState)(o,F,a):a.text=e,a.active=!1,m.updateImage(o)}var o=e.element,n=X.getConfiguration(),a=s(e);(0,Y.addToolState)(o,F,a),m.updateImage(o),(0,E.default)(e,F,a,a.handles.end,function(){(0,D.default)(e,a.handles)&&(0,Y.removeToolState)(o,F,a),void 0===a.text&&n.getTextCallback(t),m.updateImage(o)})}function s(e){return{visible:!0,active:!0,handles:{end:{x:e.currentPoints.image.x,y:e.currentPoints.image.y,highlight:!0,active:!1},textBox:{active:!1,hasMoved:!1,movesIndependently:!1,drawnIndependently:!0,allowedOutsideImage:!0,hasBoundingBox:!0}}}}function u(e,t,o){if(t.handles.end){var n=m.pixelToCanvas(e,t.handles.end);return p.point.distance(n,o)<25}}function d(e,t){var o=(0,Y.getToolState)(e.currentTarget,F);if(o){var n=t.enabledElement,a=t.canvasContext.canvas.getContext("2d");a.setTransform(1,0,0,1,0,0);for(var r=t.canvasContext.canvas.width,i=void 0,l=I.default.getToolWidth(),s=P.default.getFont(),u=X.getConfiguration(),d=0;d<o.data.length;d++){a.save(),u&&u.shadow&&(a.shadowColor=u.shadowColor||"#000000",a.shadowOffsetX=u.shadowOffsetX||1,a.shadowOffsetY=u.shadowOffsetY||1);var c=o.data[d];i=c.active?k.default.getActiveColor():k.default.getToolColor();var f=m.pixelToCanvas(t.element,c.handles.end);(0,N.default)(a,f,i,l);var g={drawHandlesIfActive:u&&u.drawHandlesOnHover};if(u.drawHandles&&(0,A.default)(a,t,f,i,g),c.text&&""!==c.text){a.font=s;var v="";v=u.showCoordinates?c.text+" x: "+Math.round(c.handles.end.x)+" y: "+Math.round(c.handles.end.y):c.text;var h=a.measureText(v).width+10,T=P.default.getFontSize()+10,y=Math.max(h,T)/2+5;f.x>r/2&&(y=-y);var C=void 0;if(!c.handles.textBox.hasMoved){C={x:f.x-h/2+y,y:f.y-T/2};var x=m.internal.getTransform(n);x.invert();var b=x.transformPoint(C.x,C.y);c.handles.textBox.x=b.x,c.handles.textBox.y=b.y}C=m.pixelToCanvas(t.element,c.handles.textBox);var w=(0,M.default)(a,v,C.x,C.y,i);if(c.handles.textBox.boundingBox=w,c.handles.textBox.hasMoved){var S={start:{},end:{}};S.end.x=C.x,S.end.y=C.y,S.start=f;var $=[{x:w.left+w.width/2,y:w.top},{x:w.left,y:w.top+w.height/2},{x:w.left+w.width/2,y:w.top+w.height},{x:w.left+w.width,y:w.top+w.height/2}];S.end=p.point.findClosestPoint($,S.start),a.beginPath(),a.strokeStyle=i,a.lineWidth=l,a.setLineDash([2,3]),a.moveTo(S.start.x,S.start.y),a.lineTo(S.end.x,S.end.y),a.stroke()}}a.restore()}}}function c(e){function t(e){null===e?(0,Y.removeToolState)(o,F,a):a.text=e,a.active=!1,m.updateImage(o)}var o=e.element,n=X.getConfiguration(),a=s(e);(0,Y.addToolState)(o,F,a),m.updateImage(o),(0,E.default)(e,F,a,a.handles.end,function(){(0,D.default)(e,a.handles)&&(0,Y.removeToolState)(o,F,a),void 0===a.text&&n.getTextCallback(t),m.updateImage(o)})}function f(e,t){function o(e,t,o){!0===o?(0,Y.removeToolState)(n,F,e):e.text=t,e.active=!1,m.updateImage(n)}var n=t.element,a=void 0;if(!e.data||!e.data.mouseButtonMask||(0,V.default)(t.which,e.data.mouseButtonMask)){var r=X.getConfiguration(),i=t.currentPoints.canvas,l=(0,Y.getToolState)(n,F);if(l){for(var s=0;s<l.data.length;s++)if(a=l.data[s],u(n,a,i)||(0,L.default)(a.handles.textBox,i))return a.active=!0,m.updateImage(n),r.changeTextCallback(a,t,o),e.stopImmediatePropagation(),!1;return!1}}}function g(e,t){function o(e,t,o){console.log("pressCallback doneChangingTextCallback"),!0===o?(0,Y.removeToolState)(n,F,e):e.text=t,e.active=!1,m.updateImage(n),$(n).on("CornerstoneToolsTouchStart",U.touchStartCallback),$(n).on("CornerstoneToolsTouchStartActive",U.touchDownActivateCallback),$(n).on("CornerstoneToolsTap",U.tapCallback)}var n=t.element,a=void 0;if(e.data&&e.data.mouseButtonMask&&!(0,V.default)(t.which,e.data.mouseButtonMask))return!1;var r=X.getConfiguration(),i=t.currentPoints.canvas,l=(0,Y.getToolState)(n,F);if(!l)return!1;if(t.handlePressed)return $(n).off("CornerstoneToolsTouchStart",U.touchStartCallback),$(n).off("CornerstoneToolsTouchStartActive",U.touchDownActivateCallback),$(n).off("CornerstoneToolsTap",U.tapCallback),r.changeTextCallback(t.handlePressed,t,o),e.stopImmediatePropagation(),!1;for(var s=0;s<l.data.length;s++)if(a=l.data[s],u(n,a,i)||(0,L.default)(a.handles.textBox,i))return a.active=!0,m.updateImage(n),$(n).off("CornerstoneToolsTouchStart",U.touchStartCallback),$(n).off("CornerstoneToolsTouchStartActive",U.touchDownActivateCallback),$(n).off("CornerstoneToolsTap",U.tapCallback),r.changeTextCallback(a,t,o),e.stopImmediatePropagation(),!1;return!1}Object.defineProperty(t,"__esModule",{value:!0}),t.seedAnnotateTouch=t.seedAnnotate=void 0;var v=o(0),m=a(v),h=o(2),p=a(h),T=o(8),y=n(T),C=o(9),x=n(C),b=o(5),M=n(b),w=o(12),P=n(w),S=o(6),I=n(S),O=o(4),k=n(O),_=o(13),D=n(_),j=o(20),E=n(j),R=o(7),A=n(R),B=o(46),N=n(B),H=o(3),V=n(H),W=o(18),L=n(W),Y=o(1),F="seedAnnotate",z={getTextCallback:r,changeTextCallback:i,drawHandles:!1,drawHandlesOnHover:!0,currentLetter:"A",currentNumber:0,showCoordinates:!0,countUp:!0},X=(0,y.default)({addNewMeasurement:l,createNewMeasurement:s,onImageRendered:d,pointNearTool:u,toolType:F,mouseDoubleClickCallback:f});X.setConfiguration(z);var U=(0,x.default)({addNewMeasurement:c,createNewMeasurement:s,onImageRendered:d,pointNearTool:u,toolType:F,pressCallback:g});t.seedAnnotate=X,t.seedAnnotateTouch=U},function(e,t,o){"use strict";function n(e){return e&&e.__esModule?e:{default:e}}function a(e){if(e&&e.__esModule)return e;var t={};if(null!=e)for(var o in e)Object.prototype.hasOwnProperty.call(e,o)&&(t[o]=e[o]);return t.default=e,t}function r(e){return{visible:!0,active:!0,handles:{start:{x:e.currentPoints.image.x,y:e.currentPoints.image.y,highlight:!0,active:!1},middle:{x:e.currentPoints.image.x,y:e.currentPoints.image.y,highlight:!0,active:!0},end:{x:e.currentPoints.image.x,y:e.currentPoints.image.y,highlight:!0,active:!1},textBox:{active:!1,hasMoved:!1,movesIndependently:!1,drawnIndependently:!0,allowedOutsideImage:!0,hasBoundingBox:!0}}}}function i(e,t,o){var n={start:f.pixelToCanvas(e,t.handles.start),end:f.pixelToCanvas(e,t.handles.middle)},a=v.lineSegment.distanceToPoint(n,o);return a<25||(n.start=f.pixelToCanvas(e,t.handles.middle),n.end=f.pixelToCanvas(e,t.handles.end),(a=v.lineSegment.distanceToPoint(n,o))<25)}function l(e){return Math.sqrt(Math.pow(e.x,2)+Math.pow(e.y,2))}function s(e,t){var o=(0,N.getToolState)(e.currentTarget,H);if(o){var n=t.enabledElement,a=t.canvasContext.canvas.getContext("2d");a.setTransform(1,0,0,1,0,0);for(var r=void 0,i=w.default.getToolWidth(),s=b.default.getFont(),u=V.getConfiguration(),d=0;d<o.data.length;d++){a.save(),u&&u.shadow&&(a.shadowColor=void 0===u.shadowColor?"#000000":u.shadowColor,a.shadowOffsetX=void 0===u.shadowOffsetX?1:u.shadowOffsetX,a.shadowOffsetX=void 0===u.shadowOffsetY?1:u.shadowOffsetY,a.shadowBlur=void 0===u.shadowBlur?1:u.shadowBlur);var c=o.data[d];r=c.active?S.default.getActiveColor():S.default.getToolColor();var g=f.pixelToCanvas(t.element,c.handles.start),m=f.pixelToCanvas(t.element,c.handles.middle),h=f.pixelToCanvas(t.element,c.handles.end);a.beginPath(),a.strokeStyle=r,a.lineWidth=i,a.moveTo(g.x,g.y),a.lineTo(m.x,m.y),a.lineTo(h.x,h.y),a.stroke();var p={drawHandlesIfActive:u&&u.drawHandlesOnHover};(0,R.default)(a,t,c.handles,r,p),a.fillStyle=r;var y=t.image.columnPixelSpacing||1,x=t.image.rowPixelSpacing||1,M="";t.image.rowPixelSpacing&&t.image.columnPixelSpacing||(M=" (isotropic)");var P={x:(Math.ceil(c.handles.middle.x)-Math.ceil(c.handles.start.x))*y,y:(Math.ceil(c.handles.middle.y)-Math.ceil(c.handles.start.y))*x},I={x:(Math.ceil(c.handles.end.x)-Math.ceil(c.handles.middle.x))*y,y:(Math.ceil(c.handles.end.y)-Math.ceil(c.handles.middle.y))*x},$={x:(Math.ceil(c.handles.end.x)-Math.ceil(c.handles.start.x))*y,y:(Math.ceil(c.handles.end.y)-Math.ceil(c.handles.start.y))*x},O=l(P),k=l(I),_=l($),D=Math.acos((Math.pow(O,2)+Math.pow(k,2)-Math.pow(_,2))/(2*O*k));D*=180/Math.PI;var j=(0,C.default)(D,2);if(j){var E=j.toString()+String.fromCharCode(parseInt("00B0",16))+M,A=void 0;if(c.handles.textBox.hasMoved)A=f.pixelToCanvas(t.element,c.handles.textBox);else{A={x:m.x,y:m.y},a.font=s;var B=a.measureText(E).width;m.x<g.x?A.x-=15+B+10:A.x+=15;var W=f.internal.getTransform(n);W.invert();var L=W.transformPoint(A.x,A.y);c.handles.textBox.x=L.x,c.handles.textBox.y=L.y}var Y={centering:{x:!1,y:!0}},F=(0,T.default)(a,E,A.x,A.y,r,Y);if(c.handles.textBox.boundingBox=F,c.handles.textBox.hasMoved){var z={start:{},end:{}},X=[g,h,m];z.end.x=A.x,z.end.y=A.y,z.start=v.point.findClosestPoint(X,z.end);var U=[{x:F.left+F.width/2,y:F.top},{x:F.left,y:F.top+F.height/2},{x:F.left+F.width/2,y:F.top+F.height},{x:F.left+F.width,y:F.top+F.height/2}];z.end=v.point.findClosestPoint(U,z.start),a.beginPath(),a.strokeStyle=r,a.lineWidth=i,a.setLineDash([2,3]),a.moveTo(z.start.x,z.start.y),a.lineTo(z.end.x,z.end.y),a.stroke()}}a.restore()}}}function u(e){var t=r(e),o=e.element,n={mouseButtonMask:e.which};(0,N.addToolState)(o,H,t),$(o).off("CornerstoneToolsMouseMove",V.mouseMoveCallback),$(o).off("CornerstoneToolsMouseDrag",V.mouseMoveCallback),$(o).off("CornerstoneToolsMouseDown",V.mouseDownCallback),$(o).off("CornerstoneToolsMouseDownActivate",V.mouseDownActivateCallback),f.updateImage(o),(0,_.default)(e,H,t,t.handles.middle,function(){if(t.active=!1,(0,O.default)(e,t.handles))return(0,N.removeToolState)(o,H,t),$(o).on("CornerstoneToolsMouseMove",V.mouseMoveCallback),$(o).on("CornerstoneToolsMouseDrag",V.mouseMoveCallback),$(o).on("CornerstoneToolsMouseDown",n,V.mouseDownCallback),$(o).on("CornerstoneToolsMouseDownActivate",n,V.mouseDownActivateCallback),void f.updateImage(o);t.handles.end.active=!0,f.updateImage(o),(0,_.default)(e,H,t,t.handles.end,function(){t.active=!1,(0,O.default)(e,t.handles)&&(0,N.removeToolState)(o,H,t),$(o).on("CornerstoneToolsMouseMove",V.mouseMoveCallback),$(o).on("CornerstoneToolsMouseDrag",V.mouseMoveCallback),$(o).on("CornerstoneToolsMouseDown",n,V.mouseDownCallback),$(o).on("CornerstoneToolsMouseDownActivate",n,V.mouseDownActivateCallback),f.updateImage(o)})})}function d(e){var t=r(e),o=e.element;(0,N.addToolState)(o,H,t),$(o).off("CornerstoneToolsTouchDrag",W.touchMoveCallback),$(o).off("CornerstoneToolsTouchStartActive",W.touchDownActivateCallback),$(o).off("CornerstoneToolsTouchStart",W.touchStartCallback),$(o).off("CornerstoneToolsTap",W.tapCallback),f.updateImage(o),(0,j.default)(e,H,t,t.handles.middle,function(){if((0,O.default)(e,t.handles))return(0,N.removeToolState)(o,H,t),$(o).on("CornerstoneToolsTouchDrag",W.touchMoveCallback),$(o).on("CornerstoneToolsTouchStart",W.touchStartCallback),$(o).on("CornerstoneToolsTouchStartActive",W.touchDownActivateCallback),$(o).on("CornerstoneToolsTap",W.tapCallback),void f.updateImage(o);(0,j.default)(e,H,t,t.handles.end,function(){(0,O.default)(e,t.handles)&&((0,N.removeToolState)(o,H,t),f.updateImage(o)),$(o).on("CornerstoneToolsTouchDrag",W.touchMoveCallback),$(o).on("CornerstoneToolsTouchStart",W.touchStartCallback),$(o).on("CornerstoneToolsTouchStartActive",W.touchDownActivateCallback),$(o).on("CornerstoneToolsTap",W.tapCallback)})})}Object.defineProperty(t,"__esModule",{value:!0}),t.simpleAngleTouch=t.simpleAngle=void 0;var c=o(0),f=a(c),g=o(2),v=a(g),m=o(8),h=n(m),p=o(5),T=n(p),y=o(23),C=n(y),x=o(12),b=n(x),M=o(6),w=n(M),P=o(4),S=n(P),I=o(13),O=n(I),k=o(21),_=n(k),D=o(29),j=n(D),E=o(7),R=n(E),A=o(9),B=n(A),N=o(1),H="simpleAngle",V=(0,h.default)({createNewMeasurement:r,addNewMeasurement:u,onImageRendered:s,pointNearTool:i,toolType:H}),W=(0,B.default)({createNewMeasurement:r,addNewMeasurement:d,onImageRendered:s,pointNearTool:i,toolType:H});t.simpleAngle=V,t.simpleAngleTouch=W},function(e,t,o){"use strict";function n(e){return e&&e.__esModule?e:{default:e}}function a(e){if(e&&e.__esModule)return e;var t={};if(null!=e)for(var o in e)Object.prototype.hasOwnProperty.call(e,o)&&(t[o]=e[o]);return t.default=e,t}function r(e){var t=O.getConfiguration();if(t.current){var o={visible:!0,active:!0,text:t.current,handles:{end:{x:e.currentPoints.image.x,y:e.currentPoints.image.y,highlight:!0,active:!0,hasBoundingBox:!0}}},n={left:0,top:0,width:e.image.width,height:e.image.height};if(g.point.insideRect(o.handles.end,n)){var a=t.markers.indexOf(t.current);return t.ascending?(a+=1)>=t.markers.length&&(t.loop?a-=t.markers.length:a=-1):(a-=1)<0&&(t.loop?a+=t.markers.length:a=-1),t.current=t.markers[a],o}}}function i(e,t,o){if(t.handles.end.boundingBox){var n=g.rect.distanceToPoint(t.handles.end.boundingBox,o),a=(0,y.default)(t.handles.end,o);return n<10||a}}function l(e,t){var o=(0,S.getToolState)(t.element,I);if(o){var n=t.canvasContext.canvas.getContext("2d");n.setTransform(1,0,0,1,0,0);for(var a=O.getConfiguration(),r=0;r<o.data.length;r++){var i=o.data[r],l=x.default.getToolColor();i.active&&(l=x.default.getActiveColor()),n.save(),a&&a.shadow&&(n.shadowColor=a.shadowColor||"#000000",n.shadowOffsetX=a.shadowOffsetX||1,n.shadowOffsetY=a.shadowOffsetY||1),n.fillStyle=l;var s=n.measureText(i.text);i.textWidth=s.width+10;var u=c.pixelToCanvas(t.element,i.handles.end),d={centering:{x:!0,y:!0}},f=(0,P.default)(n,i.text,u.x,u.y-10,l,d);i.handles.end.boundingBox=f,n.restore()}}}function s(e,t){function o(t,o,a){!0===a?(0,S.removeToolState)(n,I,t):t.text=o,t.active=!1,c.updateImage(n);var r={mouseButtonMask:e.data.mouseButtonMask};$(n).on("CornerstoneToolsMouseMove",r,O.mouseMoveCallback),$(n).on("CornerstoneToolsMouseDown",r,O.mouseDownCallback),$(n).on("CornerstoneToolsMouseDownActivate",r,O.mouseDownActivateCallback),$(n).on("CornerstoneToolsMouseDoubleClick",r,O.mouseDoubleClickCallback)}var n=t.element,a=void 0;if(!e.data||!e.data.mouseButtonMask||(0,M.default)(t.which,e.data.mouseButtonMask)){var r=O.getConfiguration(),l=t.currentPoints.canvas,s=(0,S.getToolState)(n,I);if(s){for(var u=0;u<s.data.length;u++)if(a=s.data[u],i(n,a,l))return a.active=!0,c.updateImage(n),$(n).off("CornerstoneToolsMouseMove",O.mouseMoveCallback),$(n).off("CornerstoneToolsMouseDown",O.mouseDownCallback),$(n).off("CornerstoneToolsMouseDownActivate",O.mouseDownActivateCallback),$(n).off("CornerstoneToolsMouseDoubleClick",O.mouseDoubleClickCallback),r.changeTextCallback(a,t,o),e.stopImmediatePropagation(),!1;return!1}}}function u(e,t){function o(e,t,o){!0===o?(0,S.removeToolState)(n,I,e):e.text=t,e.active=!1,c.updateImage(n),$(n).on("CornerstoneToolsTouchDrag",k.touchMoveCallback),$(n).on("CornerstoneToolsTouchStartActive",k.touchDownActivateCallback),$(n).on("CornerstoneToolsTouchStart",k.touchStartCallback),$(n).on("CornerstoneToolsTap",k.tapCallback),$(n).on("CornerstoneToolsTouchPress",k.pressCallback)}var n=t.element,a=void 0,r=O.getConfiguration(),l=t.currentPoints.canvas,s=(0,S.getToolState)(n,I);if(!s)return!1;if(t.handlePressed)return t.handlePressed.active=!0,c.updateImage(n),$(n).off("CornerstoneToolsTouchDrag",k.touchMoveCallback),$(n).off("CornerstoneToolsTouchStartActive",k.touchDownActivateCallback),$(n).off("CornerstoneToolsTouchStart",k.touchStartCallback),$(n).off("CornerstoneToolsTap",k.tapCallback),$(n).off("CornerstoneToolsTouchPress",k.pressCallback),r.changeTextCallback(t.handlePressed,t,o),e.stopImmediatePropagation(),!1;for(var u=0;u<s.data.length;u++)if(a=s.data[u],i(n,a,l))return a.active=!0,c.updateImage(n),$(n).off("CornerstoneToolsTouchDrag",k.touchMoveCallback),$(n).off("CornerstoneToolsTouchStartActive",k.touchDownActivateCallback),$(n).off("CornerstoneToolsTouchStart",k.touchStartCallback),$(n).off("CornerstoneToolsTap",k.tapCallback),$(n).off("CornerstoneToolsTouchPress",k.pressCallback),r.changeTextCallback(a,t,o),e.stopImmediatePropagation(),!1;return!1}Object.defineProperty(t,"__esModule",{value:!0}),t.textMarkerTouch=t.textMarker=void 0;var d=o(0),c=a(d),f=o(2),g=a(f),v=o(8),m=n(v),h=o(9),p=n(h),T=o(18),y=n(T),C=o(4),x=n(C),b=o(3),M=n(b),w=o(5),P=n(w),S=o(1),I="textMarker",O=(0,m.default)({createNewMeasurement:r,onImageRendered:l,pointNearTool:i,toolType:I,mouseDoubleClickCallback:s}),k=(0,p.default)({createNewMeasurement:r,onImageRendered:l,pointNearTool:i,toolType:I,pressCallback:u});t.textMarker=O,t.textMarkerTouch=k},function(e,t,o){"use strict";function n(e){return e&&e.__esModule?e:{default:e}}function a(e,t){$(t.element).off("CornerstoneToolsMouseDrag",l),$(t.element).off("CornerstoneToolsMouseUp",a),$(t.element).off("CornerstoneToolsMouseClick",a)}function r(e,t){if((0,h.default)(t.which,e.data.mouseButtonMask))return $(t.element).on("CornerstoneToolsMouseDrag",l),$(t.element).on("CornerstoneToolsMouseUp",a),$(t.element).on("CornerstoneToolsMouseClick",a),!1}function i(e){var t=e.image.maxPixelValue*e.image.slope+e.image.intercept,o=e.image.minPixelValue*e.image.slope+e.image.intercept,n=t-o,a=n/1024,r=e.deltaPoints.page.x*a,i=e.deltaPoints.page.y*a;e.viewport.voi.windowWidth+=r,e.viewport.voi.windowCenter+=i}function l(e,t){return p.strategy(t),d.setViewport(t.element,t.viewport),!1}function s(e,t){e.stopImmediatePropagation();var o=t,n=o.image.maxPixelValue*o.image.slope+o.image.intercept,a=o.image.minPixelValue*o.image.slope+o.image.intercept,r=n-a,i=r/1024,l=o.deltaPoints.page.x*i,s=o.deltaPoints.page.y*i,u=p.getConfiguration();u.orientation?0===u.orientation?(o.viewport.voi.windowWidth+=l,o.viewport.voi.windowCenter+=s):(o.viewport.voi.windowWidth+=s,o.viewport.voi.windowCenter+=l):(o.viewport.voi.windowWidth+=l,o.viewport.voi.windowCenter+=s),d.setViewport(o.element,o.viewport)}Object.defineProperty(t,"__esModule",{value:!0}),t.wwwcTouchDrag=t.wwwc=void 0;var u=o(0),d=function(e){if(e&&e.__esModule)return e;var t={};if(null!=e)for(var o in e)Object.prototype.hasOwnProperty.call(e,o)&&(t[o]=e[o]);return t.default=e,t}(u),c=o(14),f=n(c),g=o(10),v=n(g),m=o(3),h=n(m),p=(0,f.default)(r);p.strategies={default:i},p.strategy=i;var T=(0,v.default)(s);t.wwwc=p,t.wwwcTouchDrag=T},function(e,t,o){"use strict";function n(e){return e&&e.__esModule?e:{default:e}}function a(e,t){!1!==M&&($(t.element).off("CornerstoneToolsMouseDrag",u),$(t.element).off("CornerstoneToolsMouseUp",a),$(t.element).off("CornerstoneToolsMouseClick",a),f(e,t),M=!1,w=Date.now())}function r(e,t){if((0,x.default)(t.which,e.data.mouseButtonMask)){var o=Date.now();if(!0===M)return;if(null!==w&&o-w<100)return;return M=!0,c(e,t),$(t.element).on("CornerstoneToolsMouseDrag",u),$(t.element).on("CornerstoneToolsMouseUp",a),$(t.element).on("CornerstoneToolsMouseClick",a),!1}}function i(e,t){$(t.element).off("CornerstoneToolsTouchDrag",d),$(t.element).off("CornerstoneToolsTouchEnd",i),$(t.element).off("CornerstoneToolsTap",i),f(e,t)}function l(e,t){return c(e,t),$(t.element).on("CornerstoneToolsTouchDrag",d),$(t.element).on("CornerstoneToolsTouchEnd",i),$(t.element).on("CornerstoneToolsTap",i),!1}function s(e){var t=e.image.maxPixelValue*e.image.slope+e.image.intercept,o=e.image.minPixelValue*e.image.slope+e.image.intercept,n=t-o,a=n/1024,r=e.deltaPoints.page.x*a,i=e.deltaPoints.page.y*a;e.viewport.voi.windowWidth+=r,e.viewport.voi.windowCenter+=i}function u(e,t){return P.strategy(t),m.setViewport(t.element,t.viewport),!1}function d(e,t){e.stopImmediatePropagation();var o=t,n=o.image.maxPixelValue*o.image.slope+o.image.intercept,a=o.image.minPixelValue*o.image.slope+o.image.intercept,r=n-a,i=r/1024,l=o.deltaPoints.page.x*i,s=o.deltaPoints.page.y*i,u=P.getConfiguration();u.orientation?0===u.orientation?(o.viewport.voi.windowWidth+=l,o.viewport.voi.windowCenter+=s):(o.viewport.voi.windowWidth+=s,o.viewport.voi.windowCenter+=l):(o.viewport.voi.windowWidth+=l,o.viewport.voi.windowCenter+=s),m.setViewport(o.element,o.viewport)}function c(e,t){var o=P.getConfiguration(),n=512,a=512,r=void 0;if(o&&(o.targetWidth&&(n=o.targetWidth),o.targetHeight&&(a=o.targetHeight)),t.image.height<1.5*a&&t.image.width<1.5*n)return r={unchanged:!0},void(b=r);var i=t.viewport,l=i.rotation;if([0,90,180,270].indexOf(l)<0)return console.warn("Can't handle rotations which are not multiples of 90, falling back to standard mode"),r={unchanged:!0},void(b=r);var s=t.image;r={image:s,viewport:$.extend(!0,{},i)},b=r;var u=m.getEnabledElement(t.element),d=$(t.element).find("canvas").get(0),c=d.width,f=d.height,v=m.internal.getTransform(u);v.invert();var h=void 0,p=void 0;0===l?(h=v.transformPoint(c,f),p=v.transformPoint(0,0)):270===l?(h=v.transformPoint(c,0),p=v.transformPoint(0,f)):180===l?(h=v.transformPoint(0,0),p=v.transformPoint(c,f)):90===l&&(h=v.transformPoint(0,f),p=v.transformPoint(c,0)),h.x=Math.min(h.x,s.width),h.y=Math.min(h.y,s.height),p.x=Math.max(0,p.x),p.y=Math.max(0,p.y);var T=g(s,n,a,p,h),y={x:(p.x+h.x)/2-s.width/2,y:(p.y+h.y)/2-s.height/2},C=void 0;return 0===l?C={x:(i.translation.x+y.x)/((h.x-p.x)/n),y:(i.translation.y+y.y)/((h.y-p.y)/a)}:270===l?C={x:(i.translation.x+y.y)/((h.y-p.y)/a),y:(i.translation.y-y.x)/((h.x-p.x)/n)}:180===l?C={x:(i.translation.x-y.x)/((h.x-p.x)/n),y:(i.translation.y-y.y)/((h.y-p.y)/a)}:90===l&&(C={x:(i.translation.x-y.y)/((h.y-p.y)/a),y:(i.translation.y+y.x)/((h.x-p.x)/n)}),i.translation=C,T.rowPixelSpacing*n>T.columnPixelSpacing*a?i.scale*=(h.x-p.x)/n:i.scale*=(h.y-p.y)/a,m.displayImage(t.element,T,i),m.setViewport(t.element,i),!1}function f(e,t){var o=b;if(o&&!("unchanged"in o)){var n=m.getViewport(t.element),a=o.image,r=o.viewport;r.voi=n.voi,m.setViewport(t.element,r),m.displayImage(t.element,a,r)}}function g(e,t,o,n,a){function r(){return T}var i=e.getPixelData(),l=e.width,s=n.y,u=n.x,d=(a.y-n.y)/o,c=(a.x-n.x)/t,f=void 0,g=void 0,v=void 0,h=void 0,p=void 0,T=void 0;if(!1===e.color){for(T=new i.constructor(o*t),p=new Array(t),g=0;g<t;g++)p[g]=Math.ceil(u+(g+.5)*c);for(f=0;f<o;f++)for(v=Math.ceil(s+(f+.5)*d),g=0;g<t;g++)h=p[g],T[f*t+g]=i[v*l+h]}else{for(T=new i.constructor(o*t*4),p=new Array(t),g=0;g<t;g++)p[g]=Math.ceil(u+(g+.5)*c);for(f=0;f<o;f++)for(v=Math.ceil(s+(f+.5)*d),g=0;g<t;g++)h=p[g],T[4*(f*t+g)+0]=i[4*(v*l+h)+0],T[4*(f*t+g)+1]=i[4*(v*l+h)+1],T[4*(f*t+g)+2]=i[4*(v*l+h)+2],T[4*(f*t+g)+3]=i[4*(v*l+h)+3]}var y={imageId:e.imageId+"_down",minPixelValue:e.minPixelValue,maxPixelValue:e.maxPixelValue,rows:o,columns:t,height:o,width:t,getPixelData:r,color:e.color,columnPixelSpacing:(e.columnPixelSpacing?e.columnPixelSpacing:1)/d,rowPixelSpacing:(e.rowPixelSpacing?e.rowPixelSpacing:1)/c,invert:!1,sizeInBytes:t*o*2*(e.color?1:4),slope:e.slope,intercept:e.intercept,windowCenter:e.windowCenter,windowWidth:e.windowWidth};return!0===y.color?y.render=m.renderColorImage:y.render=m.renderGrayscaleImage,y}Object.defineProperty(t,"__esModule",{value:!0}),t.wwwclodTouchDrag=t.wwwclod=void 0;var v=o(0),m=function(e){if(e&&e.__esModule)return e;var t={};if(null!=e)for(var o in e)Object.prototype.hasOwnProperty.call(e,o)&&(t[o]=e[o]);return t.default=e,t}(v),h=o(14),p=n(h),T=o(10),y=n(T),C=o(3),x=n(C),b=null,M=!1,w=null,P=(0,p.default)(r);P.strategies={default:s},P.strategy=s;var S=(0,y.default)(l);t.wwwclod=P,t.wwwclodTouchDrag=S},function(e,t,o){"use strict";function n(e){return e&&e.__esModule?e:{default:e}}function a(e,t,o){var n=e.length;if(n<2)return{min:t,max:o,mean:(t+o)/2};for(var a=o,r=t,i=0,l=0;l<n;l++){var s=e[l];a=Math.min(a,s),r=Math.max(r,s),i+=s}return{min:a,max:r,mean:i/n}}function r(e,t){var o=(0,P.getToolState)(t.element,_);o&&o.data&&(o.data=[]),$(t.element).off("CornerstoneToolsMouseMove",c),$(t.element).off("CornerstoneToolsMouseDrag",c),$(t.element).off("CornerstoneToolsMouseUp",i),$(t.element).off("CornerstoneToolsMouseClick",i);var n={mouseButtonMask:j};$(t.element).on("CornerstoneToolsMouseDown",n,u)}function i(e,t){$(t.element).off("CornerstoneToolsMouseMove",c),$(t.element).off("CornerstoneToolsMouseDrag",c),$(t.element).off("CornerstoneToolsMouseUp",i),$(t.element).off("CornerstoneToolsMouseClick",i);var o={mouseButtonMask:j};$(t.element).on("CornerstoneToolsMouseDown",o,u);var n=(0,P.getToolState)(t.element,_);n&&n.data&&n.data.length&&(n.data[0].endPoint={x:t.currentPoints.image.x,y:t.currentPoints.image.y},l(t))}function l(e){var t=(0,P.getToolState)(e.element,_);if(t&&t.data&&t.data.length){var o=t.data[0].startPoint,n=t.data[0].endPoint,r=Math.abs(o.x-n.x),i=Math.abs(o.y-n.y),l=Math.min(o.x,n.x),s=Math.min(o.y,n.y);l=Math.max(l,0),l=Math.min(l,e.image.width),s=Math.max(s,0),s=Math.min(s,e.image.height),r=Math.floor(Math.min(r,Math.abs(e.image.width-l))),i=Math.floor(Math.min(i,Math.abs(e.image.height-s)));var u=(0,I.default)(e.element,l,s,r,i),d=a(u,e.image.minPixelValue,e.image.maxPixelValue),c=E.getConfiguration(),f=C.getViewport(e.element);void 0===c.minWindowWidth&&(c.minWindowWidth=10),f.voi.windowWidth=Math.max(Math.abs(d.max-d.min),c.minWindowWidth),f.voi.windowCenter=d.mean,C.setViewport(e.element,f),t.data=[],C.updateImage(e.element)}}function s(e,t){var o=t.element;$(o).off("CornerstoneToolsMouseMove"),$(o).off("CornerstoneToolsMouseDrag"),$(o).on("CornerstoneToolsMouseMove",c),$(o).on("CornerstoneToolsMouseDrag",c),$(o).on("CornerstoneToolsMouseClick",i),"CornerstoneToolsMouseDrag"===e.type&&$(o).on("CornerstoneToolsMouseUp",i)}function u(e,t){if((0,k.default)(t.which,e.data.mouseButtonMask))return $(t.element).on("CornerstoneToolsMouseDrag",t,s),$(t.element).on("CornerstoneToolsMouseMove",t,s),$(t.element).off("CornerstoneToolsMouseDown",u),d(t),!1}function d(e){var t=(0,P.getToolState)(e.element,_);t&&t.data&&(t.data=[]);var o={startPoint:{x:e.currentPoints.image.x,y:e.currentPoints.image.y}};(0,P.addToolState)(e.element,_,o)}function c(e,t){var o=(0,P.getToolState)(t.element,_);if(o&&o.data&&o.data.length){var n={x:t.currentPoints.image.x,y:t.currentPoints.image.y};o.data[0].endPoint=n,C.updateImage(t.element)}}function f(e,t){var o=(0,P.getToolState)(t.element,_);if(o&&o.data&&o.data.length){var n=o.data[0].startPoint,a=o.data[0].endPoint;if(n&&a){var r=$(t.element).find("canvas").get(0),i=r.getContext("2d");i.setTransform(1,0,0,1,0,0);var l=w.default.getActiveColor(),s=C.pixelToCanvas(t.element,n),u=C.pixelToCanvas(t.element,a),d=Math.min(s.x,u.x),c=Math.min(s.y,u.y),f=Math.abs(s.x-u.x),g=Math.abs(s.y-u.y),v=b.default.getToolWidth(),m=E.getConfiguration();i.save(),m&&m.shadow&&(i.shadowColor=m.shadowColor||"#000000",i.shadowOffsetX=m.shadowOffsetX||1,i.shadowOffsetY=m.shadowOffsetY||1),i.beginPath(),i.strokeStyle=l,i.lineWidth=v,i.rect(d,c,f,g),i.stroke(),i.restore()}}}function g(e){$(e).off("CornerstoneToolsMouseDown",u),$(e).off("CornerstoneToolsMouseUp",i),$(e).off("CornerstoneToolsMouseClick",i),$(e).off("CornerstoneToolsMouseDrag",c),$(e).off("CornerstoneToolsMouseMove",c),$(e).off("CornerstoneImageRendered",f),$(e).off("CornerstoneNewImage",r),C.updateImage(e)}function v(e,t){var o={mouseButtonMask:t};if(j=t,!(0,P.getToolState)(e,_)){var n=[];(0,P.addToolState)(e,_,n)}$(e).off("CornerstoneToolsMouseDown",u),$(e).off("CornerstoneToolsMouseUp",i),$(e).off("CornerstoneToolsMouseClick",i),$(e).off("CornerstoneToolsMouseDrag",c),$(e).off("CornerstoneToolsMouseMove",c),$(e).off("CornerstoneImageRendered",f),$(e).off("CornerstoneNewImage",r),$(e).on("CornerstoneToolsMouseDown",o,u),$(e).on("CornerstoneImageRendered",f),$(e).on("CornerstoneNewImage",r),C.updateImage(e)}function m(e){$(e).off("CornerstoneToolsTouchDrag",c),$(e).off("CornerstoneToolsTouchStart",d),$(e).off("CornerstoneToolsDragEnd",l),$(e).off("CornerstoneImageRendered",f)}function h(e){if(!(0,P.getToolState)(e,_)){var t=[];(0,P.addToolState)(e,_,t)}$(e).off("CornerstoneToolsTouchDrag",c),$(e).off("CornerstoneToolsTouchStart",d),$(e).off("CornerstoneToolsDragEnd",l),$(e).off("CornerstoneImageRendered",f),$(e).on("CornerstoneToolsTouchDrag",c),$(e).on("CornerstoneToolsTouchStart",d),$(e).on("CornerstoneToolsDragEnd",l),$(e).on("CornerstoneImageRendered",f)}function p(){return D}function T(e){D=e}Object.defineProperty(t,"__esModule",{value:!0}),t.wwwcRegionTouch=t.wwwcRegion=void 0;var y=o(0),C=function(e){if(e&&e.__esModule)return e;var t={};if(null!=e)for(var o in e)Object.prototype.hasOwnProperty.call(e,o)&&(t[o]=e[o]);return t.default=e,t}(y),x=o(6),b=n(x),M=o(4),w=n(M),P=o(1),S=o(44),I=n(S),O=o(3),k=n(O),_="wwwcRegion",D={minWindowWidth:10},j=void 0,E={activate:v,deactivate:g,disable:g,setConfiguration:T,getConfiguration:p},R={activate:h,deactivate:m,disable:m};t.wwwcRegion=E,t.wwwcRegionTouch=R},function(e,t,o){"use strict";function n(e){return e&&e.__esModule?e:{default:e}}function a(e,t){var o=O.getConfiguration(),n=Math.log(e.scale)/Math.log(1.7),a=n+t,r=Math.pow(1.7,a);return o.maxScale&&r>o.maxScale?e.scale=o.maxScale:o.minScale&&r<o.minScale?e.scale=o.minScale:e.scale=r,e}function r(e,t,o){return e.x=Math.max(e.x,0),e.y=Math.max(e.y,0),e.x=Math.min(e.x,t),e.y=Math.min(e.y,o),e}function i(e,t){if(t.hflip&&(e.x*=-1),t.vflip&&(e.y*=-1),0!==t.rotation){var o=t.rotation*Math.PI/180,n=Math.cos(o),a=Math.sin(o),r=e.x*n-e.y*a,i=e.x*a+e.y*n;e.x=r,e.y=i}return e}function l(e,t){var o=e.element,n=a(e.viewport,t);h.setViewport(o,n);var r=h.pageToPixel(o,e.startPoints.page.x,e.startPoints.page.y),l={x:e.startPoints.image.x-r.x,y:e.startPoints.image.y-r.y};l=i(l,n),n.translation.x-=l.x,n.translation.y-=l.y,h.setViewport(o,n)}function s(e,t){var o=e.element,n=e.image,l=O.getConfiguration(),s=a(e.viewport,t),u={x:0,y:0};if(t<0)s.scale<3&&(Math.abs(s.translation.x)<.01?s.translation.x=0:u.x=s.translation.x/8,Math.abs(s.translation.y)<.01?s.translation.y=0:u.y=s.translation.y/8);else{l&&l.preventZoomOutsideImage&&(I.image=r(I.image,n.width,n.height));var d={x:n.width/2-I.image.x,y:n.height/2-I.image.y};d=i(d,s);var c={x:s.translation.x-d.x,y:s.translation.y-d.y};Math.abs(c.x)<.01?s.translation.x=d.x:u.x=c.x/8,Math.abs(c.y)<.01?s.translation.y=d.y:u.y=c.y/8}s.translation.x-=u.x,s.translation.y-=u.y,h.setViewport(o,s)}function u(e,t){var o=e.element,n=a(e.viewport,t);h.setViewport(o,n)}function d(e,t){$(t.element).off("CornerstoneToolsMouseDrag",f),$(t.element).off("CornerstoneToolsMouseUp",d),$(t.element).off("CornerstoneToolsMouseClick",d)}function c(e,t){if((0,C.default)(t.which,e.data.mouseButtonMask))return I=t.startPoints,$(t.element).on("CornerstoneToolsMouseDrag",f),$(t.element).on("CornerstoneToolsMouseUp",d),$(t.element).on("CornerstoneToolsMouseClick",d),!1}function f(e,t){if(!t.deltaPoints.page.y)return!1;var o=t.deltaPoints.page.y/100;return O.strategy(t,o),!1}function g(e,t){var o=-t.direction/4,n=O.getConfiguration();n&&n.invert&&(o*=-1);var r=a(t.viewport,o);h.setViewport(t.element,r)}function v(e,t){var o=O.getConfiguration(),n=t.viewport,a=t.element;n.scale+=t.scaleChange*n.scale,o.maxScale&&n.scale>o.maxScale?n.scale=o.maxScale:o.minScale&&n.scale<o.minScale&&(n.scale=o.minScale),h.setViewport(a,n);var r=h.pageToPixel(a,t.startPoints.page.x,t.startPoints.page.y),l={x:t.startPoints.image.x-r.x,y:t.startPoints.image.y-r.y};l=i(l,n),n.translation.x-=l.x,n.translation.y-=l.y,h.setViewport(a,n)}Object.defineProperty(t,"__esModule",{value:!0}),t.zoomTouchDrag=t.zoomTouchPinch=t.zoomWheel=t.zoom=void 0;var m=o(0),h=function(e){if(e&&e.__esModule)return e;var t={};if(null!=e)for(var o in e)Object.prototype.hasOwnProperty.call(e,o)&&(t[o]=e[o]);return t.default=e,t}(m),p=o(14),T=n(p),y=o(3),C=n(y),x=o(22),b=n(x),M=o(55),w=n(M),P=o(10),S=n(P),I=void 0,O=(0,T.default)(c);O.strategies={default:l,translate:s,zoomToCenter:u},O.strategy=l;var k=(0,b.default)(g),_=(0,w.default)(v),D=(0,S.default)(f);t.zoom=O,t.zoomWheel=k,t.zoomTouchPinch=_,t.zoomTouchDrag=D},function(e,t,o){"use strict";function n(e){return e&&e.__esModule?e:{default:e}}function a(e){var t=P.getConfiguration(),o=m.getEnabledElement(e.element),n=o.canvas.getContext("2d");n.setTransform(1,0,0,1,0,0),r(n,e.currentPoints.canvas,t.radius*o.viewport.scale,t.dragColor),x.push({x:Math.round(e.currentPoints.image.x),y:Math.round(e.currentPoints.image.y)}),b=e.currentPoints.canvas}function r(e,t,o,n){e.save(),e.beginPath(),e.arc(t.x,t.y,o,0,2*Math.PI,!0),e.strokeStyle=n,e.fillStyle=n,e.stroke(),e.fill(),e.restore()}function i(e,t,o){e.save(),e.beginPath(),e.arc(t.x,t.y,o,0,2*Math.PI,!0),e.clip(),e.clearRect(t.x-o-1,t.y-o-1,2*o+2,2*o+2),e.restore()}function l(e,t){b=t.currentPoints.canvas,m.updateImage(t.element)}function s(e,t){b=t.currentPoints.canvas,m.updateImage(t.element,!0),$(t.element).off("CornerstoneToolsMouseDrag",l),$(t.element).off("CornerstoneToolsMouseDrag",u),$(t.element).off("CornerstoneToolsMouseUp",s),$(t.element).off("CornerstoneToolsMouseClick",s)}function u(e,t){return P.strategy(t),!1}function d(e,t){if((0,y.default)(t.which,e.data.mouseButtonMask))return $(t.element).on("CornerstoneToolsMouseDrag",u),$(t.element).on("CornerstoneToolsMouseUp",s),$(t.element).on("CornerstoneToolsMouseClick",s),P.strategy(t),!1;$(t.element).on("CornerstoneToolsMouseDrag",l),$(t.element).on("CornerstoneToolsMouseUp",s)}function c(e,t){var o=P.getConfiguration(),n=m.getEnabledElement(t.element),a=n.canvas.getContext("2d");if(a.setTransform(1,0,0,1,0,0),b){var i=o.radius*n.viewport.scale;r(a,b,i,o.hoverColor)}}function f(){var e=P.getConfiguration(),t=M.getContext("2d");1===e.draw?x.forEach(function(o){r(t,o,e.radius,e.overlayColor)}):x.forEach(function(o){i(t,o,e.radius)}),x=[];var o=this.width,n=this.height;return t.getImageData(0,0,o,n).data}function g(e,t){$(e).off("CornerstoneImageRendered",c),$(e).on("CornerstoneImageRendered",c);var o={mouseButtonMask:t};$(e).off("CornerstoneToolsMouseDownActivate",d),$(e).on("CornerstoneToolsMouseDownActivate",o,d),$(e).off("CornerstoneToolsMouseMove",l),$(e).on("CornerstoneToolsMouseMove",l);var n=m.getEnabledElement(e);M.width=n.canvas.width,M.height=n.canvas.height;var a=M.getContext("2d");a.fillStyle="rgba(0,0,0,0)",a.fillRect(0,0,M.width,M.height);var r={minPixelValue:0,maxPixelValue:255,slope:1,intercept:0,windowCenter:127,windowWidth:256,getPixelData:f,rgba:!0,rows:n.image.height,columns:n.image.width,height:n.image.height,width:n.image.width,color:!0,invert:!1,columnPixelSpacing:1,rowPixelSpacing:1,sizeInBytes:n.image.width*n.image.height*4},i=void 0;w&&(i=m.getLayer(e,w)),i||(w=m.addLayer(e,r)),m.updateImage(e)}Object.defineProperty(t,"__esModule",{value:!0}),t.brush=void 0;var v=o(0),m=function(e){if(e&&e.__esModule)return e;var t={};if(null!=e)for(var o in e)Object.prototype.hasOwnProperty.call(e,o)&&(t[o]=e[o]);return t.default=e,t}(v),h=o(8),p=n(h),T=o(3),y=n(T),C={draw:1,radius:10,hoverColor:"green",dragColor:"yellow",overlayColor:"red"},x=[],b=void 0,M=document.createElement("canvas"),w=void 0,P=(0,p.default)({mouseMoveCallback:l,mouseDownActivateCallback:d,onImageRendered:c});P.activate=g,P.setConfiguration(C),P.strategies={default:a},P.strategy=a,t.brush=P},function(e,t,o){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.default="0.9.0"}])});
//# sourceMappingURL=cornerstoneTools.min.js.map